<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ULTRA-AGGRESSIVE Cache Prevention -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0, post-check=0, pre-check=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="cache-control" content="max-age=0">
    <meta name="last-modified" content="2025-10-24 15:05:00">
    <meta name="build-version" content="v2.3-HIGHLIGHTS-SECTION-ADDED">
    <!-- NEW: Highlights section with scrollable key insights from all tools - 2025-10-24 15:05 -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Intermarket Barometer Ticker -->
    <link rel="stylesheet" href="/css/intermarket_ticker.css"?v=1768031129">
    <title>Spartan Research Station - Global Market Intelligence Network</title>

    <!-- üöÄ RAPID LOADING: Resource Hints -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- üöÄ RAPID LOADING: Optimized Font Loading -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/spartan_theme.css"?v=1768031129">

    <!-- Chart.js for Advanced Visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js?v=1768031129"></script>

    <!-- üöÄ RAPID LOADING: Critical Scripts -->
    <script src="/js/spartan_validator.js" defer></script>

    <!-- üöÄ BACKGROUND DATA PRELOADER: Loads ALL market data in background -->
    <script src="/js/spartan-preloader.js"></script>
    <script src="/js/no-na-integration.js"></script>

    <!-- ü§ñ AGENT HEARTBEAT SYSTEM: Autonomous ON/OFF switch reporting -->
    <script src="/js/agent_heartbeat.js"></script>
    <script src="/js/api_heartbeat_wrapper.js"></script>

    <!-- Market Regime Component Scripts - DISABLED TO PREVENT DATA ERROR -->
    <!-- <script src="/js/data_validator.js"></script> -->
    <!-- <script src="/js/real_data_fetcher.js"></script> -->
    <!-- <script src="/js/market_regime_component.js"></script> -->

    <!-- PostgreSQL Database API (replaces symbols_database.json) - DISABLED -->
    <!-- <script src="/js/database_api.js"></script> -->

    <!-- Claude AI Chat Widget - Intelligent symbol search and analysis - DISABLED -->
    <!-- <script src="/js/claude_chat.js"></script> -->

    <style>
        :root {
            /* COT Hunter Pro Color Palette */
            --primary-color: #FFD700;        /* Gold */
            --secondary-color: #DAA520;      /* Goldenrod */
            --accent-color: #FFA500;         /* Orange-Gold */
            --bg-dark: #0E1117;
            --bg-darker: #080A0E;
            --bg-card: #1E2329;
            --text-primary: #ffffff;
            --text-secondary: #8B949E;
            --border-color: #30363D;
            --hover-glow: rgba(255, 215, 0, 0.3);  /* Gold glow */
            --gold: #FFD700;
            --green: #00FF00;                /* Bright Green (Bullish) */
            --red: #FF4B4B;                  /* Red (Bearish) */
            --blue: #58A6FF;                 /* Light Blue */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #161B22 50%, #0E1117 100%);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            padding-top: 0; /* Removed - market regime header disabled */
        }

        /* Header */
        .header {
            background: rgba(30, 35, 41, 0.98);
            backdrop-filter: blur(20px);
            padding: 20px 40px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);  /* Gold */
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-title img {
            height: 50px;
        }

        .header-title h1 {
            font-size: 1.8em;
            color: var(--text-primary);
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .header-subtitle {
            color: var(--text-secondary);
            font-size: 0.9em;
            margin-top: 4px;
        }

        .header-stats {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.6em;
            font-weight: 700;
            color: var(--gold);
            display: block;
        }

        .stat-label {
            font-size: 0.75em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Controls */
        .controls {
            background: rgba(18, 32, 58, 0.95);
            padding: 15px 40px;
            border-bottom: 1px solid var(--border-color);
        }

        .controls-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 45px 12px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95em;
            transition: all 0.2s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.2em;
        }

        /* Navigation Tabs */
        .nav-tabs {
            background: var(--bg-card);
            border-bottom: 2px solid var(--border-color);
            padding: 0;
            margin: 0;
            position: relative;
            backdrop-filter: blur(20px);
        }

        .nav-tabs-container {
            width: 100%;
            margin: 0;
            display: flex;
            gap: 0;
            padding: 0;
        }

        .nav-tab {
            flex: 1;
            padding: 22px 32px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--text-secondary);
            font-size: 1.35em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            text-align: center;
        }

        .nav-tab:hover {
            color: var(--primary-color);
            background: rgba(255, 215, 0, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .nav-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: linear-gradient(180deg, rgba(255, 215, 0, 0.15), rgba(255, 215, 0, 0.08));
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg,
                transparent,
                var(--primary-color),
                transparent);
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* Tab Content Containers */
        .tab-content {
            display: none;
            padding: 40px;
            max-width: 1600px;
            margin: 0 auto;
        }

        .tab-content.active {
            display: block;
        }

        .indicator-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .indicator-section h2 {
            font-size: 1.8em;
            color: var(--primary-color);
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }

        .indicator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .indicator-card {
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .indicator-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }

        .indicator-card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .pathway-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .pathway-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.08), rgba(218, 165, 32, 0.05));
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pathway-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 8px 24px rgba(255, 215, 0, 0.3);
            transform: translateY(-4px);
        }

        .pathway-card h3 {
            color: var(--primary-color);
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .pathway-card p {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .filter-btn {
            padding: 12px 20px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }

        .filter-btn:hover, .filter-btn.active {
            background: rgba(255, 215, 0, 0.1);  /* Gold */
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .view-toggle {
            display: flex;
            gap: 5px;
            background: var(--bg-card);
            padding: 4px;
            border-radius: 8px;
        }

        .view-btn {
            padding: 8px 16px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 0.9em;
        }

        .view-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* Edit Mode Toggle */
        .edit-mode-btn {
            padding: 10px 20px;
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid var(--gold);
            border-radius: 8px;
            color: var(--gold);
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
        }

        .edit-mode-btn:hover {
            background: rgba(255, 215, 0, 0.3);
            transform: translateY(-2px);
        }

        .edit-mode-btn.active {
            background: var(--gold);
            color: var(--bg-dark);
        }

        /* Main Container */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 30px 40px;
        }

        /* Network Canvas */
        #networkCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        /* Flashcard Grid */
        .flashcard-network {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            grid-auto-rows: 1fr; /* FORCE equal height rows */
            gap: 24px;
            position: relative;
            z-index: 2;
            align-items: stretch; /* Ensure all items stretch to row height */
        }

        /* Flashcard */
        .flashcard {
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            padding: 28px;
            min-height: 220px;
            height: 100%; /* Fill grid cell completely */
            display: flex;
            flex-direction: column;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            box-sizing: border-box; /* Ensure padding is included in height */
        }

        .flashcard.draggable {
            cursor: grab;
        }

        .flashcard.dragging {
            opacity: 0.5;
            cursor: grabbing;
            transform: scale(1.05);
            z-index: 1000;
        }

        .flashcard.drag-over {
            border: 2px dashed var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .drag-handle {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.2em;
            color: var(--gold);
            opacity: 0;
            transition: opacity 0.2s;
            cursor: grab;
            z-index: 10;
        }

        .flashcard.draggable:hover .drag-handle {
            opacity: 1;
        }

        .edit-mode-active .drag-handle {
            opacity: 1 !important;
        }

        .flashcard::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .flashcard:hover {
            transform: translateY(-4px);
            border-color: var(--primary-color);
        }

        .flashcard:hover::before {
            transform: scaleX(1);
        }

        .flashcard.highlighted {
            border-color: var(--gold);
        }

        /* Navigating State - Instant Visual Feedback */
        .flashcard.navigating {
            pointer-events: none;
            opacity: 0.6;
            transform: scale(0.98);
            transition: all 0.2s;
        }

        /* Pinned Flashcard (Daily Planet) */
        .flashcard.pinned {
            background: linear-gradient(135deg, var(--bg-card) 0%, rgba(255, 215, 0, 0.15) 100%);
            border: 2px solid var(--primary-color);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
            position: relative;
        }

        .flashcard.pinned::before {
            background: linear-gradient(90deg, var(--accent-color), var(--gold));
            transform: scaleX(1);
            height: 4px;
        }

        .flashcard.pinned::after {
            content: 'üìå';
            position: absolute;
            top: 12px;
            right: 12px;
            font-size: 1.5em;
            opacity: 0.7;
            animation: pulse 2s infinite;
        }

        .flashcard.pinned:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 40px rgba(255, 215, 0, 0.5);
        }

        .flashcard.pinned .flashcard-title {
            color: var(--accent-color);
            font-weight: 800;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .flashcard-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .flashcard-icon {
            font-size: 2.2em;
            line-height: 1;
        }

        .flashcard-title {
            font-size: 1.35em;
            font-weight: 600;
            color: var(--text-primary);
        }

        .flashcard-count {
            background: rgba(255, 215, 0, 0.2);  /* Gold */
            color: var(--gold);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: auto;
        }

        .flashcard-description {
            color: var(--text-secondary);
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 16px;
            flex-grow: 1;
        }

        .flashcard-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: auto;
        }

        .tag {
            background: rgba(255, 215, 0, 0.1);  /* Gold */
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.75em;
            color: var(--text-secondary);
            border: 1px solid rgba(255, 215, 0, 0.2);  /* Gold */
        }

        /* Metric Card Grid - Equal Height Cards (COT Hunter Pro, etc.) */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-auto-rows: 1fr;
            gap: 25px;
            align-items: stretch;
        }

        .metric-card {
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            height: 100%;
            min-height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-sizing: border-box;
        }

        @media (max-width: 768px) {
            .metric-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Category Headers */
        .category-header {
            grid-column: 1 / -1;
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px 0 10px;
            border-bottom: 2px solid var(--border-color);
            margin-top: 30px;
        }

        .category-header:first-child {
            margin-top: 0;
        }

        .category-icon {
            font-size: 2em;
        }

        .category-title {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--gold);
        }

        .category-count {
            background: rgba(255, 215, 0, 0.2);
            color: var(--gold);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        /* Connection Lines */
        .connection-line {
            stroke: var(--primary-color);
            stroke-width: 2;
            stroke-dasharray: 5, 5;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .connection-line.active {
            opacity: 0.6;
            animation: dash 20s linear infinite;
        }

        @keyframes dash {
            to {
                stroke-dashoffset: -1000;
            }
        }

        /* Legend */
        .legend {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(18, 32, 58, 0.95);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            z-index: 1000;
        }

        .legend-title {
            font-size: 0.9em;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 0.85em;
            color: var(--text-secondary);
        }

        .legend-line {
            width: 30px;
            height: 2px;
            background: var(--primary-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-stats {
                display: none;
            }

            .flashcard-network {
                grid-template-columns: 1fr;
            }

            .controls-content {
                flex-direction: column;
            }

            .search-box {
                width: 100%;
            }
        }
    </style>

    <!-- Spartan Ticker Tape CSS - DISABLED -->
    <!-- <link rel="stylesheet" href="/css/js/spartan_ticker.css"?v=1768031129"> -->
    <script src="/phantom/phantom_guardian.js?v=1768031129"></script>
</head>
<body>
    <!-- Market Regime Indicator (Pinned at Top) - DISABLED TO PREVENT DATA ERROR -->
    <!-- <div id="market-regime-indicator"></div> -->

    <!-- SVG Canvas for Connections -->
    <svg id="networkCanvas"></svg>

    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="header-title">
                <img src="/images/spartan_logo.png" alt="Spartan">
                <div>
                    <h1>Spartan Research Station</h1>
                    <div class="header-subtitle">Global Market Intelligence Network</div>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-number" id="totalSymbols">25,410</span>
                    <span class="stat-label">Symbols</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">20+</span>
                    <span class="stat-label">Countries</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">25+</span>
                    <span class="stat-label">Exchanges</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="connectionCount">0</span>
                    <span class="stat-label">Connections</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Spartan Ticker Tape - DISABLED TO PREVENT DATA ERROR -->
    <!-- <div id="spartan-ticker" class="spartan-ticker-container"></div> -->

    <!-- Navigation Tabs -->
    <div class="nav-tabs">
        <div class="nav-tabs-container">
            <button class="nav-tab active" data-tab="summary">üìä Summary</button>
            <button class="nav-tab" data-tab="markets">üåç Markets</button>
            <button class="nav-tab" data-tab="research-tools">üî¨ Research Tools</button>
            <button class="nav-tab" data-tab="intelligence">üß† Intelligence</button>
            <button class="nav-tab" data-tab="news">üì∞ News</button>
            <button class="nav-tab" data-tab="research">üî¨ Research</button>
            <button class="nav-tab" onclick="window.open('/pages/strategies.html', '_blank')">üéØ Strategies</button>
        </div>
    </div>

    <!-- Edit Layout Button -->
    <div style="position: fixed; bottom: 30px; left: 30px; z-index: 1000; display: flex; flex-direction: column; gap: 10px;">
        <button class="edit-mode-btn" id="editModeBtn" onclick="toggleEditMode()" style="padding: 12px 24px; font-size: 1.1em; background: rgba(255, 215, 0, 0.9); border: 2px solid #FFD700; border-radius: 8px; color: #0E1117; cursor: pointer; font-weight: 700; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); transition: all 0.3s ease;">
            ‚úèÔ∏è Edit Layout
        </button>
        <button onclick="exportSpartanLayoutCSV()" style="padding: 10px 20px; font-size: 0.95em; background: rgba(16, 185, 129, 0.9); border: 2px solid rgba(16, 185, 129, 0.5); border-radius: 8px; color: white; cursor: pointer; font-weight: 600; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); transition: all 0.3s ease;">
            üì• Export Layout CSV
        </button>
        <button onclick="importSpartanLayoutCSV()" style="padding: 10px 20px; font-size: 0.95em; background: rgba(59, 130, 246, 0.9); border: 2px solid rgba(59, 130, 246, 0.5); border-radius: 8px; color: white; cursor: pointer; font-weight: 600; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3); transition: all 0.3s ease;">
            üì§ Import Layout CSV
        </button>
    </div>

    <!-- üê≥ WHALE HUNTER PRO SUMMARY (VISUALLY UPGRADED) -->
    <div id="whale-hunter-section" style="background: linear-gradient(135deg, rgba(18, 32, 58, 0.95), rgba(13, 27, 42, 0.95));
                border-top: 3px solid #FFD700;
                border-bottom: 3px solid #FFD700;
                padding: 40px 40px;
                margin: 0;
                box-shadow: 0 8px 32px rgba(255, 215, 0, 0.25);">
        <div style="max-width: 1600px; margin: 0 auto;">
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="font-size: 2.4em; color: #FFD700; margin-bottom: 0; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);">
                    üìä COT Hunter Pro <span style="font-size: 0.4em; background: #FFD700; color: #000; padding: 4px 12px; border-radius: 4px; margin-left: 15px; vertical-align: middle;">INSTITUTIONAL</span>
                </h2>
                <div class="header-controls" style="display: flex; gap: 15px; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <span class="pulse-dot" style="height: 8px; width: 8px; background-color: #00FF00; border-radius: 50%; display: inline-block; box-shadow: 0 0 8px #00FF00;"></span>
                        <span id="whale-status" style="color: #00FF00; font-family: monospace; font-size: 0.9em;">SYSTEM ACTIVE</span>
                    </div>
                    <a href="http://localhost:8501" target="_blank" class="btn-tool" style="background: linear-gradient(135deg, #FFD700, #FFA500); color: #000; font-weight: bold; border: none; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4); padding: 12px 24px; border-radius: 8px; text-decoration: none; font-size: 1em;">
                        LAUNCH DASHBOARD ‚Üó
                    </a>
                </div>
            </div>

            <!-- Description -->
            <p style="font-size: 1.2em; color: #ffffff; line-height: 1.6; max-width: 1000px; margin: 0 auto 30px; text-align: center;">
                <strong>Institutional Flow Detector</strong> ‚Äî Tracks whale accumulation and distribution patterns across global markets to identify smart money movements <em>before</em> retail catches on.
            </p>

            <!-- Metrics Grid -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); grid-auto-rows: 1fr; gap: 25px; margin-bottom: 30px; align-items: stretch;">
                <!-- Metric 1: Markets Scanned -->
                <div style="background: rgba(255, 215, 0, 0.08); border: 2px solid rgba(255, 215, 0, 0.3); border-radius: 12px; padding: 25px; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center; box-sizing: border-box; min-height: 160px;">
                    <div style="color: #FFD700; font-size: 0.9em; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">Markets Scanned</div>
                    <div id="whale-total" style="color: #FFF; font-size: 3em; font-weight: 800; text-shadow: 0 0 15px rgba(255, 215, 0, 0.3);">0</div>
                    <div style="color: #FFD700; font-size: 0.85em; margin-top: 8px;">Global Institutional Flow</div>
                </div>

                <!-- Metric 2: Bullish Signals -->
                <div style="background: rgba(0, 255, 0, 0.08); border: 2px solid rgba(0, 255, 0, 0.3); border-radius: 12px; padding: 25px; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center; box-sizing: border-box; min-height: 160px;">
                    <div style="color: #00FF00; font-size: 0.9em; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">Bullish Signals</div>
                    <div id="whale-bullish" style="color: #00FF00; font-size: 3em; font-weight: 800; text-shadow: 0 0 15px rgba(0, 255, 0, 0.3);">0</div>
                    <div style="color: rgba(0, 255, 0, 0.8); font-size: 0.85em; margin-top: 8px;">Accumulation Detected</div>
                </div>

                <!-- Metric 3: Bearish Signals -->
                <div style="background: rgba(255, 75, 75, 0.08); border: 2px solid rgba(255, 75, 75, 0.3); border-radius: 12px; padding: 25px; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center; box-sizing: border-box; min-height: 160px;">
                    <div style="color: #FF4B4B; font-size: 0.9em; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">Bearish Signals</div>
                    <div id="whale-bearish" style="color: #FF4B4B; font-size: 3em; font-weight: 800; text-shadow: 0 0 15px rgba(255, 75, 75, 0.3);">0</div>
                    <div style="color: rgba(255, 75, 75, 0.8); font-size: 0.85em; margin-top: 8px;">Distribution Detected</div>
                </div>
            </div>

        <!-- Terminal Output -->
        <div style="margin-top: 25px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span style="color: #FFD700; font-family: monospace; font-size: 0.9em;">> TOP_SIGNAL_FEED_V1.0</span>
                <span style="color: #666; font-size: 0.8em;">Last Scan: <span id="whale-timestamp">Just now</span></span>
            </div>
            
            <div class="analysis-box" id="whale-top-signals" style="
                background: #000; 
                border: 1px solid #333; 
                border-radius: 6px; 
                padding: 0; 
                max-height: 200px; 
                overflow-y: auto; 
                font-family: 'Courier New', monospace;">
                
                <!-- Loading State -->
                <div style="padding: 20px; text-align: center; color: #444;">
                    <span class="loading-spinner" style="border-top-color: #FFD700;"></span>
                    <div style="margin-top: 10px;">INITIALIZING FEED...</div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- ‚öñÔ∏è GLOBAL BAROMETER: AUD/JPY STRATEGIC ANALYSIS -->
    <div id="global-barometer-section" style="background: linear-gradient(135deg, rgba(10, 22, 40, 0.95), rgba(26, 31, 58, 0.95));
                border-top: 3px solid #FFD700;
                border-bottom: 3px solid #FFD700;
                padding: 40px 40px;
                margin: 0;
                box-shadow: 0 8px 32px rgba(255, 215, 0, 0.25);">
        <div style="max-width: 1600px; margin: 0 auto;">
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="font-size: 2.4em; color: #FFD700; margin-bottom: 0; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);">
                    ‚öñÔ∏è Global Barometer <span style="font-size: 0.4em; background: #FFD700; color: #000; padding: 4px 12px; border-radius: 4px; margin-left: 15px; vertical-align: middle;">STRATEGIC ALPHA</span>
                </h2>
                <div class="header-controls" style="display: flex; gap: 15px; align-items: center;">
                    <a href="/pages/global_barometer_report.html" class="btn-tool" style="background: linear-gradient(135deg, #FFD700, #FFA500); color: #000; font-weight: bold; border: none; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4); padding: 12px 24px; border-radius: 8px; text-decoration: none; font-size: 1em;">
                        FULL REPORT ‚Üó
                    </a>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: stretch;">
                <!-- Importance Card -->
                <div class="flashcard" style="background: rgba(255, 215, 0, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 12px; padding: 30px; height: 100%; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <span style="font-size: 2.5em;">üåü</span>
                        <h3 style="color: #FFD700; font-size: 1.8em; margin: 0;">Strategic Importance</h3>
                    </div>
                    <ul style="color: #ffffff; font-size: 1.1em; line-height: 1.8; padding-left: 20px;">
                        <li><strong>Premier Risk Proxy:</strong> Acts as the fulcrum of global risk appetite, reacting instantaneously to systemic shifts.</li>
                        <li><strong>Liquidity Derivative:</strong> Primary vehicle for the multi-trillion-dollar carry trade lubricating international markets.</li>
                        <li><strong>Growth Barometer:</strong> A leveraged bet on Asian economic growth and the "electrification" commodity supercycle.</li>
                        <li><strong>Macro Fulcrum:</strong> Represents the ratio of "Global Growth Optimism" to "Systemic Fear."</li>
                    </ul>
                </div>

                <!-- Current State Card -->
                <div class="flashcard" style="background: rgba(255, 75, 75, 0.05); border: 1px solid rgba(255, 75, 75, 0.3); border-radius: 12px; padding: 30px; height: 100%; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <span style="font-size: 2.5em;">üìâ</span>
                        <h3 style="color: #FF4B4B; font-size: 1.8em; margin: 0;">Current State (2026)</h3>
                    </div>
                    <p style="color: #ffffff; font-size: 1.1em; line-height: 1.6; margin-bottom: 20px;">
                        <strong>Regime Change:</strong> Transitioning from synchronized tightening to a fragmented policy landscape (Fed Pivot vs. RBA Hawkish Hold vs. BOJ Exit).
                    </p>
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; border-left: 4px solid #FF4B4B;">
                        <ul style="color: #b0b8c8; font-size: 1em; line-height: 1.6; list-style: none;">
                            <li><span style="color: #FF4B4B;">‚ö†Ô∏è</span> <strong>Correction Risk:</strong> Acute medium-term downside from dismantling of Yen carry trade.</li>
                            <li><span style="color: #FFD700;">‚ö°</span> <strong>Yield Compression:</strong> AU-JP spread narrowing as BOJ normalizes.</li>
                            <li><span style="color: #00ff88;">üîó</span> <strong>Correlation:</strong> 0.89 correlation with Nasdaq; Bitcoin acting as the "canary."</li>
                        </ul>
                    </div>
                    <!-- Strategic Action Matrix -->
                    <div style="margin-top: 20px; border-top: 1px solid rgba(255, 75, 75, 0.3); padding-top: 15px;">
                        <div style="color: #b0b8c8; font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; text-align: center; margin-bottom: 10px;">Strategic Sell Matrix</div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.95em;">
                            <!-- AUD/JPY -->
                            <div style="background: rgba(255, 75, 75, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(255, 75, 75, 0.2);">
                                <div style="color: #FF4B4B; font-weight: 700;">AUD/JPY</div>
                                <div style="color: #ffffff; font-size: 0.85em;">Sell Rallies @ 105-106</div>
                            </div>
                            
                            <!-- Iron Ore -->
                            <div style="background: rgba(255, 75, 75, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(255, 75, 75, 0.2);">
                                <div style="color: #FF4B4B; font-weight: 700;">Iron Ore Futures</div>
                                <div style="color: #ffffff; font-size: 0.85em;">Short Structure ($85 Tgt)</div>
                            </div>

                            <!-- Nasdaq 100 -->
                            <div style="background: rgba(255, 75, 75, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(255, 75, 75, 0.2);">
                                <div style="color: #FF4B4B; font-weight: 700;">Nasdaq 100</div>
                                <div style="color: #ffffff; font-size: 0.85em;">Hedge/Short on Divergence</div>
                            </div>

                            <!-- Correlated FX -->
                            <div style="background: rgba(255, 75, 75, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(255, 75, 75, 0.2);">
                                <div style="color: #FF4B4B; font-weight: 700;">AUD/USD</div>
                                <div style="color: #ffffff; font-size: 0.85em;">Sell if China Weakens</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 5-Day Trend Chart -->
                    <div style="margin-top: 20px; border-top: 1px solid rgba(255, 75, 75, 0.3); padding-top: 15px;">
                        <div style="color: #b0b8c8; font-size: 0.8em; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">5-Day Price Trend</div>
                        <div style="height: 120px; width: 100%;">
                            <canvas id="audjpyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Swing Trader's Playbook (1-2 Week Horizon) -->
            <div style="margin-top: 30px; background: rgba(0, 0, 0, 0.2); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="font-size: 1.4em; color: #FFD700; margin: 0;">üõ†Ô∏è Swing Trader's Playbook <span style="font-size: 0.6em; color: #b0b8c8; font-weight: 400;">(1-2 Week Window)</span></h3>
                    <div style="font-size: 0.8em; color: #00ff88; display: flex; align-items: center; gap: 6px;">
                        <span class="pulse-dot" style="background-color: #00ff88; width: 6px; height: 6px; border-radius: 50%; display: inline-block;"></span>
                        LIVE AI ADVICE
                    </div>
                </div>

                <div id="ai-advice-container" style="font-family: 'Courier New', monospace; font-size: 0.95em; color: #b0b8c8; line-height: 1.6;">
                    <div style="margin-bottom: 15px; padding: 15px; background: rgba(255, 75, 75, 0.08); border-left: 3px solid #FF4B4B; border-radius: 4px;">
                        <strong style="color: #FF4B4B;">CORE THESIS:</strong> "Fade the Exhaustion." Do not chase. Short overextended rallies into resistance.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                        <!-- AUD/JPY Strategy -->
                        <div>
                            <div style="color: #FFD700; font-weight: 700; margin-bottom: 5px;">1. AUD/JPY: Crown Jewel Short</div>
                            <ul style="list-style: none; padding: 0; margin: 0; font-size: 0.9em;">
                                <li><strong>Action:</strong> Sell Limit Orders @ 105.00 ‚Äì 105.80</li>
                                <li><strong>Trigger:</strong> Intra-day spike + H1 candle rejection.</li>
                                <li><strong>Target:</strong> 102.40 (50-Day MA)</li>
                                <li><strong>Stop Loss:</strong> Daily Close > 106.10</li>
                            </ul>
                        </div>

                        <!-- Iron Ore Strategy -->
                        <div>
                            <div style="color: #FFD700; font-weight: 700; margin-bottom: 5px;">2. Iron Ore: "Fade the Rip"</div>
                            <ul style="list-style: none; padding: 0; margin: 0; font-size: 0.9em;">
                                <li><strong>Action:</strong> Short bounces toward $105/t</li>
                                <li><strong>Why:</strong> "Anti-Involution" caps upside.</li>
                                <li><strong>Target:</strong> $95/t (Range Support)</li>
                            </ul>
                        </div>

                        <!-- Nasdaq Strategy -->
                        <div>
                            <div style="color: #FFD700; font-weight: 700; margin-bottom: 5px;">3. Nasdaq 100: Divergence Hedge</div>
                            <ul style="list-style: none; padding: 0; margin: 0; font-size: 0.9em;">
                                <li><strong>Action:</strong> Short if AUD/JPY lags new NQ Highs.</li>
                                <li><strong>Signal:</strong> Bearish Non-Confirmation.</li>
                                <li><strong>Target:</strong> 300-500 pt pullback.</li>
                            </ul>
                        </div>
                    </div>

                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px dashed #333; font-style: italic; color: #888;">
                        <span id="ai-dynamic-message">Analyzing market state...</span>
                    </div>
                </div>
            </div>

            <!-- Terminal Quote -->
            <div style="margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.4); border: 1px solid #333; border-radius: 8px; font-family: monospace; color: #FFD700; text-align: center;">
                > ANALYSIS: "The 'Easy Carry' era is over. AUD/JPY will likely cease to be a passive beneficiary of equity rallies and become a volatility battleground."
            </div>
        </div>
    </div>

    <!-- üá∞üá∑ FX STRATEGIC ALPHA: SOUTH KOREAN WON (USD/KRW) -->
    <div id="usd-krw-section" style="background: linear-gradient(135deg, rgba(10, 22, 40, 0.95), rgba(13, 27, 42, 0.95));
                border-top: 3px solid #58A6FF;
                border-bottom: 3px solid #58A6FF;
                padding: 40px 40px;
                margin: 0;
                box-shadow: 0 8px 32px rgba(88, 166, 255, 0.25);">
        <div style="max-width: 1600px; margin: 0 auto;">
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="font-size: 2.4em; color: #58A6FF; margin-bottom: 0; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; text-shadow: 0 0 20px rgba(88, 166, 255, 0.5);">
                    üá∞üá∑ Industrial Barometer <span style="font-size: 0.4em; background: #58A6FF; color: #000; padding: 4px 12px; border-radius: 4px; margin-left: 15px; vertical-align: middle;">FX STRATEGIC ALPHA</span>
                </h2>
                <div class="header-controls" style="display: flex; gap: 15px; align-items: center;">
                    <a href="/pages/usd_krw_report.html" class="btn-tool" style="background: linear-gradient(135deg, #58A6FF, #1f6feb); color: #fff; font-weight: bold; border: none; box-shadow: 0 4px 15px rgba(88, 166, 255, 0.4); padding: 12px 24px; border-radius: 8px; text-decoration: none; font-size: 1em;">
                        FULL REPORT ‚Üó
                    </a>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: stretch;">
                <!-- Importance Card -->
                <div class="flashcard" style="background: rgba(88, 166, 255, 0.05); border: 1px solid rgba(88, 166, 255, 0.3); border-radius: 12px; padding: 30px; height: 100%; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <span style="font-size: 2.5em;">üèóÔ∏è</span>
                        <h3 style="color: #58A6FF; font-size: 1.8em; margin: 0;">Industrial Canary</h3>
                    </div>
                    <ul style="color: #ffffff; font-size: 1.1em; line-height: 1.8; padding-left: 20px;">
                        <li><strong>The Global Canary:</strong> Premier barometer for the global industrial cycle and manufacturing health.</li>
                        <li><strong>High-Beta Tech Proxy:</strong> Exaggerated correlation with Nasdaq 100 and semiconductor (SOX) cycles.</li>
                        <li><strong>"Korea Inc" Proxy:</strong> Reflects the health of global inputs (Semis, Steel, Petrochemicals, Ships).</li>
                        <li><strong>WGBI Liquidity Event:</strong> Imminent $60B structural inflow commencing April 2026.</li>
                    </ul>
                </div>

                <!-- Strategic State Card -->
                <div class="flashcard" style="background: rgba(0, 255, 136, 0.05); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 12px; padding: 30px; height: 100%; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <span style="font-size: 2.5em;">üöÄ</span>
                        <h3 style="color: #00ff88; font-size: 1.8em; margin: 0;">Tactical Window (2026)</h3>
                    </div>
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; border-left: 4px solid #00ff88;">
                        <div style="color: #b0b8c8; font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; text-align: center; margin-bottom: 10px;">Tactical BUY Matrix (KRW)</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.95em;">
                            <!-- USD/KRW -->
                            <div style="background: rgba(0, 255, 136, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(0, 255, 136, 0.2);">
                                <div style="color: #00ff88; font-weight: 700;">USD/KRW</div>
                                <div style="color: #ffffff; font-size: 0.85em;">Short USD @ 1,450+</div>
                            </div>
                            <!-- KTBs -->
                            <div style="background: rgba(0, 255, 136, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(0, 255, 136, 0.2);">
                                <div style="color: #00ff88; font-weight: 700;">KTB Bonds</div>
                                <div style="color: #ffffff; font-size: 0.85em;">Front-run WGBI Apr-Nov</div>
                            </div>
                            <!-- Samsung -->
                            <div style="background: rgba(0, 255, 136, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(0, 255, 136, 0.2);">
                                <div style="color: #00ff88; font-weight: 700;">Samsung Electronics</div>
                                <div style="color: #ffffff; font-size: 0.85em;">AI Export Boom Play</div>
                            </div>
                            <!-- SK Hynix -->
                            <div style="background: rgba(0, 255, 136, 0.1); padding: 8px; border-radius: 4px; border: 1px solid rgba(0, 255, 136, 0.2);">
                                <div style="color: #00ff88; font-weight: 700;">SK Hynix</div>
                                <div style="color: #ffffff; font-size: 0.85em;">HBM Monopoly Beta</div>
                            </div>
                        </div>
                    </div>
                    <p style="color: #ffffff; font-size: 1.1em; line-height: 1.6; margin-top: 20px;">
                        <strong>Short-Term Thesis:</strong> Tactical KRW appreciation toward 1,350 as capital inflows overpower structural decay.
                    </p>
                    
                    <!-- 5-Day Trend Chart -->
                    <div style="margin-top: 20px; border-top: 1px solid rgba(0, 255, 136, 0.3); padding-top: 15px;">
                        <div style="color: #b0b8c8; font-size: 0.8em; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">5-Day Price Trend</div>
                        <div style="height: 120px; width: 100%;">
                            <canvas id="usdkrwChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Swing Trader's Playbook (1-2 Week Horizon) -->
            <div style="margin-top: 30px; background: rgba(0, 0, 0, 0.2); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="font-size: 1.4em; color: #58A6FF; margin: 0;">üõ†Ô∏è KRW Swing Playbook <span style="font-size: 0.6em; color: #b0b8c8; font-weight: 400;">(1-2 Week Window)</span></h3>
                    <div style="font-size: 0.8em; color: #00ff88; display: flex; align-items: center; gap: 6px;">
                        <span class="pulse-dot" style="background-color: #00ff88; width: 6px; height: 6px; border-radius: 50%; display: inline-block;"></span>
                        LIVE AI ADVICE
                    </div>
                </div>

                <div id="krw-ai-advice-container" style="font-family: 'Courier New', monospace; font-size: 0.95em; color: #b0b8c8; line-height: 1.6;">
                    <div style="margin-bottom: 15px; padding: 15px; background: rgba(0, 255, 136, 0.08); border-left: 3px solid #00ff88; border-radius: 4px;">
                        <strong style="color: #00ff88;">CORE THESIS:</strong> "The Liquidity Squeeze." WGBI anticipation creates a structural bid. Sell USD/KRW on strength.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                        <!-- USD/KRW Strategy -->
                        <div>
                            <div style="color: #58A6FF; font-weight: 700; margin-bottom: 5px;">1. USD/KRW: Short Tactical</div>
                            <ul style="list-style: none; padding: 0; margin: 0; font-size: 0.9em;">
                                <li><strong>Action:</strong> Sell USD/KRW @ 1,450 - 1,460</li>
                                <li><strong>Why:</strong> Overextended USD vs front-running WGBI flows.</li>
                                <li><strong>Target:</strong> 1,410 (Short-term support)</li>
                                <li><strong>Stop Loss:</strong> 1,475 (Blowout zone)</li>
                            </ul>
                        </div>

                        <!-- KOSPI Strategy -->
                        <div>
                            <div style="color: #58A6FF; font-weight: 700; margin-bottom: 5px;">2. KOSPI 200: Value Bounce</div>
                            <ul style="list-style: none; padding: 0; margin: 0; font-size: 0.9em;">
                                <li><strong>Action:</strong> Long on dips to 320 area.</li>
                                <li><strong>Why:</strong> Catching the "Indian Summer" AI rally.</li>
                                <li><strong>Target:</strong> 345 (Cycle High)</li>
                            </ul>
                        </div>

                        <!-- SOX Correlation -->
                        <div>
                            <div style="color: #58A6FF; font-weight: 700; margin-bottom: 5px;">3. SOX Hedge: Chip Symmetry</div>
                            <ul style="list-style: none; padding: 0; margin: 0; font-size: 0.9em;">
                                <li><strong>Action:</strong> Long KRW if SOX > 5,500.</li>
                                <li><strong>Signal:</strong> Semiconductor breakout leads Won.</li>
                                <li><strong>Target:</strong> 3% currency appreciation.</li>
                            </ul>
                        </div>
                    </div>

                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px dashed #333; font-style: italic; color: #888;">
                        <span id="krw-ai-dynamic-message">Monitoring trade data releases...</span>
                    </div>
                </div>
            </div>

            <!-- Terminal Quote -->
            <div style="margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.4); border: 1px solid #333; border-radius: 8px; font-family: monospace; color: #58A6FF; text-align: center;">
                > ANALYSIS: "Trade the 2026-27 tactical window for KRW strength, but aggressively hedge the structural 2028-30 demographic cliff."
            </div>
        </div>
    </div>

    <!-- üß† LIVE AI ADVICE: GLOBAL INFLATION DYNAMICS -->
    <div id="live-ai-advice-section" style="background: linear-gradient(135deg, rgba(15, 25, 35, 0.98), rgba(10, 18, 28, 0.98));
                border-top: 3px solid #FFD700;
                border-bottom: 3px solid #FFD700;
                padding: 40px 40px;
                margin: 0;
                box-shadow: 0 8px 32px rgba(255, 215, 0, 0.25);">
        <div style="max-width: 1600px; margin: 0 auto;">
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="font-size: 2.4em; color: #FFD700; margin-bottom: 0; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);">
                    üß† Live AI Advice <span style="font-size: 0.4em; background: #FFD700; color: #000; padding: 4px 12px; border-radius: 4px; margin-left: 15px; vertical-align: middle;">2026 STRATEGIC OUTLOOK</span>
                </h2>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span class="pulse-dot" style="background-color: #FFD700; width: 8px; height: 8px; border-radius: 50%; display: inline-block; animation: pulse 2s infinite;"></span>
                    <span style="color: #FFD700; font-size: 0.9em; font-weight: 600;">INTELLIGENCE ACTIVE</span>
                </div>
            </div>

            <!-- Executive Summary Card -->
            <div style="background: rgba(255, 215, 0, 0.08); border: 2px solid rgba(255, 215, 0, 0.4); border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                    <span style="font-size: 2em;">üåê</span>
                    <h3 style="color: #FFD700; font-size: 1.6em; margin: 0;">The Era of Asynchronous Adjustment</h3>
                </div>
                <p style="color: #ffffff; font-size: 1.1em; line-height: 1.8; margin: 0;">
                    As the global economy crosses the threshold into January 2026, the synchronized inflationary shock that defined the post-pandemic years has dissolved into a fragmented, asynchronous landscape. We have entered the <strong style="color: #FFD700;">"Great Divergence"</strong> ‚Äî a period characterized by sharply contrasting monetary policy cycles, idiosyncratic inflation drivers, and a widening chasm between macroeconomic aggregate data and the lived financial experience of the common citizen.
                </p>
            </div>

            <!-- AI Advice Charts Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 25px; margin-bottom: 30px;">
                <!-- Global CPI Comparison Chart -->
                <div style="background: rgba(255, 215, 0, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 12px; padding: 20px;">
                    <h4 style="color: #FFD700; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                        üìä Global CPI Comparison (Jan 2026)
                    </h4>
                    <div style="height: 280px; position: relative;">
                        <canvas id="aiAdviceCpiChart"></canvas>
                    </div>
                </div>

                <!-- Central Bank Rates Chart -->
                <div style="background: rgba(255, 215, 0, 0.05); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 12px; padding: 20px;">
                    <h4 style="color: #FFD700; margin: 0 0 15px 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px;">
                        üè¶ Central Bank Policy Rates
                    </h4>
                    <div style="height: 280px; position: relative;">
                        <canvas id="aiAdviceRatesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Key Regional Status Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <!-- US Card -->
                <div class="flashcard" style="background: rgba(255, 75, 75, 0.08); border: 1px solid rgba(255, 75, 75, 0.4); border-radius: 12px; padding: 20px; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                        <span style="font-size: 1.8em;">üá∫üá∏</span>
                        <h4 style="color: #FF6B6B; font-size: 1.3em; margin: 0;">United States</h4>
                        <span style="background: rgba(255, 75, 75, 0.3); color: #FF6B6B; padding: 3px 8px; border-radius: 4px; font-size: 0.75em; margin-left: auto;">STICKY</span>
                    </div>
                    <div style="color: #b0b8c8; font-size: 0.95em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>CPI (Nov 2025):</span><strong style="color: #FF6B6B;">2.7%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Core CPI:</span><strong style="color: #FF6B6B;">2.6%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Fed Rate:</span><strong style="color: #ffffff;">3.50-3.75%</strong></div>
                        <div style="display: flex; justify-content: space-between;"><span>GDP Forecast:</span><strong style="color: #00ff88;">2.6%</strong></div>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255, 75, 75, 0.3); font-size: 0.85em; color: #888;"><strong>Key Risk:</strong> "No Landing" / Inflation Reignites</div>
                </div>

                <!-- Eurozone Card -->
                <div class="flashcard" style="background: rgba(88, 166, 255, 0.08); border: 1px solid rgba(88, 166, 255, 0.4); border-radius: 12px; padding: 20px; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                        <span style="font-size: 1.8em;">üá™üá∫</span>
                        <h4 style="color: #58A6FF; font-size: 1.3em; margin: 0;">Eurozone</h4>
                        <span style="background: rgba(88, 166, 255, 0.3); color: #58A6FF; padding: 3px 8px; border-radius: 4px; font-size: 0.75em; margin-left: auto;">AT TARGET</span>
                    </div>
                    <div style="color: #b0b8c8; font-size: 0.95em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>HICP (Dec 2025):</span><strong style="color: #00ff88;">2.0%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Core HICP:</span><strong style="color: #FFD700;">2.3%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>ECB Status:</span><strong style="color: #ffffff;">ON HOLD</strong></div>
                        <div style="display: flex; justify-content: space-between;"><span>GDP Forecast:</span><strong style="color: #FF6B6B;">1.3%</strong></div>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(88, 166, 255, 0.3); font-size: 0.85em; color: #888;"><strong>Key Risk:</strong> German Recession / Fragmentation</div>
                </div>

                <!-- China Card -->
                <div class="flashcard" style="background: rgba(255, 136, 0, 0.08); border: 1px solid rgba(255, 136, 0, 0.4); border-radius: 12px; padding: 20px; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                        <span style="font-size: 1.8em;">üá®üá≥</span>
                        <h4 style="color: #FF8800; font-size: 1.3em; margin: 0;">China</h4>
                        <span style="background: rgba(255, 136, 0, 0.3); color: #FF8800; padding: 3px 8px; border-radius: 4px; font-size: 0.75em; margin-left: auto;">DEFLATIONARY</span>
                    </div>
                    <div style="color: #b0b8c8; font-size: 0.95em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>CPI (Dec 2025):</span><strong style="color: #FFD700;">0.8%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Youth Unemp:</span><strong style="color: #FF6B6B;">18.9%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>PBOC Stance:</span><strong style="color: #00ff88;">EASING</strong></div>
                        <div style="display: flex; justify-content: space-between;"><span>GDP Forecast:</span><strong style="color: #FFD700;">4.6%</strong></div>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255, 136, 0, 0.3); font-size: 0.85em; color: #888;"><strong>Key Risk:</strong> Debt Deflation Spiral</div>
                </div>

                <!-- Japan Card -->
                <div class="flashcard" style="background: rgba(188, 19, 254, 0.08); border: 1px solid rgba(188, 19, 254, 0.4); border-radius: 12px; padding: 20px; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                        <span style="font-size: 1.8em;">üáØüáµ</span>
                        <h4 style="color: #bc13fe; font-size: 1.3em; margin: 0;">Japan</h4>
                        <span style="background: rgba(188, 19, 254, 0.3); color: #bc13fe; padding: 3px 8px; border-radius: 4px; font-size: 0.75em; margin-left: auto;">NORMALIZING</span>
                    </div>
                    <div style="color: #b0b8c8; font-size: 0.95em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Core CPI:</span><strong style="color: #FFD700;">2.5%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Real Wages:</span><strong style="color: #FF6B6B;">-2.8%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>BOJ Rate:</span><strong style="color: #ffffff;">0.75%</strong></div>
                        <div style="display: flex; justify-content: space-between;"><span>GDP Forecast:</span><strong style="color: #FFD700;">1.0%</strong></div>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(188, 19, 254, 0.3); font-size: 0.85em; color: #888;"><strong>Key Risk:</strong> Rapid Yen Appreciation / Bond Volatility</div>
                </div>

                <!-- India Card -->
                <div class="flashcard" style="background: rgba(0, 255, 136, 0.08); border: 1px solid rgba(0, 255, 136, 0.4); border-radius: 12px; padding: 20px; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                        <span style="font-size: 1.8em;">üáÆüá≥</span>
                        <h4 style="color: #00ff88; font-size: 1.3em; margin: 0;">India</h4>
                        <span style="background: rgba(0, 255, 136, 0.3); color: #00ff88; padding: 3px 8px; border-radius: 4px; font-size: 0.75em; margin-left: auto;">GOLDILOCKS</span>
                    </div>
                    <div style="color: #b0b8c8; font-size: 0.95em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>CPI (Nov 2025):</span><strong style="color: #00ff88;">0.71%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Food CPI:</span><strong style="color: #00ff88;">-5.02%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>RBI Repo:</span><strong style="color: #ffffff;">5.25%</strong></div>
                        <div style="display: flex; justify-content: space-between;"><span>GDP Forecast:</span><strong style="color: #00ff88;">6.6-7.0%</strong></div>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(0, 255, 136, 0.3); font-size: 0.85em; color: #888;"><strong>Key Risk:</strong> Food Supply Shock / Climate Events</div>
                </div>

                <!-- UK Card -->
                <div class="flashcard" style="background: rgba(255, 215, 0, 0.08); border: 1px solid rgba(255, 215, 0, 0.4); border-radius: 12px; padding: 20px; cursor: default;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                        <span style="font-size: 1.8em;">üá¨üáß</span>
                        <h4 style="color: #FFD700; font-size: 1.3em; margin: 0;">United Kingdom</h4>
                        <span style="background: rgba(255, 215, 0, 0.3); color: #FFD700; padding: 3px 8px; border-radius: 4px; font-size: 0.75em; margin-left: auto;">STAGFLATION</span>
                    </div>
                    <div style="color: #b0b8c8; font-size: 0.95em; line-height: 1.6;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>CPI (Late 2025):</span><strong style="color: #FF6B6B;">3.2-3.5%</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>Services CPI:</span><strong style="color: #FF6B6B;">HIGH</strong></div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;"><span>BoE Rate:</span><strong style="color: #ffffff;">3.75%</strong></div>
                        <div style="display: flex; justify-content: space-between;"><span>GDP Forecast:</span><strong style="color: #FF6B6B;">0.8-1.4%</strong></div>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255, 215, 0, 0.3); font-size: 0.85em; color: #888;"><strong>Key Risk:</strong> Stagflation / Fiscal Drag</div>
                </div>
            </div>

            <!-- CPI Mechanics Section -->
            <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; cursor: pointer;" onclick="toggleAIAdviceSection('cpi-mechanics-content')">
                    <h3 style="font-size: 1.4em; color: #FFD700; margin: 0;">üìä CPI Mechanics: Deconstructing the Measurement</h3>
                    <span style="color: #FFD700; font-size: 1.2em;" id="cpi-mechanics-toggle">‚ñº</span>
                </div>
                <div id="cpi-mechanics-content" style="display: block;">
                    <div style="overflow-x: auto; margin-bottom: 20px;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                            <thead>
                                <tr style="background: rgba(255, 215, 0, 0.15); border-bottom: 2px solid #FFD700;">
                                    <th style="padding: 12px; text-align: left; color: #FFD700;">Metric</th>
                                    <th style="padding: 12px; text-align: left; color: #FFD700;">Definition</th>
                                    <th style="padding: 12px; text-align: left; color: #FFD700;">Primary Utility</th>
                                    <th style="padding: 12px; text-align: left; color: #FFD700;">Current Status (Jan 2026)</th>
                                </tr>
                            </thead>
                            <tbody style="color: #b0b8c8;">
                                <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);"><td style="padding: 10px;"><strong style="color: #fff;">Headline CPI</strong></td><td style="padding: 10px;">All items in the basket</td><td style="padding: 10px;">Cost of Living proxy</td><td style="padding: 10px;"><span style="color: #00ff88;">Suppressed by energy/goods deflation</span></td></tr>
                                <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);"><td style="padding: 10px;"><strong style="color: #fff;">Core CPI</strong></td><td style="padding: 10px;">Excludes Food & Energy</td><td style="padding: 10px;">Monetary Policy signal</td><td style="padding: 10px;"><span style="color: #FF6B6B;">Elevated in US/UK; Moderating in EU</span></td></tr>
                                <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);"><td style="padding: 10px;"><strong style="color: #fff;">Supercore</strong></td><td style="padding: 10px;">Services ex-Housing</td><td style="padding: 10px;">Wage pressure proxy</td><td style="padding: 10px;"><span style="color: #FF6B6B;">Sticky/High globally</span></td></tr>
                                <tr><td style="padding: 10px;"><strong style="color: #fff;">PCE (US)</strong></td><td style="padding: 10px;">Chain-weighted consumption</td><td style="padding: 10px;">Fed's preferred target</td><td style="padding: 10px;"><span style="color: #FFD700;">Runs lower than CPI; slowly converging</span></td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                        <div style="background: rgba(255, 75, 75, 0.1); padding: 15px; border-radius: 8px; border-left: 3px solid #FF6B6B;">
                            <h4 style="color: #FF6B6B; margin: 0 0 8px 0; font-size: 1em;">üè† US Housing Lag (OER)</h4>
                            <p style="color: #b0b8c8; margin: 0; font-size: 0.85em; line-height: 1.5;">US CPI is 34% weighted to shelter via Owner's Equivalent Rent (OER). Changes in market rents take 6-12 months to filter through, keeping inflation elevated.</p>
                        </div>
                        <div style="background: rgba(88, 166, 255, 0.1); padding: 15px; border-radius: 8px; border-left: 3px solid #58A6FF;">
                            <h4 style="color: #58A6FF; margin: 0 0 8px 0; font-size: 1em;">üá™üá∫ Eurozone HICP Gap</h4>
                            <p style="color: #b0b8c8; margin: 0; font-size: 0.85em; line-height: 1.5;">The HICP excludes owner-occupied housing costs entirely, making it sensitive to goods prices but blind to property asset inflation.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- US Tariff Shock Section -->
            <div style="background: rgba(255, 75, 75, 0.08); border: 1px solid rgba(255, 75, 75, 0.3); border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; cursor: pointer;" onclick="toggleAIAdviceSection('us-tariff-content')">
                    <h3 style="font-size: 1.4em; color: #FF6B6B; margin: 0;">üá∫üá∏ The Tariff Shock: Structural US Inflation</h3>
                    <span style="color: #FF6B6B; font-size: 1.2em;" id="us-tariff-toggle">‚ñº</span>
                </div>
                <div id="us-tariff-content" style="display: block;">
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="text-align: center; margin-bottom: 15px;">
                            <span style="font-size: 3em; color: #FF6B6B;">18.6%</span>
                            <div style="color: #b0b8c8; font-size: 0.9em;">Effective US Tariff Rate ‚Äî Highest Since Smoot-Hawley (1930s)</div>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                            <div style="text-align: center; padding: 15px; background: rgba(255, 75, 75, 0.15); border-radius: 8px;"><div style="color: #FF6B6B; font-size: 1.8em; font-weight: bold;">97%+</div><div style="color: #b0b8c8; font-size: 0.8em;">US Footwear Imported</div></div>
                            <div style="text-align: center; padding: 15px; background: rgba(255, 75, 75, 0.15); border-radius: 8px;"><div style="color: #FF6B6B; font-size: 1.8em; font-weight: bold;">60%+</div><div style="color: #b0b8c8; font-size: 0.8em;">Appliances Imported</div></div>
                            <div style="text-align: center; padding: 15px; background: rgba(255, 75, 75, 0.15); border-radius: 8px;"><div style="color: #FF6B6B; font-size: 1.8em; font-weight: bold;">50%+</div><div style="color: #b0b8c8; font-size: 0.8em;">Furniture Imported</div></div>
                        </div>
                    </div>
                    <p style="color: #ffffff; line-height: 1.7; margin-bottom: 15px;"><strong style="color: #FF6B6B;">The Inflationary Floor:</strong> This tariff regime has established a "floor" for US inflation. The days of "lowflation" ‚Äî where cheap imported goods kept CPI suppressed ‚Äî are over. Inflation cannot settle comfortably below <strong>2.5%</strong>.</p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
                        <div style="background: rgba(0,0,0,0.2); padding: 12px; border-radius: 6px;"><div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;">Used Autos</div><div style="color: #FF6B6B; font-size: 1.4em;">+4.8%</div></div>
                        <div style="background: rgba(0,0,0,0.2); padding: 12px; border-radius: 6px;"><div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;">Medical Services</div><div style="color: #FF6B6B; font-size: 1.4em;">+4.3%</div></div>
                        <div style="background: rgba(0,0,0,0.2); padding: 12px; border-radius: 6px;"><div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;">Housing</div><div style="color: #FF6B6B; font-size: 1.4em;">+3.7%</div></div>
                        <div style="background: rgba(0,0,0,0.2); padding: 12px; border-radius: 6px;"><div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;">Real Wages</div><div style="color: #00ff88; font-size: 1.4em;">+0.8%</div></div>
                    </div>
                </div>
            </div>

            <!-- Commodities Section -->
            <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; cursor: pointer;" onclick="toggleAIAdviceSection('commodities-content')">
                    <h3 style="font-size: 1.4em; color: #00ff88; margin: 0;">üõ¢Ô∏è Commodities & Supply Chains</h3>
                    <span style="color: #00ff88; font-size: 1.2em;" id="commodities-toggle">‚ñº</span>
                </div>
                <div id="commodities-content" style="display: block;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div style="background: rgba(0, 255, 136, 0.08); padding: 20px; border-radius: 8px; border: 1px solid rgba(0, 255, 136, 0.3);">
                            <h4 style="color: #00ff88; margin: 0 0 15px 0;">‚õΩ Energy: Supply Glut</h4>
                            <div style="text-align: center; margin-bottom: 15px;"><span style="font-size: 2.5em; color: #00ff88;">$55/bbl</span><div style="color: #b0b8c8; font-size: 0.85em;">Brent Crude Forecast Q1 2026</div></div>
                            <p style="color: #b0b8c8; font-size: 0.9em; line-height: 1.6; margin: 0;">Non-OPEC production (US shale, Brazil, Guyana) has surged. Demand weakening due to China's deceleration and EV adoption.</p>
                        </div>
                        <div style="background: rgba(255, 136, 0, 0.08); padding: 20px; border-radius: 8px; border: 1px solid rgba(255, 136, 0, 0.3);">
                            <h4 style="color: #FF8800; margin: 0 0 15px 0;">üåæ Food: Climate Premium</h4>
                            <div style="text-align: center; margin-bottom: 15px;"><span style="font-size: 2.5em; color: #FF8800;">+3.2%</span><div style="color: #b0b8c8; font-size: 0.85em;">Potential Food Inflation by 2035</div></div>
                            <p style="color: #b0b8c8; font-size: 0.9em; line-height: 1.6; margin: 0;">"Climateflation" driving supply shocks for olive oil, cocoa, coffee. FAO Index at 124.3 (Dec 2025).</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Human Cost Section -->
            <div style="background: rgba(188, 19, 254, 0.08); border: 1px solid rgba(188, 19, 254, 0.3); border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; cursor: pointer;" onclick="toggleAIAdviceSection('human-cost-content')">
                    <h3 style="font-size: 1.4em; color: #bc13fe; margin: 0;">üë• The Human Cost: K-Shaped Recovery</h3>
                    <span style="color: #bc13fe; font-size: 1.2em;" id="human-cost-toggle">‚ñº</span>
                </div>
                <div id="human-cost-content" style="display: block;">
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <p style="color: #ffffff; font-size: 1.1em; line-height: 1.7; margin: 0;">Even if inflation falls to 2%, <strong style="color: #bc13fe;">prices do not go back down</strong>. They remain <strong>20-30% higher</strong> than 2021. Consumer sentiment (UMich: <strong style="color: #FF6B6B;">54.0</strong>) sits at recessionary levels despite non-recessionary GDP ‚Äî driven by <strong>"Inflation Fatigue"</strong>.</p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: rgba(0, 255, 136, 0.1); padding: 20px; border-radius: 8px; border-left: 4px solid #00ff88;">
                            <h4 style="color: #00ff88; margin: 0 0 10px 0;">üìà Asset Owners</h4>
                            <ul style="color: #b0b8c8; margin: 0; padding-left: 20px; font-size: 0.9em; line-height: 1.6;"><li>Equity markets resilient</li><li>Housing values held up</li><li>High interest income</li><li>Robust luxury consumption</li></ul>
                        </div>
                        <div style="background: rgba(255, 75, 75, 0.1); padding: 20px; border-radius: 8px; border-left: 4px solid #FF6B6B;">
                            <h4 style="color: #FF6B6B; margin: 0 0 10px 0;">üìâ Wage Earners</h4>
                            <ul style="color: #b0b8c8; margin: 0; padding-left: 20px; font-size: 0.9em; line-height: 1.6;"><li>Permanent price level shock</li><li>Rising rent & debt service</li><li>BNPL for groceries (distress)</li><li>Real wage erosion UK/Japan</li></ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Market Implications -->
            <div style="background: rgba(0, 0, 0, 0.3); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; cursor: pointer;" onclick="toggleAIAdviceSection('market-impl-content')">
                    <h3 style="font-size: 1.4em; color: #58A6FF; margin: 0;">üíº Market Implications & Asset Allocation</h3>
                    <span style="color: #58A6FF; font-size: 1.2em;" id="market-impl-toggle">‚ñº</span>
                </div>
                <div id="market-impl-content" style="display: block;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                        <div style="background: rgba(0, 255, 136, 0.08); padding: 20px; border-radius: 8px; border: 1px solid rgba(0, 255, 136, 0.3);">
                            <h4 style="color: #00ff88; margin: 0 0 15px 0;">üìä Equities</h4>
                            <ul style="color: #b0b8c8; margin: 0; padding-left: 18px; font-size: 0.9em; line-height: 1.7;"><li><strong style="color: #fff;">US Overweight:</strong> 2.6% GDP, AI productivity</li><li><strong style="color: #fff;">EM Value:</strong> India favored; LatAm early cuts</li><li><strong style="color: #fff;">AI Deflationary:</strong> 55% labor cost savings</li></ul>
                        </div>
                        <div style="background: rgba(88, 166, 255, 0.08); padding: 20px; border-radius: 8px; border: 1px solid rgba(88, 166, 255, 0.3);">
                            <h4 style="color: #58A6FF; margin: 0 0 15px 0;">üè¶ Fixed Income</h4>
                            <ul style="color: #b0b8c8; margin: 0; padding-left: 18px; font-size: 0.9em; line-height: 1.7;"><li><strong style="color: #fff;">US 10Y:</strong> ~4.3% real returns</li><li><strong style="color: #fff;">Bunds:</strong> ~2.8% wide spread</li><li><strong style="color: #fff;">Strategy:</strong> Ladder before 2027 cuts</li></ul>
                        </div>
                        <div style="background: rgba(255, 215, 0, 0.08); padding: 20px; border-radius: 8px; border: 1px solid rgba(255, 215, 0, 0.3);">
                            <h4 style="color: #FFD700; margin: 0 0 15px 0;">üí± Currencies</h4>
                            <ul style="color: #b0b8c8; margin: 0; padding-left: 18px; font-size: 0.9em; line-height: 1.7;"><li><strong style="color: #fff;">USD:</strong> Resilient yield + safe haven</li><li><strong style="color: #fff;">JPY Risk:</strong> BOJ unwind carry trade</li><li><strong style="color: #fff;">EUR:</strong> Tethered to Fed policy</li></ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Conclusion -->
            <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 215, 0, 0.05)); border: 2px solid #FFD700; border-radius: 12px; padding: 30px; margin-bottom: 20px;">
                <h3 style="color: #FFD700; font-size: 1.6em; margin: 0 0 20px 0; text-align: center;">‚öñÔ∏è The Fragile Equilibrium</h3>
                <p style="color: #ffffff; font-size: 1.1em; line-height: 1.8; text-align: center; margin: 0 0 20px 0;">The world has landed in a new reality defined by:</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; text-align: center;"><div style="font-size: 2em; margin-bottom: 10px;">üèóÔ∏è</div><div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;">Structural Inflation</div><div style="color: #b0b8c8; font-size: 0.9em;">Floor from tariffs, demographics, climate</div></div>
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; text-align: center;"><div style="font-size: 2em; margin-bottom: 10px;">üîÄ</div><div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;">Structural Divergence</div><div style="color: #b0b8c8; font-size: 0.9em;">US, EU, China separate cycles</div></div>
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; text-align: center;"><div style="font-size: 2em; margin-bottom: 10px;">üìä</div><div style="color: #FFD700; font-weight: bold; margin-bottom: 5px;">Structural Inequality</div><div style="color: #b0b8c8; font-size: 0.9em;">Asset owners vs wage earners</div></div>
                </div>
            </div>

            <!-- Terminal Quote -->
            <div style="margin-top: 20px; padding: 20px; background: rgba(0,0,0,0.4); border: 1px solid #333; border-radius: 8px; font-family: monospace; color: #FFD700; text-align: center;">
                > STRATEGIC INSIGHT: "The acute phase of the post-pandemic inflation crisis is over, but adaptation is now permanent. Navigate the gaps between divergent paths ‚Äî betting on Indian growth vs Chinese stagnation, US productivity vs European malaise."
            </div>
        </div>
    </div>

    <!-- üéØ STEALTH MACRO INDICATOR -->
    <div id="stealthMacroSection" style="background: linear-gradient(135deg, rgba(18, 32, 58, 0.95), rgba(13, 27, 42, 0.95));
                border-top: 3px solid #bc13fe;
                border-bottom: 3px solid #bc13fe;
                padding: 40px 40px;
                margin: 0;
                box-shadow: 0 8px 32px rgba(188, 19, 254, 0.25);">
        <div style="max-width: 1600px; margin: 0 auto;">
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="font-size: 2.4em; color: #bc13fe; margin-bottom: 12px; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; text-shadow: 0 0 20px rgba(188, 19, 254, 0.5);">
                    üéØ Stealth Macro
                </h2>
                <p style="font-size: 1.2em; color: #ffffff; line-height: 1.6; max-width: 1000px; margin: 0 auto;">
                    <strong>Hidden Regime Detector</strong> ‚Äî Tracks subtle shifts in Dollar strength, Treasury yields, commodity flows, and equity risk appetite to identify macro regime changes <em>before</em> they become obvious.
                </p>
            </div>

            <!-- Macro Regime Status (Central Indicator) -->
            <div style="background: rgba(0, 0, 0, 0.4);
                        border: 2px solid var(--border-color);
                        border-radius: 15px;
                        padding: 25px;
                        margin-bottom: 30px;
                        text-align: center;
                        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);">
                <div style="font-size: 1.1em; color: var(--text-secondary); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">
                    Current Macro Regime
                </div>
                <div id="macroRegimeStatus" style="font-size: 3em; font-weight: 900; margin-bottom: 10px; color: #FFD700;">
                    ‚ü≥ LOADING...
                </div>
                <div id="macroRegimeDescription" style="font-size: 1.1em; color: var(--text-secondary); line-height: 1.5; max-width: 700px; margin: 0 auto;">
                    Analyzing macro drivers...
                </div>
            </div>

            <!-- Six Macro Drivers Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">

                <!-- Dollar Strength (DXY) -->
                <div id="stealthDollarCard" style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid var(--accent-color);
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(220, 20, 60, 0.2);
                            transition: transform 0.3s ease;">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üíµ</div>
                    <h3 style="color: var(--accent-color); font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        Dollar (DXY) <span id="stealth-dxy-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="stealth-dxy-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong id="stealth-dxy-signal">--</strong><br>
                        <span id="stealth-dxy-description">Strong Dollar = Risk-Off (commodities/EM down)</span>
                    </p>
                    <div id="stealth-dxy-change" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);">
                        5-day: <span id="stealth-dxy-5d">--</span>
                    </div>
                </div>

                <!-- Treasury Yields (10Y) -->
                <div id="stealthYieldCard" style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #FFD700;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
                            transition: transform 0.3s ease;">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üìà</div>
                    <h3 style="color: #FFD700; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        10Y Yield <span id="stealth-yield-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="stealth-yield-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong id="stealth-yield-signal">--</strong><br>
                        <span id="stealth-yield-description">Rising yields = Growth expectations</span>
                    </p>
                    <div id="stealth-yield-change" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);">
                        5-day: <span id="stealth-yield-5d">--</span>
                    </div>
                </div>

                <!-- Gold (Safe Haven) -->
                <div id="stealthGoldCard" style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #FFD700;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
                            transition: transform 0.3s ease;">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">ü•á</div>
                    <h3 style="color: #FFD700; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        Gold (GLD) <span id="stealth-gold-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="stealth-gold-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong id="stealth-gold-signal">--</strong><br>
                        <span id="stealth-gold-description">Gold up = Fear/uncertainty rising</span>
                    </p>
                    <div id="stealth-gold-change" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);">
                        5-day: <span id="stealth-gold-5d">--</span>
                    </div>
                </div>

                <!-- Oil (Economic Activity) -->
                <div id="stealthOilCard" style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid var(--success-color);
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.2);
                            transition: transform 0.3s ease;">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üõ¢Ô∏è</div>
                    <h3 style="color: var(--success-color); font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        Oil (USO) <span id="stealth-oil-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="stealth-oil-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong id="stealth-oil-signal">--</strong><br>
                        <span id="stealth-oil-description">Oil up = Economic growth/inflation</span>
                    </p>
                    <div id="stealth-oil-change" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);">
                        5-day: <span id="stealth-oil-5d">--</span>
                    </div>
                </div>

                <!-- Equity Risk (SPY) -->
                <div id="stealthEquityCard" style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid var(--success-color);
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.2);
                            transition: transform 0.3s ease;">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üìä</div>
                    <h3 style="color: var(--success-color); font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        SPY <span id="stealth-spy-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="stealth-spy-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong id="stealth-spy-signal">--</strong><br>
                        <span id="stealth-spy-description">Equity strength = Risk appetite</span>
                    </p>
                    <div id="stealth-spy-change" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);">
                        5-day: <span id="stealth-spy-5d">--</span>
                    </div>
                </div>

                <!-- VIX (Fear Gauge) -->
                <div id="stealthVixCard" style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #bc13fe;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(188, 19, 254, 0.2);
                            transition: transform 0.3s ease;">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">‚ö°</div>
                    <h3 style="color: #bc13fe; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        VIX <span id="stealth-vix-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="stealth-vix-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong id="stealth-vix-signal">--</strong><br>
                        <span id="stealth-vix-description">VIX spike = Market fear rising</span>
                    </p>
                    <div id="stealth-vix-change" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);">
                        5-day: <span id="stealth-vix-5d">--</span>
                    </div>
                </div>

            </div>

            <!-- Regime Interpretation Guide -->
            <div style="background: rgba(0, 0, 0, 0.3);
                        border: 1px solid var(--border-color);
                        border-radius: 10px;
                        padding: 20px;
                        margin-top: 20px;">
                <h3 style="color: var(--accent-color); font-size: 1.2em; margin-bottom: 15px; font-weight: 700;">
                    üìñ Regime Decoder
                </h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; font-size: 0.95em; line-height: 1.6; color: var(--text-secondary);">
                    <div>
                        <strong style="color: var(--success-color);">üü¢ RISK-ON:</strong> Weak Dollar + Rising Yields + Oil/SPY up + VIX down + Gold down
                    </div>
                    <div>
                        <strong style="color: var(--danger-color);">üî¥ RISK-OFF:</strong> Strong Dollar + Falling Yields + Oil/SPY down + VIX up + Gold up
                    </div>
                    <div>
                        <strong style="color: #FFD700;">üü° STAGFLATION:</strong> Rising Yields + Oil up + Gold up + SPY weak
                    </div>
                    <div>
                        <strong style="color: #bc13fe;">üü£ TRANSITION:</strong> Mixed signals ‚Äî regime change in progress
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ö° VIX COMPOSITE INDICATOR (Markets + Crypto) -->
    <div id="vixCompositeSection" style="background: linear-gradient(135deg, rgba(13, 27, 42, 0.95), rgba(18, 32, 58, 0.95));
                border-top: 3px solid #FF5252;
                border-bottom: 3px solid #FF5252;
                padding: 35px 40px;
                margin: 0;
                box-shadow: 0 8px 32px rgba(255, 82, 82, 0.25);">
        <div style="max-width: 1600px; margin: 0 auto;">
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="font-size: 2.2em; color: #FF5252; margin-bottom: 12px; font-weight: 900; text-transform: uppercase; letter-spacing: 3px; text-shadow: 0 0 20px rgba(255, 82, 82, 0.5);">
                    ‚ö° Volatility Composite
                </h2>
                <p style="font-size: 1.15em; color: #ffffff; line-height: 1.6; max-width: 1000px; margin: 0 auto;">
                    <strong>Markets + Crypto Fear Gauge</strong> ‚Äî Real-time volatility tracking across traditional markets (VIX) and crypto (BTC/ETH). High volatility = opportunity or danger depending on your strategy.
                </p>
            </div>

            <!-- Composite Score Display -->
            <div style="background: rgba(0, 0, 0, 0.4);
                        border: 2px solid var(--border-color);
                        border-radius: 15px;
                        padding: 25px;
                        margin-bottom: 25px;
                        text-align: center;
                        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);">
                <div style="font-size: 1.05em; color: var(--text-secondary); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">
                    Composite Volatility Score
                </div>
                <div id="vixCompositeScore" style="font-size: 3.5em; font-weight: 900; margin-bottom: 10px; color: #FFD700;">
                    --
                </div>
                <div id="vixCompositeLabel" style="font-size: 1.2em; color: var(--text-secondary); font-weight: 700; margin-bottom: 15px;">
                    LOADING...
                </div>
                <!-- Volatility Bar -->
                <div style="width: 100%; max-width: 800px; height: 12px; background: rgba(255, 255, 255, 0.1); border-radius: 6px; margin: 0 auto; position: relative; overflow: hidden;">
                    <div id="vixCompositeBar" style="height: 100%; background: linear-gradient(90deg, #00ff88, #FFD700, #FF5252); border-radius: 6px; width: 50%; transition: width 0.5s ease;"></div>
                </div>
                <div style="display: flex; justify-content: space-between; max-width: 800px; margin: 10px auto 0; font-size: 0.85em; color: var(--text-secondary);">
                    <span>üü¢ Low (0-25)</span>
                    <span>üü° Normal (25-50)</span>
                    <span>üü† Elevated (50-75)</span>
                    <span>üî¥ Extreme (75-100)</span>
                </div>
            </div>

            <!-- Dual Volatility Sources -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px;">

                <!-- Traditional Markets VIX -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border: 2px solid #FF5252;
                            border-radius: 12px;
                            padding: 25px;
                            box-shadow: 0 4px 15px rgba(255, 82, 82, 0.2);">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h3 style="color: #FF5252; font-size: 1.4em; margin: 0; font-weight: 700;">
                            üìà Market Volatility (VIX)
                        </h3>
                        <span id="vix-trend-arrow" style="font-size: 2em; color: #FFD700;">‚ü≥</span>
                    </div>

                    <!-- VIX Current Value -->
                    <div style="text-align: center; padding: 20px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="font-size: 0.95em; color: var(--text-secondary); margin-bottom: 5px;">Current VIX</div>
                        <div id="vix-current-value" style="font-size: 2.8em; font-weight: 900; color: #FFD700;">--</div>
                    </div>

                    <!-- VIX Metrics -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                        <div>
                            <div style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 5px;">Daily Change</div>
                            <div id="vix-daily-change" style="font-size: 1.3em; font-weight: 700; color: #FFD700;">--</div>
                        </div>
                        <div>
                            <div style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 5px;">5-Day Change</div>
                            <div id="vix-5day-change" style="font-size: 1.3em; font-weight: 700; color: #FFD700;">--</div>
                        </div>
                    </div>

                    <!-- VIX Interpretation -->
                    <div style="margin-top: 15px; padding: 12px; background: rgba(0, 0, 0, 0.3); border-radius: 8px; border-left: 3px solid #FF5252;">
                        <div style="font-size: 0.9em; color: var(--text-secondary); margin-bottom: 5px;">Interpretation:</div>
                        <div id="vix-interpretation" style="font-size: 0.95em; color: #ffffff; line-height: 1.5;">
                            VIX measures expected S&P 500 volatility. Below 20 = calm, 20-30 = normal uncertainty, above 30 = fear.
                        </div>
                    </div>
                </div>

                <!-- Crypto Volatility -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border: 2px solid #bc13fe;
                            border-radius: 12px;
                            padding: 25px;
                            box-shadow: 0 4px 15px rgba(188, 19, 254, 0.2);">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h3 style="color: #bc13fe; font-size: 1.4em; margin: 0; font-weight: 700;">
                            ‚Çø Crypto Volatility
                        </h3>
                        <span id="crypto-vol-trend-arrow" style="font-size: 2em; color: #FFD700;">‚ü≥</span>
                    </div>

                    <!-- Crypto Vol Score -->
                    <div style="text-align: center; padding: 20px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="font-size: 0.95em; color: var(--text-secondary); margin-bottom: 5px;">Crypto Vol Index</div>
                        <div id="crypto-vol-score" style="font-size: 2.8em; font-weight: 900; color: #bc13fe;">--</div>
                    </div>

                    <!-- BTC and ETH Volatility -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                        <div>
                            <div style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 5px;">BTC 5-Day Vol</div>
                            <div id="btc-volatility" style="font-size: 1.3em; font-weight: 700; color: #FFD700;">--</div>
                        </div>
                        <div>
                            <div style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 5px;">ETH 5-Day Vol</div>
                            <div id="eth-volatility" style="font-size: 1.3em; font-weight: 700; color: #FFD700;">--</div>
                        </div>
                    </div>

                    <!-- Crypto Vol Interpretation -->
                    <div style="margin-top: 15px; padding: 12px; background: rgba(0, 0, 0, 0.3); border-radius: 8px; border-left: 3px solid #bc13fe;">
                        <div style="font-size: 0.9em; color: var(--text-secondary); margin-bottom: 5px;">Interpretation:</div>
                        <div id="crypto-vol-interpretation" style="font-size: 0.95em; color: #ffffff; line-height: 1.5;">
                            Crypto volatility measures BTC/ETH price swings. High volatility = larger price moves (opportunity + risk).
                        </div>
                    </div>
                </div>

            </div>

            <!-- Volatility Thresholds Guide -->
            <div style="background: rgba(0, 0, 0, 0.3);
                        border: 1px solid var(--border-color);
                        border-radius: 10px;
                        padding: 20px;
                        margin-top: 25px;">
                <h3 style="color: var(--accent-color); font-size: 1.15em; margin-bottom: 15px; font-weight: 700;">
                    üìä Volatility Trading Guide
                </h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; font-size: 0.95em; line-height: 1.6; color: var(--text-secondary);">
                    <div>
                        <strong style="color: #00ff88;">üü¢ LOW (0-25):</strong> Complacent markets, tight ranges, low option premiums
                    </div>
                    <div>
                        <strong style="color: #FFD700;">üü° NORMAL (25-50):</strong> Healthy volatility, normal trading conditions
                    </div>
                    <div>
                        <strong style="color: #FFA500;">üü† ELEVATED (50-75):</strong> Increased uncertainty, wider price swings
                    </div>
                    <div>
                        <strong style="color: #FF5252;">üî¥ EXTREME (75-100):</strong> Panic or euphoria, large intraday moves
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- üèÜ BEST COMPOSITE INDICATOR HIGHLIGHT -->
    <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(218, 165, 32, 0.1));
                border-top: 3px solid #FFD700;
                border-bottom: 3px solid #FFD700;
                padding: 30px 40px;
                margin: 0;
                box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);">
        <div style="max-width: 1600px; margin: 0 auto;">
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 25px;">
                <h2 style="font-size: 2.2em; color: #FFD700; margin-bottom: 8px; font-weight: 800; text-transform: uppercase; letter-spacing: 2px;">
                    üèÜ Best Composite Indicator
                </h2>
                <p style="font-size: 1.15em; color: #ffffff; line-height: 1.6; max-width: 900px; margin: 0 auto;">
                    <strong>AUD/JPY + HYG + US 10-Year Yield</strong> ‚Äî The ultimate risk sentiment barometer.
                    When all three align, they reveal institutional money flow between safety (bonds) and risk (stocks/credit).
                </p>
            </div>

            <!-- Three Indicators in Color-Coded Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">

                <!-- AUD/JPY -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #00ff88;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.2);">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üåè</div>
                    <h3 style="color: #00ff88; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        AUD/JPY <span id="audjpy-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="audjpy-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong>Risk-On/Risk-Off Barometer</strong><br>
                        Rising = Risk appetite (growth optimism)<br>
                        Falling = Risk aversion (safety seeking)
                    </p>
                </div>

                <!-- HYG (High Yield Bonds) -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #DC143C;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(220, 20, 60, 0.2);">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üí∞</div>
                    <h3 style="color: #DC143C; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        HYG <span id="hyg-value" style="font-size: 1.1em; font-weight: 800; color: #FFD700;">--</span> <span id="hyg-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong>Credit Market Health</strong><br>
                        Rising = Junk bonds bid (risk-on)<br>
                        Falling = Credit stress (risk-off)
                    </p>
                </div>

                <!-- US 10-Year Yield -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #FFD700;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üìà</div>
                    <h3 style="color: #FFD700; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        US 10-Year Yield <span id="yield-value" style="font-size: 1.1em; font-weight: 800; color: #00ff88;">--</span> <span id="yield-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong>Bond Market Expectations</strong><br>
                        Rising = Growth/inflation bets<br>
                        Falling = Safety demand (deflationary)
                    </p>
                </div>

            </div>

            <!-- Composite Score -->
            <div style="margin-top: 25px;
                        text-align: center;
                        padding: 25px;
                        background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(218, 165, 32, 0.15));
                        border-radius: 10px;
                        border: 2px solid rgba(255, 215, 0, 0.4);
                        box-shadow: 0 6px 20px rgba(255, 215, 0, 0.25);">
                <p style="color: #FFD700; font-size: 1.2em; font-weight: 700; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px;">
                    üìä Composite Risk Score
                </p>
                <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
                    <div style="font-size: 3.5em; font-weight: 800; color: #FFD700;" id="composite-score">50</div>
                    <div style="text-align: left;">
                        <div style="font-size: 1.3em; font-weight: 600; color: #ffffff;" id="composite-label">NEUTRAL</div>
                        <div style="font-size: 0.9em; color: #b0b8c8;">out of 100</div>
                    </div>
                </div>
                <div style="margin-top: 15px; height: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; overflow: hidden;">
                    <div id="composite-bar" style="height: 100%; width: 50%; background: linear-gradient(90deg, #FF5252, #FFD700, #00ff88); transition: width 0.5s ease;"></div>
                </div>
                <p style="color: #b0b8c8; font-size: 0.85em; margin-top: 10px; font-style: italic;">
                    Live calculation based on AUD/JPY, HYG, and 10Y Yield movements
                </p>
            </div>

            <!-- Why This Matters -->
            <div style="margin-top: 20px;
                        text-align: center;
                        padding: 20px;
                        background: rgba(255, 215, 0, 0.08);
                        border-radius: 10px;
                        border: 1px solid rgba(255, 215, 0, 0.3);">
                <p style="color: #FFD700; font-size: 1.1em; font-weight: 600; margin-bottom: 8px;">
                    ‚ö° Why This Triple Combo Works
                </p>
                <p style="color: #ffffff; font-size: 1em; line-height: 1.6; max-width: 1000px; margin: 0 auto;">
                    When <strong>AUD/JPY rallies</strong>, <strong>HYG strengthens</strong>, and <strong>10-year yields rise</strong> together = Strong risk-on (buy stocks).
                    When all three fall together = Flee to safety (sell risk assets, buy bonds/yen/gold).
                </p>
            </div>
        </div>
    </div>

    <!-- Crypto Best Composite Indicator Section -->
    <div style="background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(18, 32, 58, 0.9));
                padding: 50px 20px;
                margin-top: 0;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <!-- Header -->
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="font-size: 2.8em; color: #00ff88; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; font-weight: 900;">
                    üöÄ Crypto Best Composite Indicator
                </h2>
                <p style="font-size: 1.15em; color: #ffffff; line-height: 1.6; max-width: 900px; margin: 0 auto;">
                    <strong>Bitcoin + Ethereum + Solana</strong> ‚Äî The ultimate crypto risk sentiment barometer.
                    When all three align, they reveal institutional and retail money flow in the digital asset ecosystem.
                </p>
            </div>

            <!-- Three Crypto Indicators in Color-Coded Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">

                <!-- Bitcoin (BTC-USD) -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #F7931A;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(247, 147, 26, 0.2);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div style="font-size: 1.8em;">‚Çø</div>
                        <div style="text-align: right;">
                            <div id="crypto-btc-price" style="font-size: 1.4em; font-weight: 700; color: #F7931A;">--</div>
                            <div id="crypto-btc-change" style="font-size: 0.85em; color: #b0b8c8;">--</div>
                        </div>
                    </div>
                    <h3 style="color: #F7931A; font-size: 1.3em; margin-bottom: 10px; margin-top: 10px; font-weight: 700;">
                        Bitcoin <span id="crypto-btc-arrow" style="font-size: 1.2em; color: #b0b8c8;" title="Loading...">‚Üî</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong>Crypto Market Leader</strong><br>
                        Rising = Crypto risk-on (bull market)<br>
                        Falling = Crypto risk-off (bear market)
                    </p>
                </div>

                <!-- Ethereum (ETH-USD) -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #627EEA;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(98, 126, 234, 0.2);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div style="font-size: 1.8em;">‚ü†</div>
                        <div style="text-align: right;">
                            <div id="crypto-eth-price" style="font-size: 1.4em; font-weight: 700; color: #627EEA;">--</div>
                            <div id="crypto-eth-change" style="font-size: 0.85em; color: #b0b8c8;">--</div>
                        </div>
                    </div>
                    <h3 style="color: #627EEA; font-size: 1.3em; margin-bottom: 10px; margin-top: 10px; font-weight: 700;">
                        Ethereum <span id="crypto-eth-arrow" style="font-size: 1.2em; color: #b0b8c8;" title="Loading...">‚Üî</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong>Smart Contract Platform Health</strong><br>
                        Rising = DeFi/NFT ecosystem growth<br>
                        Falling = Altcoin weakness (risk-off)
                    </p>
                </div>

                <!-- Solana (SOL-USD) -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #14F195;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(20, 241, 149, 0.2);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div style="font-size: 1.8em;">‚óé</div>
                        <div style="text-align: right;">
                            <div id="crypto-sol-price" style="font-size: 1.4em; font-weight: 700; color: #14F195;">--</div>
                            <div id="crypto-sol-change" style="font-size: 0.85em; color: #b0b8c8;">--</div>
                        </div>
                    </div>
                    <h3 style="color: #14F195; font-size: 1.3em; margin-bottom: 10px; margin-top: 10px; font-weight: 700;">
                        Solana <span id="crypto-sol-arrow" style="font-size: 1.2em; color: #b0b8c8;" title="Loading...">‚Üî</span>
                    </h3>
                    <p style="color: #b0b8c8; font-size: 0.95em; line-height: 1.5;">
                        <strong>High-Beta Altcoin Sentiment</strong><br>
                        Rising = Aggressive crypto risk-on<br>
                        Falling = Flight to BTC quality
                    </p>
                </div>

            </div>

            <!-- Crypto Composite Score -->
            <div style="margin-top: 25px;
                        text-align: center;
                        padding: 25px;
                        background: linear-gradient(135deg, rgba(0, 255, 136, 0.15), rgba(20, 241, 149, 0.1));
                        border-radius: 10px;
                        border: 2px solid rgba(0, 255, 136, 0.4);
                        box-shadow: 0 6px 20px rgba(0, 255, 136, 0.25);">
                <p style="color: #00ff88; font-size: 1.2em; font-weight: 700; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px;">
                    üöÄ Crypto Risk Score
                </p>
                <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
                    <div style="font-size: 3.5em; font-weight: 800; color: #00ff88;" id="crypto-composite-score">50</div>
                    <div style="text-align: left;">
                        <div style="font-size: 1.3em; font-weight: 600; color: #ffffff;" id="crypto-composite-label">NEUTRAL</div>
                        <div style="font-size: 0.9em; color: #b0b8c8;">out of 100</div>
                    </div>
                </div>
                <div style="margin-top: 15px; height: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; overflow: hidden;">
                    <div id="crypto-composite-bar" style="height: 100%; width: 50%; background: linear-gradient(90deg, #FF5252, #F7931A, #00ff88); transition: width 0.5s ease;"></div>
                </div>
                <p style="color: #b0b8c8; font-size: 0.85em; margin-top: 10px; font-style: italic;">
                    Live calculation based on Bitcoin, Ethereum, and Solana movements
                </p>
            </div>

            <!-- Why This Crypto Combo Works -->
            <div style="margin-top: 20px;
                        text-align: center;
                        padding: 20px;
                        background: rgba(0, 255, 136, 0.08);
                        border-radius: 10px;
                        border: 1px solid rgba(0, 255, 136, 0.3);">
                <p style="color: #00ff88; font-size: 1.1em; font-weight: 600; margin-bottom: 8px;">
                    ‚ö° Why This Crypto Triple Combo Works
                </p>
                <p style="color: #ffffff; font-size: 1em; line-height: 1.6; max-width: 1000px; margin: 0 auto;">
                    When <strong>Bitcoin rallies</strong>, <strong>Ethereum strengthens</strong>, and <strong>Solana pumps</strong> together = Strong crypto risk-on (bull market).
                    When all three fall together = Crypto risk-off (sell altcoins, move to stablecoins/fiat).
                </p>
            </div>
        </div>
    </div>

    <!-- Probabilistic Recession Model Section -->
    <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(0, 0, 0, 0.95));
                padding: 50px 20px;
                margin-top: 0;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <!-- Header -->
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="font-size: 2.8em; color: #DC143C; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; font-weight: 900;">
                    üìâ Probabilistic Recession Model
                </h2>
                <p style="font-size: 1.15em; color: #ffffff; line-height: 1.6; max-width: 900px; margin: 0 auto;">
                    <strong>NY Fed Methodology</strong> ‚Äî Logistic regression using the 10Y-3M Treasury yield spread.
                    Predicts recession probability 12 months ahead with 80%+ historical accuracy.
                </p>
            </div>

            <!-- Key Metrics Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 25px;">

                <!-- 10Y-3M Spread -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #FFD700;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">üìä</div>
                    <h3 style="color: #FFD700; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        10Y-3M Spread <span id="recession-spread-arrow" style="font-size: 1.2em;">‚ü≥</span>
                    </h3>
                    <div style="font-size: 2em; color: #ffffff; font-weight: 700;" id="recession-spread">--</div>
                    <p style="color: #b0b8c8; font-size: 0.9em; line-height: 1.4; margin-top: 8px;">
                        Yield curve spread. Negative = inverted (bearish signal)
                    </p>
                </div>

                <!-- Recession Probability -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #DC143C;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(220, 20, 60, 0.2);">
                    <div style="font-size: 1.8em; margin-bottom: 10px;">‚ö†Ô∏è</div>
                    <h3 style="color: #DC143C; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        Recession Probability
                    </h3>
                    <div style="font-size: 2em; color: #DC143C; font-weight: 700;" id="recession-probability">--</div>
                    <p style="color: #b0b8c8; font-size: 0.9em; line-height: 1.4; margin-top: 8px;">
                        12-month forward probability using logistic regression
                    </p>
                </div>

                <!-- Risk Level -->
                <div style="background: rgba(18, 32, 58, 0.9);
                            border-left: 4px solid #FF5252;
                            border-radius: 10px;
                            padding: 20px;
                            box-shadow: 0 4px 15px rgba(255, 82, 82, 0.2);">
                    <div style="font-size: 1.8em; margin-bottom: 10px;" id="recession-risk-emoji">üü¢</div>
                    <h3 style="color: #FF5252; font-size: 1.3em; margin-bottom: 10px; font-weight: 700;">
                        Risk Level
                    </h3>
                    <div style="font-size: 1.6em; color: #ffffff; font-weight: 700;" id="recession-risk-level">LOADING</div>
                    <p style="color: #b0b8c8; font-size: 0.9em; line-height: 1.4; margin-top: 8px;" id="recession-risk-desc">
                        Calculating...
                    </p>
                </div>

            </div>

            <!-- Probability Visualization -->
            <div style="margin-top: 25px;
                        text-align: center;
                        padding: 25px;
                        background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(218, 165, 32, 0.15));
                        border-radius: 10px;
                        border: 2px solid rgba(220, 20, 60, 0.4);
                        box-shadow: 0 6px 20px rgba(220, 20, 60, 0.25);">
                <p style="color: #DC143C; font-size: 1.2em; font-weight: 700; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px;">
                    üìà Recession Risk Barometer
                </p>
                <div style="margin-top: 15px; height: 12px; background: rgba(0, 0, 0, 0.3); border-radius: 6px; overflow: hidden; position: relative;">
                    <!-- Risk zones -->
                    <div style="position: absolute; width: 15%; height: 100%; background: #00ff88; opacity: 0.3;"></div>
                    <div style="position: absolute; left: 15%; width: 15%; height: 100%; background: #FFD700; opacity: 0.3;"></div>
                    <div style="position: absolute; left: 30%; width: 20%; height: 100%; background: #ff9966; opacity: 0.3;"></div>
                    <div style="position: absolute; left: 50%; width: 20%; height: 100%; background: #FF5252; opacity: 0.3;"></div>
                    <div style="position: absolute; left: 70%; width: 30%; height: 100%; background: #8B0000; opacity: 0.3;"></div>
                    <!-- Probability indicator -->
                    <div id="recession-bar" style="position: absolute; height: 100%; width: 2px; background: #ffffff; box-shadow: 0 0 10px rgba(255,255,255,0.8); transition: left 0.5s ease; left: 0%;"></div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.75em; color: #b0b8c8;">
                    <span>0% LOW</span>
                    <span>15%</span>
                    <span>30%</span>
                    <span>50%</span>
                    <span>70%</span>
                    <span>100% CRITICAL</span>
                </div>
                <p style="color: #b0b8c8; font-size: 0.85em; margin-top: 15px; font-style: italic;">
                    Model trained on 40+ years of economic data (1985-2024). 30%+ = elevated risk.
                </p>
            </div>

            <!-- Methodology Summary -->
            <div style="margin-top: 20px;
                        text-align: center;
                        padding: 20px;
                        background: rgba(220, 20, 60, 0.08);
                        border-radius: 10px;
                        border: 1px solid rgba(220, 20, 60, 0.3);">
                <p style="color: #DC143C; font-size: 1.1em; font-weight: 600; margin-bottom: 8px;">
                    üìö Industry-Standard Methodology
                </p>
                <p style="color: #ffffff; font-size: 1em; line-height: 1.6; max-width: 1000px; margin: 0 auto;">
                    Uses the same <strong>logistic regression model</strong> employed by the <strong>New York Federal Reserve</strong>.
                    When the 10Y-3M spread inverts (goes negative), recession risk increases dramatically.
                    <strong>Successfully predicted all 4 major recessions since 1985</strong> with 12-18 month lead time.
                </p>
            </div>
        </div>
    </div>

    <!-- Global Multi-Asset Market Sentiment Dashboard (Markets Tab) -->
    <div id="global-markets-dashboard" style="display: none; background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1f3a 50%, #0a0e27 100%); padding: 50px 20px;">
        <div style="max-width: 1600px; margin: 0 auto;">

            <!-- Header -->
            <div style="margin-bottom: 60px; text-align: center; border-bottom: 2px solid var(--border-color); padding-bottom: 30px;">
                <div style="display: flex; flex-direction: column; md:flex-direction: row; justify-content: space-between; align-items: center;">
                    <div>
                        <h1 style="font-size: 3.5em; font-weight: 900; background: linear-gradient(to right, #60A5FA, #A855F7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px;">
                            Global Markets
                        </h1>
                        <h2 style="font-size: 1.5em; color: var(--text-secondary); font-weight: 300;">Composite Sentiment & 14-Day Outlook</h2>
                    </div>
                    <div style="margin-top: 20px;">
                        <div style="display: inline-block; background: var(--bg-card); border-radius: 8px; padding: 15px 25px; border: 1px solid var(--border-color);">
                            <span style="display: block; font-size: 0.75em; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1.5px;">Dominant Narrative</span>
                            <span id="dominant-narrative" style="display: block; font-size: 1.2em; font-weight: 700; color: #00ff88;">Risk-On / Inflation Hedge</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 1: The Big Picture (Overview) -->
            <section style="margin-bottom: 80px;">
                <div style="display: grid; grid-template-columns: 1fr; lg:grid-template-columns: 1fr 2fr; gap: 40px;">
                    <!-- Intro Text -->
                    <div style="space-y: 20px;">
                        <h3 style="font-size: 1.8em; font-weight: 700; color: #ffffff; border-left: 4px solid var(--primary-color); padding-left: 15px;">Market Pulse</h3>
                        <p style="color: var(--text-secondary); line-height: 1.8;">
                            While Crypto exhibits "Greed," traditional markets are painting a more nuanced picture. <strong>Gold and Silver</strong> are catching a bid as inflation hedges, while <strong>Energy (Oil)</strong> lags due to supply gluts.
                        </p>
                        <p style="color: var(--text-secondary); line-height: 1.8;">
                            <strong>Equity Futures</strong> remain strong, correlating with the risk-on sentiment, but <strong>Bonds</strong> are suffering as yields creep higher, signaling investors expect rates to stay elevated.
                        </p>
                        <div style="background: rgba(255, 215, 0, 0.2); padding: 20px; border-radius: 8px; border: 1px solid rgba(255, 215, 0, 0.3); margin-top: 20px;">
                            <h4 style="color: var(--primary-color); font-weight: 700; margin-bottom: 5px;">Key Takeaway</h4>
                            <p style="font-size: 0.9em; color: var(--text-secondary);">Commodities are decoupling. Industrial metals are waiting for manufacturing data, while precious metals join the liquidity rally.</p>
                        </div>
                    </div>

                    <!-- Main Bar Chart: Sentiment Ranking -->
                    <div style="background: var(--bg-card); border-radius: 12px; border: 1px solid var(--border-color); padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
                        <h4 style="font-size: 1.2em; font-weight: 600; color: var(--text-primary); margin-bottom: 20px;">Composite Sentiment Score (0 = Extreme Fear, 100 = Extreme Greed)</h4>
                        <div style="position: relative; height: 400px;">
                            <canvas id="overviewBarChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Precious Metals (Gold, Silver, Platinum) -->
            <section style="margin-bottom: 80px;">
                <div style="display: flex; align-items: center; margin-bottom: 30px;">
                    <div style="width: 40px; height: 4px; background: #FFD700; margin-right: 15px;"></div>
                    <h3 style="font-size: 2em; font-weight: 700; color: #ffffff;">Precious Metals: The Hedge Trade</h3>
                </div>

                <div style="display: grid; grid-template-columns: 1fr; md:grid-template-columns: 1fr 1fr; gap: 40px;">
                    <!-- Left: Chart -->
                    <div style="background: var(--bg-card); border-radius: 12px; border: 1px solid var(--border-color); padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
                        <div style="display: flex; justify-content: space-between; align-items: end; margin-bottom: 20px;">
                            <h4 style="font-size: 1.2em; font-weight: 600; color: #FFD700;">Price Action Divergence (14-Day)</h4>
                            <span style="font-size: 0.75em; color: var(--text-secondary);">Normalized % Change</span>
                        </div>
                        <div style="position: relative; height: 350px;">
                            <canvas id="metalsLineChart"></canvas>
                        </div>
                    </div>

                    <!-- Right: Context & Breakdown -->
                    <div style="display: flex; flex-direction: column; gap: 30px;">
                        <div style="background: var(--bg-card); border-radius: 12px; padding: 25px; border-left: 4px solid #FFD700; border: 1px solid var(--border-color);">
                            <h4 style="font-size: 1.3em; font-weight: 700; color: #ffffff; margin-bottom: 10px;">Gold (XAU)</h4>
                            <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 15px;">
                                Trading near ATHs. The composite score is <strong style="color: #00ff88;">68 (Bullish)</strong> driven by central bank buying and geopolitical uncertainty. It is acting as the primary safe haven.
                            </p>
                            <div style="display: flex; gap: 10px;">
                                <span style="padding: 6px 12px; background: rgba(0, 255, 136, 0.2); color: #00ff88; font-size: 0.75em; border-radius: 4px; border: 1px solid rgba(0, 255, 136, 0.3);">Trend: Strong Up</span>
                                <span style="padding: 6px 12px; background: var(--bg-darker); color: var(--text-secondary); font-size: 0.75em; border-radius: 4px; border: 1px solid var(--border-color);">Vol: Low</span>
                            </div>
                        </div>

                        <div style="background: var(--bg-card); border-radius: 12px; padding: 25px; border-left: 4px solid #b0b8c8; border: 1px solid var(--border-color);">
                            <h4 style="font-size: 1.3em; font-weight: 700; color: #ffffff; margin-bottom: 10px;">Silver (XAG) & Platinum</h4>
                            <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 15px;">
                                Silver is outperforming Gold on a percentage basis (High Beta). Platinum lags due to weak auto-catalyst demand data. Silver sentiment is <strong style="color: #00ff88;">72 (Greed)</strong>.
                            </p>
                            <div style="display: flex; gap: 10px;">
                                <span style="padding: 6px 12px; background: rgba(0, 255, 136, 0.2); color: #00ff88; font-size: 0.75em; border-radius: 4px; border: 1px solid rgba(0, 255, 136, 0.3);">Silver: Breakout</span>
                                <span style="padding: 6px 12px; background: rgba(220, 20, 60, 0.2); color: #DC143C; font-size: 0.75em; border-radius: 4px; border: 1px solid rgba(220, 20, 60, 0.3);">Platinum: Weak</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 3: Industrial & Energy (Copper, Oil) -->
            <section style="margin-bottom: 80px;">
                <div style="display: flex; align-items: center; margin-bottom: 30px;">
                    <div style="width: 40px; height: 4px; background: #f59e0b; margin-right: 15px;"></div>
                    <h3 style="font-size: 2em; font-weight: 700; color: #ffffff;">Industrial & Energy: The Growth Engine</h3>
                </div>

                <div style="display: grid; grid-template-columns: 1fr; lg:grid-template-columns: 1fr 2fr; gap: 40px;">
                     <!-- Narrative -->
                     <div style="color: var(--text-secondary); display: flex; flex-direction: column; gap: 20px;">
                        <p>
                            <strong>Crude Oil (WTI)</strong> is struggling. Despite geopolitical tensions, supply from non-OPEC nations is keeping a lid on prices. The sentiment is effectively <strong style="color: #FFD700;">Neutral (45)</strong>.
                        </p>
                        <p>
                            <strong>Copper ("Dr. Copper")</strong> is flashing mixed signals. While long-term electrification demand is clear, short-term manufacturing PMIs from major economies are soft, keeping sentiment grounded at <strong style="color: #60A5FA;">55</strong>.
                        </p>
                    </div>

                    <!-- Chart: Radar Comparison -->
                    <div style="background: var(--bg-card); border-radius: 12px; border: 1px solid var(--border-color); padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
                        <h4 style="font-size: 1.2em; font-weight: 600; color: #f59e0b; margin-bottom: 5px;">Factor Analysis: Oil vs. Copper</h4>
                        <p style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 20px;">Comparing the fundamental drivers (0-100 Strength)</p>
                        <div style="position: relative; height: 350px; max-width: 600px; margin: 0 auto;">
                            <canvas id="industrialRadarChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: Financials (Bonds & Futures) -->
            <section style="margin-bottom: 80px;">
                 <div style="display: flex; align-items: center; margin-bottom: 30px;">
                    <div style="width: 40px; height: 4px; background: #A855F7; margin-right: 15px;"></div>
                    <h3 style="font-size: 2em; font-weight: 700; color: #ffffff;">Financials: Rates vs. Equities</h3>
                </div>

                <div style="display: grid; grid-template-columns: 1fr; md:grid-template-columns: 1fr 1fr; gap: 40px;">
                    <!-- S&P Futures -->
                    <div style="background: var(--bg-card); border-radius: 12px; border: 1px solid var(--border-color); padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
                        <h4 style="font-size: 1.2em; font-weight: 600; color: #A855F7; margin-bottom: 15px;">Equity Futures (S&P 500 / Nasdaq)</h4>
                        <p style="font-size: 0.9em; color: var(--text-secondary); margin-bottom: 20px;">Momentum is high. Futures are pricing in a soft landing, ignoring the bond market's warning signs.</p>
                        <div style="position: relative; height: 250px;">
                            <canvas id="futuresGaugeChart"></canvas>
                        </div>
                        <div style="text-align: center; margin-top: -40px; position: relative; z-index: 10;">
                            <div id="futures-gauge-score" style="font-size: 3em; font-weight: 700; color: #ffffff;">78</div>
                            <div id="futures-gauge-label" style="font-size: 0.9em; color: #A855F7;">Extreme Greed</div>
                        </div>
                    </div>

                    <!-- Bonds Yield Curve -->
                    <div style="background: var(--bg-card); border-radius: 12px; border: 1px solid var(--border-color); padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
                        <h4 style="font-size: 1.2em; font-weight: 600; color: var(--primary-color); margin-bottom: 15px;">US Treasury Yields (Bearish for Prices)</h4>
                        <p style="font-size: 0.9em; color: var(--text-secondary); margin-bottom: 20px;">Yields remain inverted but are shifting up. High yields = Low Bond Prices.</p>
                         <div style="position: relative; height: 250px;">
                            <canvas id="bondsChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Risk/Reward Map -->
            <section style="margin-bottom: 40px;">
                <h3 style="font-size: 2em; font-weight: 700; color: #ffffff; margin-bottom: 30px; text-align: center;">Cross-Asset Risk Map</h3>
                <div style="background: var(--bg-card); border-radius: 12px; border: 1px solid var(--border-color); padding: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
                    <p style="text-align: center; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 30px;">
                        Position Size (Bubble) = Relative Volume | X-Axis = Sentiment | Y-Axis = 14-Day Volatility
                    </p>
                    <div style="position: relative; height: 500px;">
                        <canvas id="riskBubbleChart"></canvas>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <div class="flashcard-network" id="flashcardNetwork">


            <!-- ===== NAVIGATION SECTION ===== -->
            <div style="grid-column: 1 / -1; text-align: center; margin: 40px 0 30px 0;">
                <h2 style="font-size: 2.5em; color: #FFD700; margin-bottom: 10px;">Research Pathways</h2>
                <p style="color: #b0b8c8; font-size: 1.1em;">Select a section to explore professional trading tools and market intelligence</p>
            </div>

            <!-- Navigation Flashcard: Highlights -->
            <div class="flashcard" data-id="nav-highlights" data-category="navigation" data-connections="nav-capital-flow,nav-tools,nav-elite-strategies,nav-daily-planet,nav-breakthrough,nav-daily-dose" onclick="window.location.href="/pages/highlights.html"" style="cursor: pointer; border: 2px solid rgba(255, 215, 0, 0.4); background: linear-gradient(135deg, rgba(255, 215, 0, 0.05), rgba(211, 47, 47, 0.05));">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">‚≠ê</span>
                    <h3 class="flashcard-title" style="color: #FFD700; font-size: 1.5em;">Highlights</h3>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Key trading insights and profit opportunities from all research tools. Discover arbitrage plays, VIX signals, seasonal patterns, and high-probability setups with proven win rates.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">12 Key Insights</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Profit Opportunities</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Win Rates</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Global Capital Flow -->
            <div class="flashcard" data-id="nav-capital-flow" data-category="navigation" data-connections="nav-highlights,nav-gauges,nav-barometers,nav-market-intelligence,nav-historical,nav-tools" onclick="window.location.href="/dashboards/global_capital_flow_swing_trading.html"" style="cursor: pointer; border: 2px solid rgba(220, 20, 60, 0.6); background: linear-gradient(135deg, rgba(255, 215, 0, 0.08), rgba(218, 165, 32, 0.12)); box-shadow: 0 4px 25px rgba(220, 20, 60, 0.2); transform: translateY(-2px);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üåê</span>
                    <h3 class="flashcard-title" style="color: #DC143C; font-size: 1.5em;">Global Capital Flow</h3>
                    <span class="flashcard-count" style="background: rgba(220, 20, 60, 0.3); color: #DC143C;">6 Markets</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Real-time tracking of capital movement across global markets. Monitor US, European, Asian, and emerging market flows with validated Yahoo Finance data and comprehensive flow analytics.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(220, 20, 60, 0.2); color: #DC143C;">Live Data</span>
                    <span class="tag" style="background: rgba(220, 20, 60, 0.2); color: #DC143C;">Yahoo Finance</span>
                    <span class="tag" style="background: rgba(220, 20, 60, 0.2); color: #DC143C;">Validated</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Elite Research Tools -->
            <div class="flashcard" data-id="nav-tools" data-category="navigation" data-connections="nav-highlights,nav-capital-flow,nav-screeners,nav-elite-strategies,nav-journal,nav-breakthrough" onclick="window.location.href="/pages/elite_tools.html"" style="cursor: pointer; border: 2px solid rgba(96, 165, 250, 0.4); background: linear-gradient(135deg, rgba(96, 165, 250, 0.05), rgba(59, 130, 246, 0.05));">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üî¨</span>
                    <h3 class="flashcard-title" style="color: #60A5FA; font-size: 1.5em;">Elite Research Tools</h3>
                    <span class="flashcard-count" style="background: rgba(96, 165, 250, 0.3); color: #60A5FA;">22 Tools</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Professional trading and analysis tools: Symbol Research, VIX Correlation, COT Intelligence, Econometrics, FRED Economic Data, Seasonality, GARP, ROCE, Market Cycles, and more.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(96, 165, 250, 0.2); color: #60A5FA;">22 Professional Tools</span>
                    <span class="tag" style="background: rgba(96, 165, 250, 0.2); color: #60A5FA;">AI-Powered</span>
                    <span class="tag" style="background: rgba(96, 165, 250, 0.2); color: #60A5FA;">Real-time Data</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Trading Journal -->
            <div class="flashcard" data-id="nav-journal" data-category="navigation" data-connections="nav-tools,nav-elite-strategies,nav-breakthrough,nav-screeners,nav-daily-planet" onclick="window.location.href="/pages/COMPREHENSIVE_TRADING_JOURNAL.html"" style="cursor: pointer; border: 2px solid rgba(147, 51, 234, 0.4); background: linear-gradient(135deg, rgba(147, 51, 234, 0.05), rgba(168, 85, 247, 0.05));">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üìî</span>
                    <h3 class="flashcard-title" style="color: #A855F7; font-size: 1.5em;">Trading Journal</h3>
                    <span class="flashcard-count" style="background: rgba(147, 51, 234, 0.3); color: #A855F7;">Performance Analytics</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Professional trading journal with performance analytics, risk management, trade tracking, and AI coaching system. Track P&L by setup, timeframe, day-of-week. Identify your best setups and eliminate losing patterns.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(147, 51, 234, 0.2); color: #A855F7;">Performance Metrics</span>
                    <span class="tag" style="background: rgba(147, 51, 234, 0.2); color: #A855F7;">Risk Management</span>
                    <span class="tag" style="background: rgba(147, 51, 234, 0.2); color: #A855F7;">AI Coaching</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Daily Planet (NEWS & INTELLIGENCE) - PRIORITY PLACEMENT -->
            <div class="flashcard" data-id="nav-daily-planet" data-category="navigation" data-connections="nav-highlights,nav-daily-dose,nav-journal,nav-breakthrough" onclick="window.location.href="/dashboards/daily_planet.html"" style="cursor: pointer; border: 2px solid rgba(65, 105, 225, 0.5); background: linear-gradient(135deg, rgba(65, 105, 225, 0.08), rgba(30, 144, 255, 0.08)); box-shadow: 0 4px 20px rgba(65, 105, 225, 0.15);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üì∞</span>
                    <h3 class="flashcard-title" style="color: #4169E1; font-size: 1.5em;">Daily Planet</h3>
                    <span class="flashcard-count" style="background: rgba(65, 105, 225, 0.3); color: #4169E1;">20+ News Articles</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Real-time global market news with AI sentiment analysis. Billion-dollar moves, breaking news, sector updates, emerging technology alerts. Email delivery daily at 6:01 AM Melbourne time to naga.kvv@gmail.com.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(65, 105, 225, 0.2); color: #4169E1;">AI Sentiment</span>
                    <span class="tag" style="background: rgba(65, 105, 225, 0.2); color: #4169E1;">Daily Email</span>
                    <span class="tag" style="background: rgba(65, 105, 225, 0.2); color: #4169E1;">Clickable News</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Breakthrough Insights Arsenal -->
            <div class="flashcard" data-id="nav-breakthrough" data-category="navigation" data-connections="nav-highlights,nav-tools,nav-journal,nav-elite-strategies,nav-daily-planet" onclick="window.location.href="/pages/breakthrough_insights.html"" style="cursor: pointer; border: 2px solid rgba(147, 51, 234, 0.5); background: linear-gradient(135deg, rgba(147, 51, 234, 0.08), rgba(168, 85, 247, 0.08)); box-shadow: 0 4px 20px rgba(147, 51, 234, 0.15);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üõ°Ô∏è</span>
                    <h3 class="flashcard-title" style="color: #9333EA; font-size: 1.5em;">Breakthrough Insights Arsenal</h3>
                    <span class="flashcard-count" style="background: rgba(147, 51, 234, 0.3); color: #A855F7;">4 AI Agents</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    4 parallel AI agents analyzing every symbol: Breakthrough Agent (hidden opportunities), Discovery Agent (emerging trends), Pattern Agent (technical setups), and Timing Agent (entry/exit points). Real-time multi-agent intelligence system.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(147, 51, 234, 0.2); color: #A855F7;">4 AI Agents</span>
                    <span class="tag" style="background: rgba(147, 51, 234, 0.2); color: #A855F7;">Parallel Analysis</span>
                    <span class="tag" style="background: rgba(147, 51, 234, 0.2); color: #A855F7;">Real-Time Intel</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Market Gauges (NEW - CRITICAL) -->
            <div class="flashcard" data-id="nav-gauges" data-category="navigation" data-connections="nav-capital-flow,nav-barometers,nav-market-intelligence,nav-historical" onclick="window.location.href="/pages/market_gauges.html"" style="cursor: pointer; border: 2px solid rgba(255, 215, 0, 0.5); background: linear-gradient(135deg, rgba(255, 215, 0, 0.08), rgba(218, 165, 32, 0.08)); box-shadow: 0 4px 20px rgba(255, 215, 0, 0.15);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">‚ö°</span>
                    <h3 class="flashcard-title" style="color: #FFD700; font-size: 1.5em;">Market Gauges</h3>
                    <span class="flashcard-count" style="background: rgba(255, 215, 0, 0.3); color: #FFD700;">24 Critical Indicators</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Professional-grade real-time market gauges: VIX, Dollar Index, Treasury Yields, Yield Curve, Put/Call Ratio, Gold, Oil, Bitcoin, Credit Spreads, TED Spread, Currency Strength, Market Breadth. Essential for reading market regime and risk levels.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Real-Time Data</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Risk Assessment</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Market Regime</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Intermarket Barometers (NEW - CRITICAL) -->
            <div class="flashcard" data-id="nav-barometers" data-category="navigation" data-connections="nav-capital-flow,nav-gauges,nav-market-intelligence" onclick="window.location.href="/pages/barometers.html"" style="cursor: pointer; border: 2px solid rgba(255, 107, 107, 0.5); background: linear-gradient(135deg, rgba(255, 107, 107, 0.08), rgba(255, 165, 0, 0.08)); box-shadow: 0 4px 20px rgba(255, 107, 107, 0.15);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üìä</span>
                    <h3 class="flashcard-title" style="color: #FF6B6B; font-size: 1.5em;">Intermarket Barometers</h3>
                    <span class="flashcard-count" style="background: rgba(255, 107, 107, 0.3); color: #FF6B6B;">10 Leading Indicators</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Predict market direction 6-18 months in advance with credit spreads, yield curves, copper/gold ratio, AUD/JPY, VIX, and 5 more proven indicators. Composite risk score updated every 15 minutes from FRED & Yahoo Finance. NO FAKE DATA - all verified sources.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(255, 107, 107, 0.2); color: #FF6B6B;">6-18 Month Lead</span>
                    <span class="tag" style="background: rgba(255, 107, 107, 0.2); color: #FF6B6B;">Real-Time Updates</span>
                    <span class="tag" style="background: rgba(255, 107, 107, 0.2); color: #FF6B6B;">Verified Data</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Elite Trading Strategies -->
            <div class="flashcard" data-id="nav-elite-strategies" data-category="navigation" data-connections="nav-highlights,nav-journal,nav-breakthrough,nav-screeners,nav-tools" onclick="window.location.href="/pages/elite_trading_strategies.html"" style="cursor: pointer; border: 2px solid rgba(255, 215, 0, 0.6); background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(218, 165, 32, 0.08)); box-shadow: 0 4px 25px rgba(255, 215, 0, 0.3);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üèÜ</span>
                    <h3 class="flashcard-title" style="color: #FFD700; font-size: 1.6em; font-weight: bold;">Elite Trading Strategies</h3>
                    <span class="flashcard-count" style="background: rgba(255, 215, 0, 0.4); color: #FFD700; font-weight: bold;">80%+ CONFIDENCE ONLY</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.1em; font-weight: 500;">
                    üèÜ <b>SPARTAN EXCLUSIVE:</b> 20 hand-picked strategies with 80%+ win rates. From 94% ES Friday Selloff to 89% PLTR Contract Gaps ($8,120 profit). Elite-grade patterns that meet Spartan standards of excellence.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(255, 215, 0, 0.3); color: #FFD700; font-weight: bold;">üèÜ SPARTAN CERTIFIED</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.25); color: #FFD700;">94% HIGHEST WIN RATE</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.25); color: #FFD700;">$8,120 MAX PROFIT</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Screeners -->
            <div class="flashcard" data-id="nav-screeners" data-category="navigation" data-connections="nav-tools,nav-elite-strategies,nav-journal,nav-breakthrough" onclick="window.location.href="/pages/screener/screeners_hub.html"" style="cursor: pointer; border: 2px solid rgba(255, 215, 0, 0.4); background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(218, 165, 32, 0.05));">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üõ°Ô∏è</span>
                    <h3 class="flashcard-title" style="color: #DC143C; font-size: 1.5em;">Screener Hub</h3>
                    <span class="flashcard-count" style="background: rgba(255, 215, 0, 0.3); color: #FFD700;">9 Screeners</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Triple Timeframe Confluence Strategy using Commitment of Traders data. Follow the "smart money" across 3 timeframes (4-week, 13-week, 52-week) for high-probability setups. 76% win rate, 3.4 Sharpe ratio, only 14% max drawdown.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">76% Win Rate</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">3.4 Sharpe Ratio</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Smart Money</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Nano Banana Scanner (NEW) -->
            <div class="flashcard" data-id="nav-nano-banana" data-category="navigation" data-connections="nav-screeners,nav-tools,nav-daily-dose,nav-breakthrough" onclick="window.location.href="/pages/nano_banana_scanner.html"" style="cursor: pointer; border: 2px solid rgba(250, 204, 21, 0.6); background: linear-gradient(135deg, rgba(250, 204, 21, 0.12), rgba(234, 179, 8, 0.08)); box-shadow: 0 4px 20px rgba(250, 204, 21, 0.25);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üçå</span>
                    <h3 class="flashcard-title" style="color: #FACC15; font-size: 1.5em;">Nano Banana Scanner</h3>
                    <span class="flashcard-count" style="background: rgba(250, 204, 21, 0.3); color: #FACC15;">Polygon.io Powered</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Advanced multi-factor stock scanner with 8-point scoring system. Analyzes trend, volume, relative strength, RSI, weekly trend, stop loss distance, event risk, and volatility squeeze. Get instant ALPHA PRIME, GO, WAIT, or ABORT signals on any ticker list.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(250, 204, 21, 0.2); color: #FACC15;">8-Point Scoring</span>
                    <span class="tag" style="background: rgba(250, 204, 21, 0.2); color: #FACC15;">Real-Time Analysis</span>
                    <span class="tag" style="background: rgba(250, 204, 21, 0.2); color: #FACC15;">Polygon.io API</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Daily Dose (NEW) -->
            <div class="flashcard" data-id="nav-daily-dose" data-category="navigation" data-connections="nav-highlights,nav-daily-planet,nav-breakthrough" onclick="window.location.href="/pages/daily_dose.html"" style="cursor: pointer; border: 2px solid rgba(255, 215, 0, 0.5); background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.05)); box-shadow: 0 4px 20px rgba(255, 215, 0, 0.2);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">‚ö°</span>
                    <h3 class="flashcard-title" style="color: #FFD700; font-size: 1.5em;">Daily Dose</h3>
                    <span class="flashcard-count" style="background: rgba(255, 215, 0, 0.3); color: #FFD700;">6 Morning Scanners</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Professional-grade morning scanners delivered at 6:00 AM Melbourne time. High momentum stocks, unusual volume alerts, gap up/down, institutional flow, breakout candidates, and options activity. Powered by Polygon.io real-time data.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Daily Email Alerts</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">6:00 AM MEL</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Real-Time Data</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Market Intelligence Reports (NEW) -->
            <div class="flashcard" data-id="nav-market-intelligence" data-category="navigation" data-connections="nav-capital-flow,nav-gauges,nav-barometers,nav-historical" onclick="window.location.href="/pages/intelligence_reports.html"" style="cursor: pointer; border: 2px solid rgba(218, 165, 32, 0.5); background: linear-gradient(135deg, rgba(218, 165, 32, 0.1), rgba(255, 215, 0, 0.05)); box-shadow: 0 4px 20px rgba(218, 165, 32, 0.2);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">‚öîÔ∏è</span>
                    <h3 class="flashcard-title" style="color: #DAA520; font-size: 1.5em;">Market Intelligence Reports</h3>
                    <span class="flashcard-count" style="background: rgba(218, 165, 32, 0.3); color: #FFD700;">5 Intelligence Dashboards</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Deep-dive intelligence dashboards for strategic assets: Gold ü•á, Bitcoin ‚Çø, Oil üõ¢Ô∏è, Bonds üìà, and Copper üî∂. Comprehensive analysis covering pricing, correlations, supply/demand, and institutional positioning.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(218, 165, 32, 0.2); color: #FFD700;">Gold</span>
                    <span class="tag" style="background: rgba(218, 165, 32, 0.2); color: #FFD700;">Bitcoin</span>
                    <span class="tag" style="background: rgba(218, 165, 32, 0.2); color: #FFD700;">Oil</span>
                    <span class="tag" style="background: rgba(218, 165, 32, 0.2); color: #FFD700;">Bonds</span>
                    <span class="tag" style="background: rgba(218, 165, 32, 0.2); color: #FFD700;">Copper</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Correlation Matrix (NEW) -->
            <div class="flashcard" data-id="nav-correlation-matrix" data-category="tools" data-connections="nav-capital-flow,nav-market-intelligence,nav-gauges,nav-tools" onclick="window.location.href="/dashboards/correlation_matrix.html"" style="cursor: pointer; border: 2px solid rgba(0, 255, 136, 0.5); background: linear-gradient(135deg, rgba(0, 255, 136, 0.08), rgba(34, 197, 94, 0.08)); box-shadow: 0 4px 20px rgba(0, 255, 136, 0.2);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üîó</span>
                    <h3 class="flashcard-title" style="color: #00ff88; font-size: 1.5em;">Correlation Matrix</h3>
                    <span class="flashcard-count" style="background: rgba(0, 255, 136, 0.3); color: #00ff88;">41 Assets - 7 Classes</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Comprehensive correlation analysis across 41 assets: Equity Indices, Bonds, Crypto, Forex, Commodities, Sectors, and International Markets. Filter by category, search assets, and get plain English trading insights with diversification signals.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(0, 255, 136, 0.2); color: #00ff88;">30-Day Rolling</span>
                    <span class="tag" style="background: rgba(0, 255, 136, 0.2); color: #00ff88;">Diversification</span>
                    <span class="tag" style="background: rgba(0, 255, 136, 0.2); color: #00ff88;">Buy Signals</span>
                    <span class="tag" style="background: rgba(0, 255, 136, 0.2); color: #00ff88;">Risk Management</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Bitcoin Correlations (NEW) -->
            <div class="flashcard" data-id="nav-bitcoin-correlations" data-category="tools" data-connections="nav-correlation-matrix,nav-capital-flow,nav-market-intelligence" onclick="window.location.href="/pages/bitcoin_correlations.html"" style="cursor: pointer; border: 2px solid rgba(255, 215, 0, 0.5); background: linear-gradient(135deg, rgba(255, 215, 0, 0.08), rgba(255, 165, 0, 0.08)); box-shadow: 0 4px 20px rgba(255, 215, 0, 0.2);">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">‚Çø</span>
                    <h3 class="flashcard-title" style="color: #FFD700; font-size: 1.5em;">Bitcoin Futures Correlations</h3>
                    <span class="flashcard-count" style="background: rgba(255, 215, 0, 0.3); color: #FFD700;">25+ Futures Markets</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Bitcoin Universal Futures Correlation Monitor. Track BTC correlations across equity indices (ES, NQ, YM, RTY), metals (Gold, Silver, COPPER), energy (Oil, Gas), forex, rates, and VIX. Multi-timeframe analysis with regime detection for capital flows.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Multi-Timeframe</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Copper Key</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Regime Detection</span>
                    <span class="tag" style="background: rgba(255, 215, 0, 0.2); color: #FFD700;">Risk-On/Off</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Historical Connections -->
            <div class="flashcard" data-id="nav-historical" data-category="navigation" data-connections="nav-capital-flow,nav-gauges,nav-market-intelligence,nav-tools,nav-correlation-matrix" onclick="window.location.href="/pages/historical_connections.html"" style="cursor: pointer; border: 2px solid rgba(220, 20, 60, 0.4); background: linear-gradient(135deg, rgba(255, 215, 0, 0.05), rgba(218, 165, 32, 0.05));">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üìä</span>
                    <h3 class="flashcard-title" style="color: #DC143C; font-size: 1.5em;">Historical Connections</h3>
                    <span class="flashcard-count" style="background: rgba(220, 20, 60, 0.3); color: #DC143C;">Pattern Analysis</span>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    Discover profitable patterns in historical price action. Analyze how symbols behave over time and identify recurring setups with high win rates. Includes success rates, risk/reward ratios, and typical duration for 8+ proven patterns.
                </div>
                <div class="flashcard-tags">
                    <span class="tag" style="background: rgba(220, 20, 60, 0.2); color: #DC143C;">8+ Patterns</span>
                    <span class="tag" style="background: rgba(220, 20, 60, 0.2); color: #DC143C;">Win Rates</span>
                    <span class="tag" style="background: rgba(220, 20, 60, 0.2); color: #DC143C;">Risk/Reward</span>
                </div>
            </div>

            <!-- Navigation Flashcard: Global Barometer (NEW) -->

            <!-- Navigation Flashcard: News -->
            <div class="flashcard" data-id="nav-news" data-category="news" style="display: none;">
                <div class="flashcard-header">
                    <span class="flashcard-icon" style="font-size: 2.5em;">üì∞</span>
                    <h3 class="flashcard-title" style="color: #4169E1; font-size: 1.5em;">Swing Trader's News Feed</h3>
                </div>
                <div class="flashcard-description" style="font-size: 1.05em;">
                    <div id="news-loading" class="loading">Loading news...</div>
                    <div id="news-error" class="error-message" style="display: none;"></div>
                    <div id="news-grid" class="news-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px;"></div>
                </div>
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        const loadingDiv = document.getElementById('news-loading');
                        const errorDiv = document.getElementById('news-error');
                        const grid = document.getElementById('news-grid');

                        // Only fetch news if the news tab is active
                        const newsTab = document.querySelector('.nav-tab[data-tab="news"]');
                        const observer = new MutationObserver((mutations) => {
                            mutations.forEach((mutation) => {
                                if (mutation.attributeName === 'class' && newsTab.classList.contains('active')) {
                                    if (grid.childElementCount === 0) { // Only fetch if grid is empty
                                        fetch('/api/news')
                                            .then(response => response.json())
                                            .then(data => {
                                                loadingDiv.style.display = 'none';
                                                if (data.error) {
                                                    errorDiv.textContent = data.error;
                                                    errorDiv.style.display = 'block';
                                                    return;
                                                }

                                                if (data.data && data.data.length > 0) {
                                                    data.data.forEach(article => {
                                                        const card = document.createElement('div');
                                                        card.className = 'news-card';
                                                        card.style.background = 'var(--bg-card)';
                                                        card.style.border = '1px solid var(--border-color)';
                                                        card.style.borderRadius = '12px';
                                                        card.style.padding = '20px';
                                                        card.style.display = 'flex';
                                                        card.style.flexDirection = 'column';

                                                        const title = document.createElement('h2');
                                                        title.textContent = article.title;
                                                        title.style.fontSize = '1.2em';
                                                        title.style.marginBottom = '10px';
                                                        title.style.color = 'var(--text-primary)';

                                                        const snippet = document.createElement('p');
                                                        snippet.textContent = article.snippet;
                                                        snippet.style.fontSize = '0.9em';
                                                        snippet.style.color = 'var(--text-secondary)';
                                                        snippet.style.flexGrow = '1';

                                                        const link = document.createElement('a');
                                                        link.href = article.url;
                                                        link.textContent = 'Read More';
                                                        link.target = '_blank';
                                                        link.style.color = 'var(--accent-color)';
                                                        link.style.textDecoration = 'none';
                                                        link.style.fontWeight = '600';
                                                        link.style.marginTop = '15px';
                                                        link.style.alignSelf = 'flex-start';

                                                        card.appendChild(title);
                                                        card.appendChild(snippet);
                                                        card.appendChild(link);

                                                        grid.appendChild(card);
                                                    });
                                                } else {
                                                    errorDiv.textContent = 'No news articles found.';
                                                    errorDiv.style.display = 'block';
                                                }
                                            })
                                            .catch(error => {
                                                loadingDiv.style.display = 'none';
                                                errorDiv.textContent = 'Failed to load news. Please try again later.';
                                                errorDiv.style.display = 'block';
                                                console.error('Error fetching news:', error);
                                            });
                                    }
                                }
                            });
                        });

                        observer.observe(newsTab, { attributes: true });
                    });
                </script>
            </div>

        </div>
    </div>

    <!-- Legend - REMOVED per user request -->

    <script>
        // Flashcard Network System
        class FlashcardNetwork {
            constructor() {
                this.flashcards = document.querySelectorAll('.flashcard');
                this.canvas = document.getElementById('networkCanvas');
                this.searchInput = document.getElementById('searchInput');
                this.filterBtns = document.querySelectorAll('.filter-btn');
                this.viewBtns = document.querySelectorAll('.view-btn');
                this.navTabs = document.querySelectorAll('.nav-tab');
                this.connectionCount = 0;
                this.currentTab = 'summary';

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateConnectionCount();
                this.drawConnections();
                window.addEventListener('resize', () => this.drawConnections());
                this.moveCompositeIndicatorToSummary();
            }

            moveCompositeIndicatorToSummary() {
                // Move the Best Composite Indicator section into the Summary tab
                const compositeSection = document.querySelector('div[style*="background: linear-gradient(135deg, rgba(255, 215, 0, 0.15)"]');
                const targetContainer = document.getElementById('best-composite-section');

                if (compositeSection && targetContainer) {
                    targetContainer.appendChild(compositeSection);
                }
            }

            setupEventListeners() {
                // Search (only if element exists)
                if (this.searchInput) {
                    this.searchInput.addEventListener('input', (e) => this.handleSearch(e.target.value));

                    // Enter key handler for search
                    this.searchInput.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.keyCode === 13) {
                            e.preventDefault();
                            // Navigate to first visible flashcard
                            const firstVisible = Array.from(this.flashcards).find(
                                card => card.style.display !== 'none'
                            );
                            if (firstVisible) {
                                this.handleCardClick(firstVisible);
                            }
                        }
                    });
                }

                // Navigation tabs
                this.navTabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        this.navTabs.forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        this.handleTabSwitch(tab.dataset.tab);
                    });
                });

                // Filter buttons
                this.filterBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.filterBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.handleFilter(btn.dataset.filter);
                    });
                });

                // View toggle
                this.viewBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.viewBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.handleView(btn.dataset.view);
                    });
                });

                // Flashcard hover
                this.flashcards.forEach(card => {
                    card.addEventListener('mouseenter', () => this.highlightConnections(card));
                    card.addEventListener('mouseleave', () => this.clearHighlights());
                    card.addEventListener('click', () => this.handleCardClick(card));
                });
            }

            handleSearch(query) {
                // Sanitize search input
                const sanitizedQuery = SpartanValidator.sanitizeInput(query);

                // Validate query length
                if (sanitizedQuery.length > 100) {
                    console.warn('Search query too long, truncating');
                    return;
                }

                const lowerQuery = sanitizedQuery.toLowerCase();
                this.flashcards.forEach(card => {
                    const text = card.textContent.toLowerCase();
                    if (text.includes(lowerQuery)) {
                        card.style.display = '';
                    } else {
                        card.style.display = 'none';
                    }
                });
            }

            handleTabSwitch(tab) {
                this.currentTab = tab;

                // Define which flashcards belong to each tab based on their data-id and data-category
                const tabMappings = {
                    'summary': (card) => {
                        const id = card.dataset.id || '';
                        // Summary: highlights, capital flow overview, key navigation items
                        return id.includes('highlight') ||
                               id.includes('nav-highlights') ||
                               id.includes('nav-capital-flow') ||
                               id.includes('nav-gauges') ||
                               id.includes('nav-barometers') ||
                               id.includes('nav-market-intelligence');
                    },
                    'markets': (card) => {
                        const id = card.dataset.id || '';
                        // Markets: market analysis, historical, gauges, barometers
                        return id.includes('nav-capital-flow') ||
                               id.includes('nav-gauges') ||
                               id.includes('nav-barometers') ||
                               id.includes('nav-historical') ||
                               id.includes('nav-market-intelligence');
                    },
                    'research-tools': (card) => {
                        const id = card.dataset.id || '';
                        const category = card.dataset.category || '';
                        // Research Tools: correlation, screeners, tools, patterns
                        return id.includes('nav-tools') ||
                               id.includes('nav-screeners') ||
                               id.includes('nav-nano-banana') ||
                               id.includes('nav-correlation') ||
                               id.includes('nav-bitcoin-correlations') ||
                               id.includes('nav-historical') ||
                               category === 'tools';
                    },
                    'intelligence': (card) => {
                        const id = card.dataset.id || '';
                        const category = card.dataset.category || '';
                        // Intelligence: daily planet, insights, strategies, journal
                        return id.includes('nav-daily-planet') ||
                               id.includes('nav-breakthrough') ||
                               id.includes('nav-elite-strategies') ||
                               id.includes('nav-journal') ||
                               id.includes('nav-daily-dose') ||
                               id.includes('nav-market-intelligence') ||
                               category === 'analytics' ||
                               category === 'intelligence';
                    },
                    'news': (card) => {
                        const id = card.dataset.id || '';
                        return id.includes('nav-news');
                    },
                    'research': (card) => {
                        return card.dataset.category === 'navigation';
                    }
                };

                // Filter flashcards based on current tab
                const filterFunction = tabMappings[tab];
                if (filterFunction) {
                    this.flashcards.forEach(card => {
                        if (filterFunction(card)) {
                            card.style.display = '';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                }

                // Reset filter buttons to 'all'
                this.filterBtns.forEach(btn => {
                    if (btn.dataset.filter === 'all') {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });

                // Redraw connections for visible flashcards
                this.drawConnections();
            }

            handleFilter(filter) {
                this.flashcards.forEach(card => {
                    if (filter === 'all') {
                        card.style.display = '';
                    } else {
                        const category = card.dataset.category;
                        card.style.display = category === filter ? '' : 'none';
                    }
                });
            }

            handleView(view) {
                if (view === 'connections') {
                    this.showAllConnections();
                } else {
                    this.hideAllConnections();
                }
            }

            highlightConnections(card) {
                const connections = card.dataset.connections;
                if (!connections) return;

                card.classList.add('highlighted');
                const connectedIds = connections.split(',');

                connectedIds.forEach(id => {
                    const connectedCard = document.querySelector(`[data-id="${id}"]`);
                    if (connectedCard) {
                        connectedCard.classList.add('highlighted');
                        this.drawLine(card, connectedCard, true);
                    }
                });
            }

            clearHighlights() {
                this.flashcards.forEach(card => card.classList.remove('highlighted'));
                this.canvas.querySelectorAll('.connection-line').forEach(line => {
                    line.classList.remove('active');
                });
            }

            showAllConnections() {
                this.flashcards.forEach(card => {
                    const connections = card.dataset.connections;
                    if (connections) {
                        const connectedIds = connections.split(',');
                        connectedIds.forEach(id => {
                            const connectedCard = document.querySelector(`[data-id="${id}"]`);
                            if (connectedCard) {
                                this.drawLine(card, connectedCard, true);
                            }
                        });
                    }
                });
            }

            hideAllConnections() {
                this.clearHighlights();
            }

            drawConnections() {
                this.canvas.innerHTML = '';
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.style.width = '100%';
                svg.style.height = '100%';
                this.canvas.appendChild(svg);
            }

            drawLine(card1, card2, active = false) {
                const rect1 = card1.getBoundingClientRect();
                const rect2 = card2.getBoundingClientRect();

                const x1 = rect1.left + rect1.width / 2;
                const y1 = rect1.top + rect1.height / 2;
                const x2 = rect2.left + rect2.width / 2;
                const y2 = rect2.top + rect2.height / 2;

                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', x1);
                line.setAttribute('y1', y1);
                line.setAttribute('x2', x2);
                line.setAttribute('y2', y2);
                line.classList.add('connection-line');
                if (active) line.classList.add('active');

                this.canvas.querySelector('svg').appendChild(line);
            }

            updateConnectionCount() {
                let count = 0;
                this.flashcards.forEach(card => {
                    const connections = card.dataset.connections;
                    if (connections) {
                        count += connections.split(',').length;
                    }
                });
                document.getElementById('connectionCount').textContent = count;
                this.connectionCount = count;
            }

            handleCardClick(card) {
                // Prevent multiple clicks (debouncing)
                if (card.classList.contains('navigating')) {
                    return; // Already navigating, ignore additional clicks
                }

                const cardId = card.dataset.id;
                const pages = {
                    // Navigation Cards
                    'nav-highlights': '/pages/highlights.html',
                    'nav-capital-flow': '/dashboards/global_capital_flow_swing_trading.html',
                    'nav-tools': '/pages/elite_tools.html',
                    'nav-journal': '/pages/COMPREHENSIVE_TRADING_JOURNAL.html',
                    'nav-daily-planet': '/dashboards/daily_planet.html',
                    'nav-breakthrough': '/pages/breakthrough_insights.html',
                    'nav-gauges': '/pages/market_gauges.html',
                    'nav-barometers': '/pages/barometers.html',
                    'nav-elite-strategies': '/pages/elite_trading_strategies.html',
                    'nav-screeners': '/pages/screener/screeners_hub.html',
                    'nav-nano-banana': '/pages/nano_banana_scanner.html',
                    'nav-daily-dose': '/pages/daily_dose.html',
                    'nav-market-intelligence': '/pages/intelligence_reports.html',
                    'nav-correlation-matrix': '/dashboards/correlation_matrix.html',
                    'nav-bitcoin-correlations': '/pages/bitcoin_correlations.html',
                    'nav-historical': '/pages/historical_connections.html',

                    // Core Research Tools
                    'symbol-research': '/pages/symbol_research.html',
                    'vix-analysis': '/pages/symbol_search_connections.html',
                    'seasonality': '/pages/seasonality_research.html',
                    'intermarket': '/pages/intermarket_relationships.html',
                    'garp': '/dashboards/garp.html',
                    'fundamental': '/pages/fundamental_analysis.html',
                    'roce': '/pages/roce_research.html',
                    'cycles': '/pages/market_cycles.html',
                    'harmonic-cycles': '/pages/harmonic_cycles.html',
                    'market-hub': '/pages/unified_market_dashboard.html',
                    'chart-analytics': '/pages/flashcard_dashboard.html',
                    'trading-journal': '/pages/COMPREHENSIVE_TRADING_JOURNAL.html',
                    'pattern-finders': '/pages/pattern_finder_hub.html',
                    'pattern-discovery': '/pages/pattern_discovery_terminal.html',

                    // Intelligence Tools
                    'econometrics': '/dashboards/econometrics.html',
                    'daily-planet': '/dashboards/daily_planet.html',
                    'breakthrough-insights': '/pages/breakthrough_insights.html',
                    'fred-economic': '/dashboards/fred_global_complete.html',
                    'cot-intelligence': '/pages/complete_cftc_cot_terminal.html',
                    'deal-hunters': '/pages/deal_hunters.html',
                    'boom-bust': '/dashboards/boom_or_bust.html',
                    'inflation-dashboard': '/pages/inflation_dashboard.html',

                    // Country-Specific Market Overviews (all redirect to symbol research)
                    'usa-stocks': '/pages/symbol_research.html',
                    'india-stocks': '/pages/symbol_research.html',
                    'japan-stocks': '/pages/symbol_research.html',
                    'china-stocks': '/pages/symbol_research.html',
                    'hongkong-stocks': '/pages/symbol_research.html',
                    'australia-stocks': '/pages/symbol_research.html',
                    'uk-stocks': '/pages/symbol_research.html',
                    'germany-stocks': '/pages/symbol_research.html',
                    'france-stocks': '/pages/symbol_research.html',
                    'netherlands-stocks': '/pages/symbol_research.html',
                    'switzerland-stocks': '/pages/symbol_research.html',
                    'spain-stocks': '/pages/symbol_research.html',
                    'italy-stocks': '/pages/symbol_research.html',
                    'sweden-stocks': '/pages/symbol_research.html',
                    'canada-stocks': '/pages/symbol_research.html',

                    // Emerging Sectors
                    'emerging-sectors': '/pages/deal_hunters.html'
                };

                if (pages[cardId]) {
                    // Mark as navigating to prevent double-clicks
                    card.classList.add('navigating');

                    // Add visual feedback
                    card.style.opacity = '0.6';

                    // Open in SEPARATE TAB with unique name (reuses tab if already open!)
                    // Navigate in the same tab for consistent user experience
                    window.location.href = pages[cardId];

                    // Reset visual state after brief delay
                    setTimeout(() => {
                        card.classList.remove('navigating');
                        card.style.opacity = '1';
                    }, 300);
                }
            }
        }

        // Update Breakthrough Insights Stats
        function updateBreakthroughStats() {
            try {
                const data = JSON.parse(localStorage.getItem('novel_insights_data') || '{}');
                let totalInsights = 0;
                let highImpact = 0;

                Object.values(data).forEach(pageData => {
                    if (pageData.insights && Array.isArray(pageData.insights)) {
                        totalInsights += pageData.insights.length;
                        highImpact += pageData.insights.filter(i => i.impact === 'high').length;
                    }
                });

                const totalInsightsEl = document.getElementById('totalInsightsCount');
                const highImpactEl = document.getElementById('highImpactCount');

                if (totalInsightsEl) totalInsightsEl.textContent = totalInsights;
                if (highImpactEl) highImpactEl.textContent = highImpact;
            } catch (error) {
                console.error('Error updating breakthrough stats:', error);
            }
        }

        // Update Deal Hunters Stats
        function updateDealHuntersStats() {
            try {
                const deals = JSON.parse(localStorage.getItem('deal_hunters_opportunities') || '[]');
                const dealsCount = deals.length;
                const topDeal = deals.length > 0 ? Math.max(...deals.map(d => d.potentialGain || 0)) : 0;

                const dealsFoundEl = document.getElementById('dealsFoundCount');
                const topDealEl = document.getElementById('topDealPercent');

                if (dealsFoundEl) dealsFoundEl.textContent = dealsCount;
                if (topDealEl) topDealEl.textContent = topDeal.toFixed(2);
            } catch (error) {
                console.error('Error updating deal hunters stats:', error);
            }
        }

        // Update Boom or Bust Stats
        function updateBoomBustStats() {
            try {
                const data = JSON.parse(localStorage.getItem('boom_bust_data') || '{"composite": 50, "status": "Neutral"}');
                const score = data.composite || 50;

                const scoreEl = document.getElementById('boomBustScore');
                if (scoreEl) scoreEl.textContent = score;

                const statusEl = document.getElementById('boomBustStatus');
                if (statusEl) {
                    if (score >= 85) {
                        statusEl.textContent = 'üö® EXTREME BOOM';
                        statusEl.style.color = '#DC143C';
                    } else if (score <= 15) {
                        statusEl.textContent = 'üö® EXTREME BUST';
                        statusEl.style.color = '#DC143C';
                    } else if (score >= 70) {
                        statusEl.textContent = '‚ö†Ô∏è Boom Warning';
                        statusEl.style.color = '#FFD700';
                    } else if (score <= 30) {
                        statusEl.textContent = '‚ö†Ô∏è Bust Warning';
                        statusEl.style.color = '#FFD700';
                    } else {
                        statusEl.textContent = '‚öñÔ∏è Neutral';
                        statusEl.style.color = '#228B22';
                    }
                }
            } catch (error) {
                console.error('Error updating boom/bust stats:', error);
            }
        }

        // Update Inflation Stats
        function updateInflationStats() {
            try {
                const data = JSON.parse(localStorage.getItem('inflation_data') || '{}');
                const cpiEl = document.getElementById('inflationCPI');
                const rateEl = document.getElementById('inflationRate');

                if (data.latestCPI) {
                    if (cpiEl) cpiEl.textContent = data.latestCPI.toFixed(1);
                    if (rateEl) rateEl.textContent = data.latestInflation.toFixed(2) + '%';
                } else {
                    if (cpiEl) cpiEl.textContent = 'N/A';
                    if (rateEl) rateEl.textContent = 'N/A';
                }
            } catch (error) {
                console.error('Error updating inflation stats:', error);
            }
        }

        // Initialize the network
        // Symbol Database Status Checker
        async function updateSymbolDatabaseStatus() {
            try {
                // Fetch database stats from PostgreSQL
                const response = await fetch('http://localhost:8888/api/db/stats');
                const data = await response.json();

                if (data.total_symbols) {
                    // Update status badge
                    const badge = document.getElementById('symbolDbBadge');
                    if (badge) {
                        badge.style.background = 'rgba(34, 139, 34, 0.2)';
                        badge.style.color = '#00ff88';
                        badge.innerHTML = `‚óè ${data.total_symbols.toLocaleString()} READY`;
                    }

                    // Update database stats
                    const totalSymbols = document.getElementById('totalSymbols');
                    if (totalSymbols) {
                        totalSymbols.textContent = data.total_symbols.toLocaleString();
                    }

                    const totalCountries = document.getElementById('totalCountries');
                    if (totalCountries) {
                        totalCountries.textContent = data.countries || '25';
                    }

                    const totalExchanges = document.getElementById('totalExchanges');
                    if (totalExchanges) {
                        totalExchanges.textContent = (data.exchanges || '26') + '+';
                    }

                    console.log('‚úÖ Symbol Database: ' + data.total_symbols.toLocaleString() + ' symbols loaded');
                } else {
                    throw new Error('Database stats unavailable');
                }
            } catch (error) {
                // Database is offline or unavailable
                const badge = document.getElementById('symbolDbBadge');
                if (badge) {
                    badge.style.background = 'rgba(211, 47, 47, 0.2)';
                    badge.style.color = '#FF5252';
                    badge.innerHTML = '‚óè OFFLINE';
                }

                console.warn('‚ö†Ô∏è Symbol Database: Unavailable');
            }
        }

        // ===== LIVE AI ADVICE TOGGLE SYSTEM =====
        function toggleAIAdviceSection(sectionId) {
            const content = document.getElementById(sectionId);
            const header = content.previousElementSibling;
            const arrow = header.querySelector('span:last-child');

            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                if (arrow) arrow.textContent = '‚ñ≤';
                // Add smooth fade-in effect
                content.style.opacity = '0';
                content.style.transition = 'opacity 0.3s ease';
                setTimeout(() => content.style.opacity = '1', 10);
            } else {
                content.style.opacity = '0';
                setTimeout(() => {
                    content.style.display = 'none';
                    if (arrow) arrow.textContent = '‚ñº';
                }, 300);
            }
        }

        // ===== AI ADVICE CHARTS INITIALIZATION =====
        function initAIAdviceCharts() {
            // Global CPI Comparison Chart
            const cpiCtx = document.getElementById('aiAdviceCpiChart');
            if (cpiCtx) {
                new Chart(cpiCtx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['üá∫üá∏ US', 'üá™üá∫ Eurozone', 'üá®üá≥ China', 'üáØüáµ Japan', 'üáÆüá≥ India', 'üá¨üáß UK'],
                        datasets: [{
                            label: 'Headline CPI %',
                            data: [2.7, 2.0, 0.8, 2.5, 4.5, 2.4],
                            backgroundColor: [
                                'rgba(255, 75, 75, 0.7)',
                                'rgba(88, 166, 255, 0.7)',
                                'rgba(255, 136, 0, 0.7)',
                                'rgba(188, 19, 254, 0.7)',
                                'rgba(0, 255, 136, 0.7)',
                                'rgba(0, 212, 255, 0.7)'
                            ],
                            borderColor: [
                                '#FF4B4B',
                                '#58A6FF',
                                '#FF8800',
                                '#bc13fe',
                                '#00ff88',
                                '#00D4FF'
                            ],
                            borderWidth: 2,
                            borderRadius: 6
                        }, {
                            label: 'Core CPI %',
                            data: [2.6, 2.3, 0.5, 2.5, 3.8, 3.4],
                            backgroundColor: 'rgba(255, 215, 0, 0.4)',
                            borderColor: '#FFD700',
                            borderWidth: 2,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: '#b0b8c8', font: { size: 11 } }
                            },
                            annotation: {
                                annotations: {
                                    target: {
                                        type: 'line',
                                        yMin: 2,
                                        yMax: 2,
                                        borderColor: '#FFD700',
                                        borderWidth: 2,
                                        borderDash: [5, 5],
                                        label: {
                                            content: '2% Target',
                                            enabled: true,
                                            position: 'end'
                                        }
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: '#b0b8c8', font: { size: 10 } },
                                grid: { color: 'rgba(255,255,255,0.05)' }
                            },
                            y: {
                                ticks: { color: '#b0b8c8', callback: v => v + '%' },
                                grid: { color: 'rgba(255,255,255,0.08)' },
                                beginAtZero: true,
                                max: 6
                            }
                        }
                    }
                });
            }

            // Central Bank Rates Chart
            const ratesCtx = document.getElementById('aiAdviceRatesChart');
            if (ratesCtx) {
                new Chart(ratesCtx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['üá∫üá∏ Fed', 'üá™üá∫ ECB', 'üá®üá≥ PBOC', 'üáØüáµ BOJ', 'üáÆüá≥ RBI', 'üá¨üáß BOE'],
                        datasets: [{
                            label: 'Current Rate %',
                            data: [3.625, 2.75, 3.1, 0.75, 6.25, 4.5],
                            backgroundColor: [
                                'rgba(255, 75, 75, 0.8)',
                                'rgba(88, 166, 255, 0.8)',
                                'rgba(255, 136, 0, 0.8)',
                                'rgba(188, 19, 254, 0.8)',
                                'rgba(0, 255, 136, 0.8)',
                                'rgba(0, 212, 255, 0.8)'
                            ],
                            borderColor: [
                                '#FF4B4B',
                                '#58A6FF',
                                '#FF8800',
                                '#bc13fe',
                                '#00ff88',
                                '#00D4FF'
                            ],
                            borderWidth: 2,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const policies = {
                                            'üá∫üá∏ Fed': 'Paused / Data-dependent',
                                            'üá™üá∫ ECB': 'On hold',
                                            'üá®üá≥ PBOC': 'Easing bias',
                                            'üáØüáµ BOJ': 'Gradual normalization',
                                            'üáÆüá≥ RBI': 'Neutral / Inflation watch',
                                            'üá¨üáß BOE': 'Cautious cuts'
                                        };
                                        return [
                                            `Rate: ${context.raw}%`,
                                            `Stance: ${policies[context.label] || ''}`
                                        ];
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: '#b0b8c8', callback: v => v + '%' },
                                grid: { color: 'rgba(255,255,255,0.08)' },
                                beginAtZero: true,
                                max: 8
                            },
                            y: {
                                ticks: { color: '#b0b8c8', font: { size: 11 } },
                                grid: { display: false }
                            }
                        }
                    }
                });
            }
        }

        // Initialize AI Advice charts when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initAIAdviceCharts, 500);
        });

        // ===== DRAG AND DROP SYSTEM =====
        let editMode = false;
        let draggedElement = null;

        function toggleEditMode() {
            editMode = !editMode;
            const btn = document.getElementById('editModeBtn');
            const container = document.getElementById('flashcardNetwork');
            const flashcards = document.querySelectorAll('.flashcard');

            if (editMode) {
                btn.classList.add('active');
                btn.innerHTML = 'üíæ Save Layout';
                container.classList.add('edit-mode-active');

                // Enable dragging
                flashcards.forEach(card => {
                    card.classList.add('draggable');
                    card.setAttribute('draggable', 'true');

                    // Add drag handle
                    if (!card.querySelector('.drag-handle')) {
                        const handle = document.createElement('div');
                        handle.className = 'drag-handle';
                        handle.innerHTML = '‚ãÆ‚ãÆ';
                        card.insertBefore(handle, card.firstChild);
                    }
                });

                initDragAndDrop();
            } else {
                btn.classList.remove('active');
                btn.innerHTML = '‚úèÔ∏è Edit Layout';
                container.classList.remove('edit-mode-active');

                // Disable dragging
                flashcards.forEach(card => {
                    card.classList.remove('draggable');
                    card.removeAttribute('draggable');
                });

                // Save layout and show toast notification when closing edit mode
                const success = saveLayout(true);  // showToast = true

                // Also export to CSV
                if (success) {
                    exportLayoutToCSV();
                }
            }
        }

        function initDragAndDrop() {
            const flashcards = document.querySelectorAll('.flashcard');

            flashcards.forEach(card => {
                card.addEventListener('dragstart', handleDragStart);
                card.addEventListener('dragend', handleDragEnd);
                card.addEventListener('dragover', handleDragOver);
                card.addEventListener('drop', handleDrop);
                card.addEventListener('dragenter', handleDragEnter);
                card.addEventListener('dragleave', handleDragLeave);
            });
        }

        function handleDragStart(e) {
            draggedElement = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');

            // Remove all drag-over classes
            document.querySelectorAll('.flashcard').forEach(card => {
                card.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDragEnter(e) {
            if (this !== draggedElement) {
                this.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }

            if (draggedElement !== this) {
                // Swap elements
                const container = this.parentNode;
                const allCards = Array.from(container.querySelectorAll('.flashcard'));
                const draggedIndex = allCards.indexOf(draggedElement);
                const targetIndex = allCards.indexOf(this);

                if (draggedIndex < targetIndex) {
                    container.insertBefore(draggedElement, this.nextSibling);
                } else {
                    container.insertBefore(draggedElement, this);
                }

                // CRITICAL FIX: Auto-save layout after drag-drop
                saveLayout();
            }

            this.classList.remove('drag-over');
            return false;
        }

        function saveLayout(showToast = false) {
            try {
                const flashcards = document.querySelectorAll('.flashcard');
                const layout = Array.from(flashcards).map(card => card.dataset.id);

                // Validate that we have flashcards and data-id attributes
                if (layout.length === 0) {
                    console.warn('‚ö†Ô∏è No flashcards found to save');
                    return false;
                }

                if (layout.some(id => !id)) {
                    console.error('‚ùå Some flashcards missing data-id attribute');
                    return false;
                }

                localStorage.setItem('spartan_flashcard_layout', JSON.stringify(layout));
                console.log('‚úÖ Layout saved:', layout);

                // Verify save succeeded
                const savedData = localStorage.getItem('spartan_flashcard_layout');
                if (!savedData) {
                    console.error('‚ùå Failed to save layout to localStorage');
                    if (showToast) {
                        showLayoutToast('Failed to save window layout', 'error');
                    }
                    return false;
                }

                // Show success notification only when explicitly requested (when app closes)
                if (showToast) {
                    showLayoutToast(`Window layout saved (${layout.length} items)`, 'success');
                }

                return true;
            } catch (error) {
                console.error('‚ùå Error saving layout:', error);
                return false;
            }
        }

        function setRecommendedLayout() {
            // Recommended layout: Daily Planet, Daily Dose, Breakthrough Insights on right side
            const recommendedLayout = [
                'nav-highlights',
                'nav-tools',
                'nav-journal',
                'nav-gauges',
                'nav-screeners',
                'nav-nano-banana',
                'nav-daily-dose',
                'nav-patterns',
                'nav-historical',
                'nav-daily-planet',        // Right side - top
                'nav-breakthrough'         // Right side - bottom
            ];

            localStorage.setItem('spartan_flashcard_layout', JSON.stringify(recommendedLayout));
            loadLayout();
            alert('‚úÖ Recommended layout applied! Daily Planet, Daily Dose, and Breakthrough Insights are now grouped together.');
        }

        function clearLayout() {
            // Utility function to reset layout to default
            try {
                localStorage.removeItem('spartan_flashcard_layout');
                console.log('‚úÖ Layout cleared - page will reload with default order');
                location.reload();
            } catch (error) {
                console.error('‚ùå Error clearing layout:', error);
            }
        }

        // Make clearLayout available globally for debugging
        window.clearSpartanLayout = clearLayout;

        // ===== CSV EXPORT/IMPORT SYSTEM =====

        function exportLayoutToCSV() {
            try {
                const flashcards = document.querySelectorAll('.flashcard');
                const layoutData = [];

                // Header row
                layoutData.push(['Position', 'ID', 'Category', 'Title', 'Connections', 'Timestamp']);

                // Data rows
                flashcards.forEach((card, index) => {
                    const title = card.querySelector('h3')?.textContent?.trim() || 'Unknown';
                    const category = card.dataset.category || 'unknown';
                    const connections = card.dataset.connections || '';

                    layoutData.push([
                        index + 1,
                        card.dataset.id || '',
                        category,
                        title,
                        connections,
                        new Date().toISOString()
                    ]);
                });

                // Convert to CSV format
                const csvContent = layoutData.map(row =>
                    row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',')
                ).join('\n');

                // Create blob and download
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);

                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                link.setAttribute('href', url);
                link.setAttribute('download', `spartan_layout_${timestamp}.csv`);
                link.style.visibility = 'hidden';

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                console.log('‚úÖ Layout exported to CSV:', layoutData.length - 1, 'flashcards');
                return true;
            } catch (error) {
                console.error('‚ùå Error exporting layout to CSV:', error);
                return false;
            }
        }

        function importLayoutFromCSV(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();

                reader.onload = function(e) {
                    try {
                        const csv = e.target.result;
                        const lines = csv.split('\n');

                        // Skip header row
                        const dataLines = lines.slice(1).filter(line => line.trim());

                        // Extract IDs in order
                        const layout = dataLines.map(line => {
                            // Simple CSV parser (handles quoted fields)
                            const match = line.match(/^"?\d+"?,"?([^"]+)"?/);
                            return match ? match[1] : null;
                        }).filter(id => id);

                        if (layout.length === 0) {
                            throw new Error('No valid flashcard IDs found in CSV');
                        }

                        // Save layout to localStorage
                        localStorage.setItem('spartan_flashcard_layout', JSON.stringify(layout));

                        // Apply layout
                        loadLayout();

                        console.log('‚úÖ Layout imported from CSV:', layout.length, 'flashcards');
                        showLayoutToast(`Layout imported from CSV (${layout.length} items)`, 'success');

                        resolve(layout);
                    } catch (error) {
                        console.error('‚ùå Error importing layout from CSV:', error);
                        showLayoutToast('Failed to import layout from CSV', 'error');
                        reject(error);
                    }
                };

                reader.onerror = function() {
                    reject(new Error('Failed to read CSV file'));
                };

                reader.readAsText(file);
            });
        }

        // Make CSV functions available globally
        window.exportSpartanLayoutCSV = exportLayoutToCSV;
        window.importSpartanLayoutCSV = function() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    importLayoutFromCSV(file);
                }
            };
            input.click();
        };

        // Toast notification system for layout saves
        function showLayoutToast(message, type = 'success') {
            // Create toast element
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 16px 24px;
                background: ${type === 'success' ? 'linear-gradient(135deg, rgba(16, 185, 129, 0.95), rgba(5, 150, 105, 0.95))' : 'linear-gradient(135deg, rgba(239, 68, 68, 0.95), rgba(220, 38, 38, 0.95))'};
                color: white;
                border-radius: 8px;
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
                font-weight: 600;
                font-size: 14px;
                z-index: 999999;
                animation: slideInRight 0.3s ease-out;
                backdrop-filter: blur(10px);
                border: 1px solid ${type === 'success' ? 'rgba(16, 185, 129, 0.3)' : 'rgba(239, 68, 68, 0.3)'};
            `;

            toast.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 20px;">${type === 'success' ? '‚úÖ' : '‚ùå'}</span>
                    <span>${message}</span>
                </div>
            `;

            // Add animation keyframes if not already present
            if (!document.getElementById('toastAnimations')) {
                const style = document.createElement('style');
                style.id = 'toastAnimations';
                style.textContent = `
                    @keyframes slideInRight {
                        from {
                            transform: translateX(400px);
                            opacity: 0;
                        }
                        to {
                            transform: translateX(0);
                            opacity: 1;
                        }
                    }
                    @keyframes slideOutRight {
                        from {
                            transform: translateX(0);
                            opacity: 1;
                        }
                        to {
                            transform: translateX(400px);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
            }

            document.body.appendChild(toast);

            // Auto-remove after 3 seconds with slide-out animation
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        function loadLayout() {
            const savedLayout = localStorage.getItem('spartan_flashcard_layout');
            if (!savedLayout) {
                console.log('‚ÑπÔ∏è No saved layout found - using default order');
                return;
            }

            try {
                const layout = JSON.parse(savedLayout);

                // Validate layout data
                if (!Array.isArray(layout) || layout.length === 0) {
                    console.warn('‚ö†Ô∏è Invalid layout data - clearing localStorage');
                    localStorage.removeItem('spartan_flashcard_layout');
                    return;
                }

                const container = document.getElementById('flashcardNetwork');
                if (!container) {
                    console.error('‚ùå Flashcard container not found');
                    return;
                }

                const flashcards = Array.from(container.querySelectorAll('.flashcard'));

                if (flashcards.length === 0) {
                    console.warn('‚ö†Ô∏è No flashcards found in DOM - deferring load');
                    // Retry after DOM is fully ready
                    setTimeout(loadLayout, 100);
                    return;
                }

                // Create a map of flashcards by ID
                const cardMap = {};
                flashcards.forEach(card => {
                    if (card.dataset.id) {
                        cardMap[card.dataset.id] = card;
                    }
                });

                // Validate that saved IDs match actual flashcards
                let validCount = 0;
                layout.forEach(id => {
                    if (cardMap[id]) {
                        validCount++;
                    }
                });

                if (validCount === 0) {
                    console.warn('‚ö†Ô∏è No matching flashcards found - clearing invalid layout');
                    localStorage.removeItem('spartan_flashcard_layout');
                    return;
                }

                // Reorder flashcards according to saved layout
                layout.forEach(id => {
                    if (cardMap[id]) {
                        container.appendChild(cardMap[id]);
                    }
                });

                console.log(`‚úÖ Layout loaded: ${validCount}/${layout.length} flashcards positioned`);

                // Don't show toast on page load - only show when user manually closes edit mode
            } catch (error) {
                console.error('‚ùå Error loading layout:', error);
                // Clear corrupted data
                localStorage.removeItem('spartan_flashcard_layout');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new FlashcardNetwork();
            updateBreakthroughStats();
            updateDealHuntersStats();
            updateBoomBustStats();
            updateInflationStats();
            updateSymbolDatabaseStatus(); // Check symbol database on load

            // Load saved layout after a brief delay to ensure DOM is fully rendered
            // This prevents race conditions where flashcards aren't fully initialized
            setTimeout(() => {
                loadLayout();
                console.log('üéØ Window state manager initialized');
            }, 50);

            // Update stats every 10 seconds
            setInterval(updateBreakthroughStats, 10000);
            setInterval(updateDealHuntersStats, 10000);
            setInterval(updateBoomBustStats, 10000);
            setInterval(updateInflationStats, 10000);
            setInterval(updateSymbolDatabaseStatus, 30000); // Check database every 30 seconds
        });

        // ===== PATTERN DISCOVERY SYSTEM =====

        // Pattern Discovery - Refresh Pattern Function
        window.refreshPattern = async function(category) {
            // Map category to terminal ID and badge ID
            const categoryMap = {
                'stocks': 'stocks',
                'penny_stocks': 'pennystocks',
                'crypto': 'crypto',
                'forex': 'forex',
                'futures': 'futures',
                'cfds': 'cfds',
                'special_alert': 'special',
                'unique_daily': 'unique',
                'rare_gem': 'raregem',
                'billion_dollar': 'billion',
                'high_growth': 'highgrowth'
            };

            const terminalPrefix = categoryMap[category] || category;
            const terminalId = `${terminalPrefix}-pattern-terminal`;
            const badgeId = `${terminalPrefix}-pattern-badge`;

            const terminal = document.getElementById(terminalId);
            const badge = document.getElementById(badgeId);

            if (!terminal) {
                // Terminal is optional - skip silently if not present
                return;
            }

            // Show loading state
            terminal.textContent = 'Discovering patterns...';
            if (badge) badge.textContent = 'Loading...';

            try {
                // Fetch pattern from API
                const response = await fetch(`/api/patterns/discover?type=${category}&count=1`);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                if (data.patterns && data.patterns.length > 0) {
                    const pattern = data.patterns[0];

                    // Format pattern based on category
                    let formattedOutput;
                    if (category === 'special_alert') {
                        formattedOutput = formatSpecialAlert(pattern);
                    } else if (category === 'billion_dollar') {
                        formattedOutput = formatBillionDollarMove(pattern);
                    } else if (category === 'high_growth') {
                        formattedOutput = formatHighGrowthSector(pattern);
                    } else {
                        formattedOutput = formatStandardPattern(pattern);
                    }

                    terminal.innerHTML = formattedOutput;

                    // Update badge
                    if (badge) {
                        badge.textContent = 'Click to refresh';
                        badge.style.background = 'rgba(0, 255, 136, 0.2)';
                        badge.style.color = '#00ff88';
                    }

                    console.log(`‚úÖ Pattern loaded for ${category}`);
                } else {
                    terminal.textContent = 'No patterns available for this market.\n\nClick to try again.';
                    if (badge) badge.textContent = 'No patterns';
                }
            } catch (error) {
                console.error(`Pattern discovery error for ${category}:`, error);
                terminal.textContent = `Error loading pattern: ${error.message}\n\nClick to retry.`;
                terminal.style.color = '#FF5252';
                if (badge) {
                    badge.textContent = 'Error';
                    badge.style.background = 'rgba(255, 82, 82, 0.2)';
                    badge.style.color = '#FF5252';
                }
            }
        };

        // Format Standard Pattern (Stocks, Penny Stocks, Crypto, Forex, Futures, CFDs, Unique Daily, Rare Gems)
        function formatStandardPattern(pattern) {
            const sep = '='.repeat(80);
            const now = new Date().toLocaleString('en-AU', {timeZone: 'Australia/Melbourne'});

            // Color coding: LONG = Green, SHORT = Red
            const direction = (pattern.direction || 'LONG').toUpperCase();
            const isLong = direction === 'LONG' || direction === 'BUY';
            const directionColor = isLong ? '#00ff88' : '#FF5252';

            return `${sep}
>>> TRADE SETUP - ${now} MELBOURNE TIME
${sep}

MARKET:     ${pattern.market || 'N/A'}

SYMBOL:     ${pattern.symbol || 'N/A'}

<span style="color: ${directionColor};">DIRECTION:  ${direction}  <--- ${direction}</span>

STRATEGY:   ${pattern.strategy || 'Pattern Recognition'}

SESSION:    ${pattern.session || 'US SESSION'}
            ${'='.repeat((pattern.session || 'US SESSION').length)}
ENTRY TIME: ${pattern.entry_time || 'Market Open'}

SIMPLE EXPLANATION:
  ${pattern.simple_explanation || pattern.catalyst || 'Pattern-based trade setup.'}

DETAILED SETUP:
  ${pattern.detailed_setup || pattern.simple_explanation || 'Follow entry rules and risk management.'}

PROFIT POTENTIAL: ${pattern.profit_potential || 'MODERATE'}
WIN RATE: ${pattern.win_rate || 'N/A'} | PROFIT FACTOR: ${pattern.profit_factor || 'N/A'}
AVG PROFIT: ${pattern.avg_winner || 'N/A'} | AVG LOSS: ${pattern.avg_loser || 'N/A'}

Source: ${pattern.source || 'Pattern Discovery System'}
Pattern ID: ${pattern.pattern_id || 'N/A'}
${sep}

>>> Click again for next UNIQUE pattern
`;
        }

        // Format SPECIAL ALERT (GAP/PLUMMET)
        function formatSpecialAlert(pattern) {
            const sep = '#'.repeat(80);

            return `${sep}
###                                                                          ###
###                      *** SPECIAL ALERT ***                               ###
###              EXTREME PRICE MOVEMENT EXPECTED                             ###
###                                                                          ###
${sep}

MARKET:     ${pattern.market || 'N/A'}
SYMBOL:     ${pattern.symbol || 'N/A'}
MOVEMENT:   ${pattern.movement || 'GAP UP'}  <--- ${(pattern.movement || 'GAP UP').toUpperCase()}
ENTRY TIME: ${pattern.entry_time || 'Pre-market'}

WHY IT WILL MOVE:
  ${pattern.catalyst || 'Extreme catalyst expected.'}

EXPECTED MOVE: ${pattern.expected_move || 'Significant'}
WIN RATE: ${pattern.win_rate || 'N/A'} | PROFIT FACTOR: ${pattern.profit_factor || 'N/A'}
AVG PROFIT: ${pattern.avg_winner || 'N/A'}

Source: ${pattern.source || 'Special Alert System'}
${sep}

>>> EXTREME MOVEMENT - Click for next ALERT
`;
        }

        // Format BILLION DOLLAR MOVE
        function formatBillionDollarMove(pattern) {
            const sep = '#'.repeat(80);

            return `${sep}
###                   BILLION DOLLAR MOVE DETECTED                          ###
${sep}

SYMBOL:          ${pattern.symbol || 'N/A'}
MARKET CAP:      ${pattern.market_cap || 'N/A'}
CHANGE:          $${pattern.change_billions || 'N/A'} BILLION
CHANGE %:        ${pattern.change_percent || 'N/A'}%
TRIGGER:         ${pattern.trigger || 'Market catalyst'}
TIMESTAMP:       ${pattern.timestamp || new Date().toLocaleString('en-AU')}
SEVERITY:        ${pattern.severity || 'EXTREME'}

OPPORTUNITY:     ${pattern.opportunity || 'Massive market cap change detected.'}

Source: Billion Dollar Move Detector
${sep}

>>> Click for next BILLION DOLLAR MOVE
`;
        }

        // Format HIGH-GROWTH SECTOR
        function formatHighGrowthSector(pattern) {
            const sep = '='.repeat(80);
            const now = new Date().toLocaleString('en-AU', {timeZone: 'Australia/Melbourne'});

            return `${sep}
>>> HIGH-GROWTH OPPORTUNITY - ${now}
${sep}

SECTOR:     ${pattern.sector || 'High-Growth'}
SYMBOL:     ${pattern.symbol || 'N/A'}
DIRECTION:  ${pattern.direction || 'LONG'}  <--- ${(pattern.direction || 'LONG').toUpperCase()}
SESSION:    ${pattern.session || 'US SESSION'}
            ${'='.repeat((pattern.session || 'US SESSION').length)}
ENTRY TIME: ${pattern.entry_time || 'Market Open'}

GROWTH CATALYST:
  ${pattern.catalyst || pattern.simple_explanation || 'High-growth sector opportunity.'}

PROFIT POTENTIAL: ${pattern.profit_potential || 'EXTREME - 200-500% potential over 12 months'}
WIN RATE: ${pattern.win_rate || 'N/A'} | PROFIT FACTOR: ${pattern.profit_factor || 'N/A'}
AVG PROFIT: ${pattern.avg_winner || 'N/A'} | AVG LOSS: ${pattern.avg_loser || 'N/A'}

Source: ${pattern.source || 'High-Growth Sectors Research'}
${sep}

>>> Click for next HIGH-GROWTH SECTOR opportunity
`;
        }

        // Auto-load patterns on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Load one pattern for each category on page load
            const categories = [
                'stocks', 'penny_stocks', 'crypto', 'forex', 'futures', 'cfds',
                'special_alert', 'unique_daily', 'rare_gem', 'billion_dollar', 'high_growth'
            ];

            // Load patterns with staggered timing to avoid overwhelming the server
            categories.forEach((category, index) => {
                setTimeout(() => {
                    window.refreshPattern(category);
                }, index * 200); // 200ms delay between each
            });

            console.log('‚úÖ Pattern Discovery System initialized - 11 categories loaded');
        });

        // Cache busting
        console.log('Spartan Flashcard Network - Cache-Busting Active - ' + new Date().toISOString());
    </script>

    <!-- Global Keyboard Controls -->
    <script src="/js/global_keyboard_controls.js"></script>

    <!-- Spartan Ticker System -->
    <script src="/js/spartan_ticker.js"></script>
    <script>
        // Initialize ticker with ordered symbols: Indices ‚Üí Futures ‚Üí Stocks ‚Üí Forex ‚Üí Crypto ‚Üí CFDs
        document.addEventListener('DOMContentLoaded', () => {
            const ticker = new SpartanTicker('spartan-ticker', {
                scrollSpeed: 50,
                updateInterval: 60000,
                pauseOnHover: true
            });
        });
    </script>

    <!-- Initialize Market Regime Component -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize market regime indicator (pinned at top) - only if component exists
            if (typeof MarketRegimeComponent !== 'undefined') {
                const regime = new MarketRegimeComponent('market-regime-indicator', {
                    pinned: true,
                    showMetrics: true,
                    showConfidence: true
                });

                // Auto-refresh every 5 minutes
                setInterval(() => regime.refresh(), 300000);
            } else {
                console.warn('MarketRegimeComponent not loaded - skipping initialization');
            }
        });
    </script>

    <!-- Flashcard Manager - Drag & Drop, Editable, Pinned Sections -->
    <script src="/js/flashcard_manager.js"></script>

    <!-- Emerging Sectors Scanner - 95% Overbought/Oversold Detection -->
    <script src="/js/emerging_sectors.js"></script>

<!-- SPARTAN KEYBOARD NAVIGATION -->
<script src="/js/spartan_dropdown_keyboard_nav.js"></script>
<!-- Market Validation Module -->
<script src="/js/market_validation.js"></script>
<script src="/js/spartan_keyboard_navigation.js"></script>
    <!-- Intermarket Barometer Ticker -->
    <script src="/js/intermarket_ticker.js"></script>

    <!-- Composite Indicator UP/DOWN Arrows -->
    <script>
        // Update COT Hunter Pro Summary (Visually Enhanced)
        async function updateWhaleHunterSummary() {
            try {
                const statusEl = document.getElementById('whale-status');
                
                const response = await fetch('http://localhost:8888/api/whale-hunter/summary');
                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.status === 'waiting') {
                        statusEl.textContent = 'INITIALIZING...';
                        statusEl.style.color = '#FFD700';
                        return;
                    }

                    document.getElementById('whale-total').textContent = data.total_markets || 0;
                    document.getElementById('whale-bullish').textContent = data.bullish_count || 0;
                    document.getElementById('whale-bearish').textContent = data.bearish_count || 0;
                    
                    // Update Timestamp if available
                    if (data.timestamp) {
                        const date = new Date(data.timestamp);
                        const timeStr = date.toLocaleTimeString();
                        const timeEl = document.getElementById('whale-timestamp');
                        if(timeEl) timeEl.textContent = timeStr;
                    }

                    const signalsContainer = document.getElementById('whale-top-signals');
                    signalsContainer.innerHTML = ''; // Clear

                    if (data.top_signals && data.top_signals.length > 0) {
                        data.top_signals.forEach((signal, index) => {
                            const signalDiv = document.createElement('div');
                            signalDiv.style.borderBottom = '1px solid #222';
                            signalDiv.style.padding = '12px 15px';
                            signalDiv.style.display = 'flex';
                            signalDiv.style.flexDirection = 'column';
                            signalDiv.style.gap = '5px';
                            signalDiv.style.background = index % 2 === 0 ? 'rgba(255,255,255,0.02)' : 'transparent';
                            
                            const isBullish = signal.Sentiment === 'Bullish';
                            const badgeColor = isBullish ? '#00FF00' : '#FF4B4B';
                            const badgeBg = isBullish ? 'rgba(0, 255, 0, 0.1)' : 'rgba(255, 75, 75, 0.1)';
                            const arrow = isBullish ? '‚ñ≤' : '‚ñº';
                            
                            signalDiv.innerHTML = `
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="color: #FFF; font-weight: bold; font-family: 'Inter', sans-serif;">${signal.Market}</span>
                                    <span style="
                                        color: ${badgeColor}; 
                                        background: ${badgeBg}; 
                                        padding: 2px 8px; 
                                        border-radius: 4px; 
                                        font-size: 0.8em; 
                                        border: 1px solid ${badgeColor};
                                        font-weight: bold;">
                                        ${arrow} ${signal.Sentiment.toUpperCase()}
                                    </span>
                                </div>
                                <div style="color: #888; font-size: 0.85em;">> ${signal.Analysis}</div>
                            `;
                            signalsContainer.appendChild(signalDiv);
                        });
                    } else {
                        signalsContainer.innerHTML = '<div style="color: #666; padding: 20px; text-align: center; font-style: italic;">No high-conviction signals detected in this scan.</div>';
                    }

                    statusEl.textContent = 'SYSTEM ACTIVE';
                    statusEl.style.color = '#00FF00';
                } else {
                    throw new Error('API Error');
                }
            } catch (error) {
                console.error('Error updating COT Hunter:', error);
                const statusEl = document.getElementById('whale-status');
                if(statusEl) {
                    if (window.location.protocol === 'file:') {
                        statusEl.textContent = 'ERROR: OPEN VIA SERVER';
                        statusEl.title = 'You are opening this file directly. Please use a local web server (e.g., python -m http.server)';
                    } else {
                        statusEl.textContent = 'CONNECTION LOST';
                    }
                    statusEl.style.color = '#FF4B4B';
                }
            }
        }

        // Update Composite Indicators (New Dashboard)
        async function updateCompositeIndicators() {
            try {
                // Fetch real-time price data using yfinance via a simple backend
                const symbols = {
                    'audjpy': 'AUDJPY=X',
                    'usdkrw': 'USDKRW=X',
                    'hyg': 'HYG',
                    'yield': '^TNX'  // 10-Year Treasury Yield
                };

                const percentChanges = {};
                let currentAudJpy = 0;
                let currentUsdKrw = 0;

                for (const [key, symbol] of Object.entries(symbols)) {
                    try {
                        // Use heartbeat wrapper to report to Agent Data Engine
                        const response = await fetchWithHeartbeat(`/api/yahoo/chart/${symbol}?interval=1d&range=5d`);
                        const data = response.data;

                        if (data.chart && data.chart.result && data.chart.result[0]) {
                            const result = data.chart.result[0];
                            const quotes = result.indicators.quote[0];
                            const closes = quotes.close.filter(c => c !== null);

                            if (closes.length >= 2) {
                                const currentPrice = closes[closes.length - 1];
                                const previousPrice = closes[closes.length - 2];
                                const change = currentPrice - previousPrice;
                                const percentChange = (change / previousPrice) * 100;

                                if (key === 'audjpy') {
                                    currentAudJpy = currentPrice;
                                    window.audjpyData = { prices: closes, timestamps: result.timestamp };
                                }
                                if (key === 'usdkrw') {
                                    currentUsdKrw = currentPrice;
                                    window.usdkrwData = { prices: closes, timestamps: result.timestamp };
                                }

                                // Store percent change for composite calculation
                                percentChanges[key] = percentChange;

                                // Update value display (if elements exist for krw in future, currently they don't have dedicated IDs outside section)
                                const valueElement = document.getElementById(`${key}-value`);
                                if (valueElement) {
                                    valueElement.textContent = currentPrice.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
                                }

                                // Update arrow based on direction
                                const arrowElement = document.getElementById(`${key}-arrow`);
                                if (arrowElement) {
                                    if (change > 0) {
                                        arrowElement.innerHTML = '‚ñ≤';
                                        arrowElement.style.color = '#00ff88';  // Green
                                        arrowElement.title = `UP ${change.toFixed(4)} (${percentChange.toFixed(2)}%)`;
                                    } else if (change < 0) {
                                        arrowElement.innerHTML = '‚ñº';
                                        arrowElement.style.color = '#FF5252';  // Red
                                        arrowElement.title = `DOWN ${Math.abs(change).toFixed(4)} (${percentChange.toFixed(2)}%)`;
                                    } else {
                                        arrowElement.innerHTML = '‚Üî';
                                        arrowElement.style.color = '#FFD700';  // Gold
                                        arrowElement.title = 'Unchanged (Sideways)';
                                    }
                                }
                            }
                        }
                    } catch (error) {
                        console.error(`Error fetching ${symbol}:`, error);
                        const arrowElement = document.getElementById(`${key}-arrow`);
                        if (arrowElement) {
                            arrowElement.innerHTML = '‚Üî';
                            arrowElement.style.color = '#b0b8c8';
                            arrowElement.title = 'Data unavailable';
                        }
                        percentChanges[key] = 0;
                    }
                }

                // Update AI Swing Trader Advice based on AUD/JPY price
                const adviceEl = document.getElementById('ai-dynamic-message');
                if (adviceEl && currentAudJpy > 0) {
                    if (currentAudJpy > 105.50) {
                        adviceEl.innerHTML = `<span style="color: #FF4B4B;">‚ö†Ô∏è CRITICAL RESISTANCE:</span> Price is in the Kill Zone (${currentAudJpy.toFixed(2)}). EXECUTE SELL LIMITS. Tight stops above 106.10.`;
                    } else if (currentAudJpy > 104.50) {
                        adviceEl.innerHTML = `<span style="color: #FFD700;">üîî ALERT:</span> Price approaching resistance (${currentAudJpy.toFixed(2)}). Prepare short entries. Watch for H1 candle rejection.`;
                    } else if (currentAudJpy < 102.50) {
                        adviceEl.innerHTML = `<span style="color: #00ff88;">üí∞ TAKE PROFIT:</span> Price near 50-day MA support (${currentAudJpy.toFixed(2)}). Cover shorts or wait for bounce to reload.`;
                    } else {
                        adviceEl.innerHTML = `<span style="color: #b0b8c8;">‚è≥ WAIT:</span> Price in neutral range (${currentAudJpy.toFixed(2)}). Patience. Let price come to 105.00 resistance before acting.`;
                    }
                }

                // Update KRW AI Advice
                const krwAdviceEl = document.getElementById('krw-ai-dynamic-message');
                if (krwAdviceEl && currentUsdKrw > 0) {
                    if (currentUsdKrw > 1455) {
                        krwAdviceEl.innerHTML = `<span style="color: #00ff88;">üèπ OPPORTUNITY:</span> USD/KRW near structural peak (${currentUsdKrw.toFixed(0)}). WGBI flows starting April provide massive headwind for USD. Start scaling into tactical KRW shorts (Sell USD).`;
                    } else if (currentUsdKrw < 1380) {
                        krwAdviceEl.innerHTML = `<span style="color: #FF4B4B;">üõë DANGER:</span> Price near support zone (${currentUsdKrw.toFixed(0)}). Tactical appreciation may be exhausted. Do not short here; wait for 1,450+ bounce.`;
                    } else {
                        krwAdviceEl.innerHTML = `<span style="color: #58A6FF;">üì° MONITOR:</span> USD/KRW in digestion phase (${currentUsdKrw.toFixed(0)}). Watching for US Tech/SOX breakout to confirm next leg of KRW strength.`;
                    }
                } else if (krwAdviceEl) {
                    krwAdviceEl.innerHTML = `Monitoring trade data releases...`;
                }

                // Render Mini Charts
                // AUD/JPY Chart
                if (window.audjpyData) {
                    renderMiniChart('audjpyChart', window.audjpyData.prices, window.audjpyData.timestamps, '#FF4B4B');
                }
                
                // USD/KRW Chart
                if (window.usdkrwData) {
                    renderMiniChart('usdkrwChart', window.usdkrwData.prices, window.usdkrwData.timestamps, '#00ff88');
                }

                // Render Mini Charts
                // AUD/JPY Chart
                if (window.audjpyData) {
                    renderMiniChart('audjpyChart', window.audjpyData.prices, window.audjpyData.timestamps, '#FF4B4B');
                }
                
                // USD/KRW Chart
                if (window.usdkrwData) {
                    renderMiniChart('usdkrwChart', window.usdkrwData.prices, window.usdkrwData.timestamps, '#00ff88');
                }

                // Calculate Composite Risk Score (0-100)
                // Base = 50 (neutral)
                // Each indicator contributes based on % change (amplified for visibility)
                const baseScore = 50;
                const audjpyScore = (percentChanges.audjpy || 0) * 10;
                const hygScore = (percentChanges.hyg || 0) * 15;
                const yieldScore = (percentChanges.yield || 0) * 8;

                let compositeScore = baseScore + audjpyScore + hygScore + yieldScore;

                // Clamp to 0-100
                compositeScore = Math.max(0, Math.min(100, compositeScore));

                // Update score display
                const scoreElement = document.getElementById('composite-score');
                const labelElement = document.getElementById('composite-label');
                const barElement = document.getElementById('composite-bar');

                if (scoreElement) scoreElement.textContent = Math.round(compositeScore);
                if (barElement) barElement.style.width = compositeScore + '%';

                if (labelElement && scoreElement) {
                    if (compositeScore >= 70) {
                        labelElement.textContent = 'EXTREME RISK-ON üî•';
                        labelElement.style.color = '#00ff88';
                        scoreElement.style.color = '#00ff88';
                    } else if (compositeScore >= 55) {
                        labelElement.textContent = 'RISK-ON ‚¨ÜÔ∏è';
                        labelElement.style.color = '#66ff99';
                        scoreElement.style.color = '#66ff99';
                    } else if (compositeScore >= 45) {
                        labelElement.textContent = 'NEUTRAL ‚öñÔ∏è';
                        labelElement.style.color = '#FFD700';
                        scoreElement.style.color = '#FFD700';
                    } else if (compositeScore >= 30) {
                        labelElement.textContent = 'RISK-OFF ‚¨áÔ∏è';
                        labelElement.style.color = '#ff9966';
                        scoreElement.style.color = '#ff9966';
                    } else {
                        labelElement.textContent = 'EXTREME RISK-OFF üßä';
                        labelElement.style.color = '#FF5252';
                        scoreElement.style.color = '#FF5252';
                    }
                }

            } catch (error) {
                console.error('Error updating composite indicators:', error);
            }
        }

        // Helper: Render Mini Chart using Chart.js
        let miniCharts = {}; // Store chart instances to destroy/update

        function renderMiniChart(canvasId, prices, timestamps, color) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) {
                // If canvas not found, it might be in a hidden tab or not yet rendered.
                // We'll try to find it, but if not, we can't render.
                return;
            }
            
            const ctx = canvas.getContext('2d');

            // Destroy existing chart if it exists
            if (miniCharts[canvasId]) {
                miniCharts[canvasId].destroy();
            }

            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 120);
            gradient.addColorStop(0, color);
            gradient.addColorStop(1, 'rgba(0,0,0,0)'); // Transparent at bottom

            miniCharts[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: timestamps.map(t => new Date(t * 1000).toLocaleDateString()), // Simple date
                    datasets: [{
                        data: prices,
                        borderColor: color,
                        borderWidth: 2,
                        backgroundColor: gradient,
                        fill: true,
                        pointRadius: 0, // Hide points for clean look
                        pointHoverRadius: 4,
                        tension: 0.2 // Smooth curve
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: color,
                            borderWidth: 1,
                            callbacks: {
                                label: function(tooltipItem) {
                                    return tooltipItem.parsed.y.toFixed(2);
                                }
                            }
                        }
                    },
                    scales: {
                        x: { display: false }, // Hide X axis
                        y: {
                            display: false, // Hide Y axis
                            // Dynamic scaling
                            min: Math.min(...prices) * 0.999,
                            max: Math.max(...prices) * 1.001
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    },
                    animation: {
                        duration: 0 // Disable animation for performance/instant update
                    }
                }
            });
        }



        // Crypto Best Composite Indicator Update Function
        async function updateCryptoCompositeIndicators() {
            try {
                // Crypto symbols for different APIs
                const cryptoConfig = {
                    'btc': { yahoo: 'BTC-USD', coingecko: 'bitcoin' },
                    'eth': { yahoo: 'ETH-USD', coingecko: 'ethereum' },
                    'sol': { yahoo: 'SOL-USD', coingecko: 'solana' }
                };

                const percentChanges = {};

                // Helper: Fetch with timeout
                async function fetchWithTimeout(url, timeout = 5000) {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), timeout);
                    try {
                        const response = await fetch(url, { signal: controller.signal });
                        clearTimeout(timeoutId);
                        return response;
                    } catch (error) {
                        clearTimeout(timeoutId);
                        throw error;
                    }
                }

                // Helper: Try CoinGecko API as fallback
                async function fetchFromCoinGecko(coinId) {
                    const response = await fetchWithTimeout(
                        `https://api.coingecko.com/api/v3/coins/${coinId}/market_chart?vs_currency=usd&days=5&interval=daily`,
                        8000
                    );
                    const data = await response.json();
                    if (data.prices && data.prices.length >= 2) {
                        const prices = data.prices;
                        const currentPrice = prices[prices.length - 1][1];
                        const fiveDaysAgoPrice = prices[0][1];
                        return {
                            current: currentPrice,
                            fiveDaysAgo: fiveDaysAgoPrice,
                            change: currentPrice - fiveDaysAgoPrice,
                            percentChange: ((currentPrice - fiveDaysAgoPrice) / fiveDaysAgoPrice) * 100
                        };
                    }
                    return null;
                }

                for (const [key, config] of Object.entries(cryptoConfig)) {
                    const arrowElement = document.getElementById(`crypto-${key}-arrow`);

                    try {
                        let priceData = null;

                        // Try local Yahoo API first (faster if server is running)
                        try {
                            const response = await fetchWithTimeout(
                                `http://localhost:8888/api/yahoo/chart/${config.yahoo}?interval=1d&range=5d`,
                                5000
                            );
                            const data = await response.json();

                            if (data.chart && data.chart.result && data.chart.result[0]) {
                                const result = data.chart.result[0];
                                const quotes = result.indicators.quote[0];
                                const closes = quotes.close.filter(c => c !== null);

                                if (closes.length >= 2) {
                                    const currentPrice = closes[closes.length - 1];
                                    const fiveDaysAgoPrice = closes[0];
                                    priceData = {
                                        current: currentPrice,
                                        fiveDaysAgo: fiveDaysAgoPrice,
                                        change: currentPrice - fiveDaysAgoPrice,
                                        percentChange: ((currentPrice - fiveDaysAgoPrice) / fiveDaysAgoPrice) * 100
                                    };
                                }
                            }
                        } catch (yahooError) {
                            console.warn(`Yahoo API failed for ${key}, trying CoinGecko...`);
                        }

                        // Fallback to CoinGecko if Yahoo fails
                        if (!priceData) {
                            priceData = await fetchFromCoinGecko(config.coingecko);
                        }

                        // Update UI with price data
                        if (priceData) {
                            percentChanges[key] = priceData.percentChange;

                            // Update price display
                            const priceElement = document.getElementById(`crypto-${key}-price`);
                            const changeElement = document.getElementById(`crypto-${key}-change`);

                            if (priceElement) {
                                // Format price based on value (BTC needs no decimals, others need 2)
                                const formattedPrice = priceData.current >= 1000
                                    ? '$' + priceData.current.toLocaleString('en-US', { maximumFractionDigits: 0 })
                                    : '$' + priceData.current.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                                priceElement.textContent = formattedPrice;
                            }

                            if (changeElement) {
                                const changeSign = priceData.percentChange >= 0 ? '+' : '';
                                changeElement.textContent = `${changeSign}${priceData.percentChange.toFixed(2)}% (5d)`;
                                changeElement.style.color = priceData.percentChange >= 0 ? '#00ff88' : '#FF5252';
                            }

                            if (arrowElement) {
                                if (priceData.change > 0) {
                                    arrowElement.innerHTML = '‚ñ≤';
                                    arrowElement.style.color = '#00ff88';
                                    arrowElement.title = `UP $${priceData.change.toFixed(2)} (${priceData.percentChange.toFixed(2)}% over 5 days)`;
                                } else if (priceData.change < 0) {
                                    arrowElement.innerHTML = '‚ñº';
                                    arrowElement.style.color = '#FF5252';
                                    arrowElement.title = `DOWN $${Math.abs(priceData.change).toFixed(2)} (${priceData.percentChange.toFixed(2)}% over 5 days)`;
                                } else {
                                    arrowElement.innerHTML = '‚Üî';
                                    arrowElement.style.color = '#FFD700';
                                    arrowElement.title = 'Unchanged (Sideways)';
                                }
                            }
                        } else {
                            throw new Error('No data from any source');
                        }

                    } catch (error) {
                        console.error(`Error fetching crypto ${key}:`, error);
                        // Update error states for all elements
                        const priceElement = document.getElementById(`crypto-${key}-price`);
                        const changeElement = document.getElementById(`crypto-${key}-change`);

                        if (arrowElement) {
                            arrowElement.innerHTML = '‚Üî';
                            arrowElement.style.color = '#b0b8c8';
                            arrowElement.title = 'Data unavailable - check connection';
                        }
                        if (priceElement) {
                            priceElement.textContent = 'N/A';
                            priceElement.style.opacity = '0.5';
                        }
                        if (changeElement) {
                            changeElement.textContent = 'No data';
                            changeElement.style.color = '#b0b8c8';
                        }
                        percentChanges[key] = 0;
                    }
                }

                // Calculate Crypto Composite Risk Score (0-100) based on 5-day performance
                // Base = 50 (neutral)
                // BTC has highest weight (market leader)
                // ETH has medium weight (platform health)
                // SOL has lower weight (high-beta altcoin)
                // Using 5-day changes, so scaling is more conservative
                const baseScore = 50;
                const btcScore = (percentChanges.btc || 0) * 3;   // 1% 5-day change = 3 points
                const ethScore = (percentChanges.eth || 0) * 2.5; // 1% 5-day change = 2.5 points
                const solScore = (percentChanges.sol || 0) * 2;   // 1% 5-day change = 2 points

                let compositeScore = baseScore + btcScore + ethScore + solScore;

                // Log for validation
                console.log(`üìä Crypto Composite Calculation:
                    BTC 5-day: ${(percentChanges.btc || 0).toFixed(2)}% ‚Üí ${btcScore.toFixed(1)} points
                    ETH 5-day: ${(percentChanges.eth || 0).toFixed(2)}% ‚Üí ${ethScore.toFixed(1)} points
                    SOL 5-day: ${(percentChanges.sol || 0).toFixed(2)}% ‚Üí ${solScore.toFixed(1)} points
                    Base: ${baseScore} ‚Üí Total: ${compositeScore.toFixed(1)}`);

                // Clamp to 0-100
                compositeScore = Math.max(0, Math.min(100, compositeScore));

                // Update score display
                const scoreElement = document.getElementById('crypto-composite-score');
                const labelElement = document.getElementById('crypto-composite-label');
                const barElement = document.getElementById('crypto-composite-bar');

                if (scoreElement) {
                    scoreElement.textContent = Math.round(compositeScore);
                }

                if (barElement) {
                    barElement.style.width = compositeScore + '%';
                }

                // Update label and color based on score (crypto has higher volatility thresholds)
                if (labelElement && scoreElement) {
                    if (compositeScore >= 75) {
                        labelElement.textContent = 'BULL MARKET üöÄ';
                        labelElement.style.color = '#00ff88';
                        scoreElement.style.color = '#00ff88';
                    } else if (compositeScore >= 60) {
                        labelElement.textContent = 'RISK-ON ‚¨ÜÔ∏è';
                        labelElement.style.color = '#66ff99';
                        scoreElement.style.color = '#66ff99';
                    } else if (compositeScore >= 40) {
                        labelElement.textContent = 'NEUTRAL ‚öñÔ∏è';
                        labelElement.style.color = '#FFD700';
                        scoreElement.style.color = '#FFD700';
                    } else if (compositeScore >= 25) {
                        labelElement.textContent = 'RISK-OFF ‚¨áÔ∏è';
                        labelElement.style.color = '#ff9966';
                        scoreElement.style.color = '#ff9966';
                    } else {
                        labelElement.textContent = 'BEAR MARKET üßä';
                        labelElement.style.color = '#FF5252';
                        scoreElement.style.color = '#FF5252';
                    }
                }

            } catch (error) {
                console.error('Error updating crypto composite indicators:', error);
            }
        }

        // Probabilistic Recession Model - Fetch and Display
        async function updateRecessionIndicator() {
            try {
                const response = await fetch('http://localhost:8888/api/recession-probability');
                const data = await response.json();

                if (data.error) {
                    console.error('Recession API error:', data.error);
                    return;
                }

                // Update spread value
                const spreadElement = document.getElementById('recession-spread');
                if (spreadElement) {
                    spreadElement.textContent = data.spread.toFixed(2) + '%';
                }

                // Update probability value
                const probabilityElement = document.getElementById('recession-probability');
                if (probabilityElement) {
                    probabilityElement.textContent = data.probability.toFixed(1) + '%';
                }

                // Update risk level
                const riskLevelElement = document.getElementById('recession-risk-level');
                if (riskLevelElement) {
                    riskLevelElement.textContent = data.risk_level;

                    // Color coding based on risk level
                    if (data.risk_level === 'LOW') {
                        riskLevelElement.style.color = '#00ff88';
                    } else if (data.risk_level === 'MODERATE') {
                        riskLevelElement.style.color = '#FFD700';
                    } else if (data.risk_level === 'ELEVATED') {
                        riskLevelElement.style.color = '#FFA500';
                    } else if (data.risk_level === 'HIGH') {
                        riskLevelElement.style.color = '#FF5252';
                    } else if (data.risk_level === 'CRITICAL') {
                        riskLevelElement.style.color = '#8B0000';
                    }
                }

                // Update risk emoji
                const riskEmojiElement = document.getElementById('recession-risk-emoji');
                if (riskEmojiElement) {
                    riskEmojiElement.textContent = data.risk_emoji;
                }

                // Update risk description
                const riskDescElement = document.getElementById('recession-risk-desc');
                if (riskDescElement) {
                    if (data.risk_level === 'LOW') {
                        riskDescElement.textContent = 'Low recession risk. Economic indicators are stable.';
                    } else if (data.risk_level === 'MODERATE') {
                        riskDescElement.textContent = 'Moderate recession risk. Monitor economic trends.';
                    } else if (data.risk_level === 'ELEVATED') {
                        riskDescElement.textContent = 'Elevated recession risk. Exercise caution with investments.';
                    } else if (data.risk_level === 'HIGH') {
                        riskDescElement.textContent = 'High recession risk. Defensive positioning recommended.';
                    } else if (data.risk_level === 'CRITICAL') {
                        riskDescElement.textContent = 'Critical recession risk. Recession likely imminent.';
                    }
                }

                // Update probability bar position (0% = left, 100% = right)
                const barElement = document.getElementById('recession-bar');
                if (barElement) {
                    barElement.style.left = data.probability + '%';
                }

                console.log(`‚úÖ Recession Model Updated: ${data.spread}% spread ‚Üí ${data.probability}% probability (${data.risk_level})`);

            } catch (error) {
                console.error('Error updating recession indicator:', error);
                // Set fallback UI
                const spreadElement = document.getElementById('recession-spread');
                const probabilityElement = document.getElementById('recession-probability');
                const riskLevelElement = document.getElementById('recession-risk-level');
                const riskEmojiElement = document.getElementById('recession-risk-emoji');

                if (spreadElement) spreadElement.textContent = '--';
                if (probabilityElement) probabilityElement.textContent = '--';
                if (riskLevelElement) {
                    riskLevelElement.textContent = 'DATA ERROR';
                    riskLevelElement.style.color = '#b0b8c8';
                }
                if (riskEmojiElement) riskEmojiElement.textContent = '‚ö†Ô∏è';
            }
        }

        // Stealth Macro Indicator Update Function
        async function updateStealthMacroIndicator() {
            try {
                console.log('üéØ Updating Stealth Macro Indicator...');

                // Fetch market data for all 6 macro drivers
                const symbols = {
                    'UUP': 'Dollar (DXY)',      // US Dollar ETF
                    '^TNX': '10Y Yield',        // 10-Year Treasury Yield
                    'GLD': 'Gold',              // Gold ETF
                    'USO': 'Oil',               // Oil ETF
                    'SPY': 'S&P 500',           // Equity Risk
                    '^VIX': 'VIX'               // Fear Gauge
                };

                const dataPromises = Object.keys(symbols).map(async (symbol) => {
                    try {
                        const response = await fetch(`/api/market/quote/${symbol}`);
                        if (!response.ok) throw new Error(`Failed to fetch ${symbol}`);
                        const data = await response.json();

                        // Calculate 5-day change
                        const fiveDayChange = data.changePercent5d || 0;

                        return {
                            symbol,
                            name: symbols[symbol],
                            price: data.price || 0,
                            change: data.change || 0,
                            changePercent: data.changePercent || 0,
                            fiveDayChange: fiveDayChange
                        };
                    } catch (error) {
                        console.warn(`‚ö†Ô∏è Failed to fetch ${symbol}:`, error);
                        return { symbol, name: symbols[symbol], price: null, change: 0, changePercent: 0, fiveDayChange: 0 };
                    }
                });

                const marketData = await Promise.all(dataPromises);

                // Process each driver
                marketData.forEach(asset => {
                    let elementPrefix = '';

                    // Map symbols to element IDs
                    if (asset.symbol === 'UUP') elementPrefix = 'stealth-dxy';
                    else if (asset.symbol === '^TNX') elementPrefix = 'stealth-yield';
                    else if (asset.symbol === 'GLD') elementPrefix = 'stealth-gold';
                    else if (asset.symbol === 'USO') elementPrefix = 'stealth-oil';
                    else if (asset.symbol === 'SPY') elementPrefix = 'stealth-spy';
                    else if (asset.symbol === '^VIX') elementPrefix = 'stealth-vix';

                    if (!elementPrefix) return;

                    // Update price/value
                    const valueElement = document.getElementById(`${elementPrefix}-value`);
                    if (valueElement && asset.price !== null) {
                        if (asset.symbol === '^TNX') {
                            valueElement.textContent = asset.price.toFixed(2) + '%';
                        } else if (asset.symbol === '^VIX') {
                            valueElement.textContent = asset.price.toFixed(2);
                        } else {
                            valueElement.textContent = '$' + asset.price.toFixed(2);
                        }
                    }

                    // Update arrow
                    const arrowElement = document.getElementById(`${elementPrefix}-arrow`);
                    if (arrowElement && asset.price !== null) {
                        if (asset.change > 0) {
                            arrowElement.textContent = '‚ñ≤';
                            arrowElement.style.color = '#00ff88';
                        } else if (asset.change < 0) {
                            arrowElement.textContent = '‚ñº';
                            arrowElement.style.color = '#DC143C';
                        } else {
                            arrowElement.textContent = '‚îÅ';
                            arrowElement.style.color = '#FFD700';
                        }
                    }

                    // Update 5-day change
                    const changeDayElement = document.getElementById(`${elementPrefix}-5d`);
                    if (changeDayElement && asset.price !== null) {
                        const changeColor = asset.fiveDayChange >= 0 ? '#00ff88' : '#DC143C';
                        const changeSymbol = asset.fiveDayChange >= 0 ? '+' : '';
                        changeDayElement.innerHTML = `<span style="color: ${changeColor}; font-weight: 700;">${changeSymbol}${asset.fiveDayChange.toFixed(2)}%</span>`;
                    }

                    // Update signal interpretation
                    const signalElement = document.getElementById(`${elementPrefix}-signal`);
                    if (signalElement && asset.price !== null) {
                        let signal = '';
                        let signalColor = '#FFD700';

                        if (asset.symbol === 'UUP') {
                            // Dollar: Rising = Risk-Off, Falling = Risk-On
                            if (asset.fiveDayChange > 1.5) {
                                signal = 'üî¥ Risk-Off Signal';
                                signalColor = '#DC143C';
                            } else if (asset.fiveDayChange < -1.5) {
                                signal = 'üü¢ Risk-On Signal';
                                signalColor = '#00ff88';
                            } else {
                                signal = 'üü° Neutral';
                                signalColor = '#FFD700';
                            }
                        } else if (asset.symbol === '^TNX') {
                            // Yields: Rising = Growth expectations
                            if (asset.fiveDayChange > 3) {
                                signal = 'üü¢ Growth Optimism';
                                signalColor = '#00ff88';
                            } else if (asset.fiveDayChange < -3) {
                                signal = 'üî¥ Growth Concerns';
                                signalColor = '#DC143C';
                            } else {
                                signal = 'üü° Stable';
                                signalColor = '#FFD700';
                            }
                        } else if (asset.symbol === 'GLD') {
                            // Gold: Rising = Fear/uncertainty
                            if (asset.fiveDayChange > 2) {
                                signal = 'üî¥ Fear Rising';
                                signalColor = '#DC143C';
                            } else if (asset.fiveDayChange < -2) {
                                signal = 'üü¢ Confidence Rising';
                                signalColor = '#00ff88';
                            } else {
                                signal = 'üü° Neutral';
                                signalColor = '#FFD700';
                            }
                        } else if (asset.symbol === 'USO') {
                            // Oil: Rising = Economic activity/inflation
                            if (asset.fiveDayChange > 3) {
                                signal = 'üü¢ Strong Demand';
                                signalColor = '#00ff88';
                            } else if (asset.fiveDayChange < -3) {
                                signal = 'üî¥ Weak Demand';
                                signalColor = '#DC143C';
                            } else {
                                signal = 'üü° Steady';
                                signalColor = '#FFD700';
                            }
                        } else if (asset.symbol === 'SPY') {
                            // SPY: Rising = Risk appetite
                            if (asset.fiveDayChange > 2) {
                                signal = 'üü¢ Strong Risk Appetite';
                                signalColor = '#00ff88';
                            } else if (asset.fiveDayChange < -2) {
                                signal = 'üî¥ Risk Aversion';
                                signalColor = '#DC143C';
                            } else {
                                signal = 'üü° Neutral';
                                signalColor = '#FFD700';
                            }
                        } else if (asset.symbol === '^VIX') {
                            // VIX: Rising = Fear, Falling = Complacency
                            if (asset.fiveDayChange > 15) {
                                signal = 'üî¥ Fear Spiking';
                                signalColor = '#DC143C';
                            } else if (asset.fiveDayChange < -15) {
                                signal = 'üü¢ Calm Markets';
                                signalColor = '#00ff88';
                            } else {
                                signal = 'üü° Normal';
                                signalColor = '#FFD700';
                            }
                        }

                        signalElement.textContent = signal;
                        signalElement.style.color = signalColor;
                    }
                });

                // Calculate overall macro regime
                const dxyData = marketData.find(d => d.symbol === 'UUP');
                const yieldData = marketData.find(d => d.symbol === '^TNX');
                const goldData = marketData.find(d => d.symbol === 'GLD');
                const oilData = marketData.find(d => d.symbol === 'USO');
                const spyData = marketData.find(d => d.symbol === 'SPY');
                const vixData = marketData.find(d => d.symbol === '^VIX');

                let regimeScore = 0;  // -100 (Risk-Off) to +100 (Risk-On)
                let validSignals = 0;

                // Dollar contribution (inverse: weak dollar = risk-on)
                if (dxyData && dxyData.price !== null) {
                    regimeScore -= dxyData.fiveDayChange * 5;
                    validSignals++;
                }

                // Yield contribution (rising = risk-on)
                if (yieldData && yieldData.price !== null) {
                    regimeScore += yieldData.fiveDayChange * 3;
                    validSignals++;
                }

                // Gold contribution (inverse: falling gold = risk-on)
                if (goldData && goldData.price !== null) {
                    regimeScore -= goldData.fiveDayChange * 4;
                    validSignals++;
                }

                // Oil contribution (rising = risk-on)
                if (oilData && oilData.price !== null) {
                    regimeScore += oilData.fiveDayChange * 3;
                    validSignals++;
                }

                // SPY contribution (rising = risk-on)
                if (spyData && spyData.price !== null) {
                    regimeScore += spyData.fiveDayChange * 6;
                    validSignals++;
                }

                // VIX contribution (inverse: falling VIX = risk-on)
                if (vixData && vixData.price !== null) {
                    regimeScore -= vixData.fiveDayChange * 2;
                    validSignals++;
                }

                // Determine regime
                const statusElement = document.getElementById('macroRegimeStatus');
                const descElement = document.getElementById('macroRegimeDescription');

                if (validSignals >= 4) {
                    if (regimeScore > 15) {
                        // Strong Risk-On
                        statusElement.textContent = 'üü¢ RISK-ON';
                        statusElement.style.color = '#00ff88';
                        descElement.textContent = 'Strong risk appetite detected across macro drivers. Favorable for equities, commodities, and emerging markets.';
                    } else if (regimeScore > 5) {
                        // Moderate Risk-On
                        statusElement.textContent = 'üü¢ MILD RISK-ON';
                        statusElement.style.color = '#00ff88';
                        descElement.textContent = 'Modest risk appetite. Markets trending positive but not euphoric.';
                    } else if (regimeScore < -15) {
                        // Strong Risk-Off
                        statusElement.textContent = 'üî¥ RISK-OFF';
                        statusElement.style.color = '#DC143C';
                        descElement.textContent = 'Strong risk aversion detected. Flight to safety underway. Favor bonds, gold, and defensive sectors.';
                    } else if (regimeScore < -5) {
                        // Moderate Risk-Off
                        statusElement.textContent = 'üî¥ MILD RISK-OFF';
                        statusElement.style.color = '#DC143C';
                        descElement.textContent = 'Modest risk aversion. Markets showing caution.';
                    } else {
                        // Transition/Mixed
                        statusElement.textContent = 'üü£ TRANSITION';
                        statusElement.style.color = '#bc13fe';
                        descElement.textContent = 'Mixed signals across macro drivers. Regime change potentially in progress. Monitor for confirmation.';
                    }

                    // Check for stagflation scenario
                    if (yieldData && oilData && goldData && spyData) {
                        if (yieldData.fiveDayChange > 2 && oilData.fiveDayChange > 2 && goldData.fiveDayChange > 1 && spyData.fiveDayChange < 0) {
                            statusElement.textContent = 'üü° STAGFLATION RISK';
                            statusElement.style.color = '#FFD700';
                            descElement.textContent = 'Warning: Rising yields + rising commodities + weak equities = potential stagflation scenario developing.';
                        }
                    }
                } else {
                    statusElement.textContent = '‚ö†Ô∏è INSUFFICIENT DATA';
                    statusElement.style.color = '#b0b8c8';
                    descElement.textContent = 'Not enough macro driver data available for regime detection.';
                }

                console.log(`‚úÖ Stealth Macro Updated | Regime Score: ${regimeScore.toFixed(1)} | Signals: ${validSignals}/6`);

            } catch (error) {
                console.error('‚ùå Error updating Stealth Macro indicator:', error);

                // Set error state
                const statusElement = document.getElementById('macroRegimeStatus');
                const descElement = document.getElementById('macroRegimeDescription');

                if (statusElement) {
                    statusElement.textContent = '‚ö†Ô∏è DATA ERROR';
                    statusElement.style.color = '#DC143C';
                }
                if (descElement) {
                    descElement.textContent = 'Unable to fetch macro driver data. Please refresh the page.';
                }
            }
        }

        // VIX Composite Indicator Update Function
        async function updateVixCompositeIndicator() {
            try {
                console.log('‚ö° Updating VIX Composite Indicator...');

                // Fetch VIX and crypto data
                const [vixData, btcData, ethData] = await Promise.all([
                    fetch('/api/market/quote/^VIX').then(r => r.json()).catch(() => null),
                    fetch('/api/market/quote/BTC-USD').then(r => r.json()).catch(() => null),
                    fetch('/api/market/quote/ETH-USD').then(r => r.json()).catch(() => null)
                ]);

                // Calculate VIX component (0-50)
                let vixScore = 0;
                if (vixData && vixData.price !== null) {
                    // VIX scoring:
                    // 10-15 = very low (50 points), 15-20 = low (30), 20-30 = moderate (15), 30+ = high (0)
                    const vix = vixData.price;
                    if (vix < 15) {
                        vixScore = 50; // Extreme complacency
                    } else if (vix < 20) {
                        vixScore = 35; // Low volatility
                    } else if (vix < 30) {
                        vixScore = 20; // Moderate volatility
                    } else if (vix < 40) {
                        vixScore = 10; // High volatility
                    } else {
                        vixScore = 0; // Extreme fear
                    }

                    // Update VIX display
                    const vixValueElement = document.getElementById('vix-current-value');
                    const vixChangeElement = document.getElementById('vix-5d-change');
                    const vixStatusElement = document.getElementById('vix-status');

                    if (vixValueElement) {
                        vixValueElement.textContent = vix.toFixed(2);
                    }

                    if (vixChangeElement) {
                        const change5d = vixData.changePercent5d || 0;
                        const changeColor = change5d >= 0 ? '#DC143C' : '#00ff88'; // Rising VIX = red (fear)
                        const changeSymbol = change5d >= 0 ? '+' : '';
                        vixChangeElement.innerHTML = `<span style="color: ${changeColor};">${changeSymbol}${change5d.toFixed(2)}%</span>`;
                    }

                    // Update VIX daily and 5-day change in volatility composite section
                    const vixDailyChangeEl = document.getElementById('vix-daily-change');
                    const vix5dayChangeEl = document.getElementById('vix-5day-change');

                    if (vixDailyChangeEl && vixData.changePercent !== undefined) {
                        const dailyChange = vixData.changePercent || 0;
                        const dailyColor = dailyChange >= 0 ? '#DC143C' : '#00ff88';
                        const dailySymbol = dailyChange >= 0 ? '+' : '';
                        vixDailyChangeEl.innerHTML = `<span style="color: ${dailyColor};">${dailySymbol}${dailyChange.toFixed(2)}%</span>`;
                    }

                    if (vix5dayChangeEl && vixData.changePercent5d !== undefined) {
                        const change5d = vixData.changePercent5d || 0;
                        const change5dColor = change5d >= 0 ? '#DC143C' : '#00ff88';
                        const change5dSymbol = change5d >= 0 ? '+' : '';
                        vix5dayChangeEl.innerHTML = `<span style="color: ${change5dColor};">${change5dSymbol}${change5d.toFixed(2)}%</span>`;
                    }

                    if (vixStatusElement) {
                        if (vix < 15) {
                            vixStatusElement.textContent = 'üü¢ COMPLACENT';
                            vixStatusElement.style.color = '#00ff88';
                        } else if (vix < 20) {
                            vixStatusElement.textContent = 'üü¢ LOW';
                            vixStatusElement.style.color = '#00ff88';
                        } else if (vix < 30) {
                            vixStatusElement.textContent = 'üü° MODERATE';
                            vixStatusElement.style.color = '#FFD700';
                        } else if (vix < 40) {
                            vixStatusElement.textContent = 'üî¥ HIGH';
                            vixStatusElement.style.color = '#DC143C';
                        } else {
                            vixStatusElement.textContent = 'üî¥ EXTREME';
                            vixStatusElement.style.color = '#DC143C';
                        }
                    }
                }

                // Calculate crypto volatility component (0-50)
                let cryptoScore = 0;
                if (btcData && btcData.price !== null && ethData && ethData.price !== null) {
                    // Use 5-day volatility (absolute value of percentage changes)
                    const btcVol = Math.abs(btcData.changePercent5d || 0);
                    const ethVol = Math.abs(ethData.changePercent5d || 0);
                    const avgCryptoVol = (btcVol + ethVol) / 2;

                    // Crypto vol scoring:
                    // <5% = calm (50), 5-10% = normal (35), 10-20% = elevated (20), 20%+ = extreme (0)
                    if (avgCryptoVol < 5) {
                        cryptoScore = 50; // Very calm
                    } else if (avgCryptoVol < 10) {
                        cryptoScore = 35; // Normal
                    } else if (avgCryptoVol < 20) {
                        cryptoScore = 20; // Elevated
                    } else if (avgCryptoVol < 30) {
                        cryptoScore = 10; // High
                    } else {
                        cryptoScore = 0; // Extreme
                    }

                    // Update crypto display
                    const cryptoVolElement = document.getElementById('crypto-vol-score');
                    const cryptoStatusElement = document.getElementById('crypto-vol-status');
                    const cryptoChangeElement = document.getElementById('crypto-vol-change');

                    if (cryptoVolElement) {
                        cryptoVolElement.textContent = avgCryptoVol.toFixed(2) + '%';
                    }

                    if (cryptoChangeElement) {
                        cryptoChangeElement.textContent = `BTC: ${btcVol.toFixed(1)}% | ETH: ${ethVol.toFixed(1)}%`;
                    }

                    // Update BTC and ETH volatility separately in volatility composite section
                    const btcVolatilityEl = document.getElementById('btc-volatility');
                    const ethVolatilityEl = document.getElementById('eth-volatility');

                    if (btcVolatilityEl) {
                        btcVolatilityEl.textContent = btcVol.toFixed(2) + '%';
                    }

                    if (ethVolatilityEl) {
                        ethVolatilityEl.textContent = ethVol.toFixed(2) + '%';
                    }

                    if (cryptoStatusElement) {
                        if (avgCryptoVol < 5) {
                            cryptoStatusElement.textContent = 'üü¢ CALM';
                            cryptoStatusElement.style.color = '#00ff88';
                        } else if (avgCryptoVol < 10) {
                            cryptoStatusElement.textContent = 'üü¢ NORMAL';
                            cryptoStatusElement.style.color = '#00ff88';
                        } else if (avgCryptoVol < 20) {
                            cryptoStatusElement.textContent = 'üü° ELEVATED';
                            cryptoStatusElement.style.color = '#FFD700';
                        } else if (avgCryptoVol < 30) {
                            cryptoStatusElement.textContent = 'üî¥ HIGH';
                            cryptoStatusElement.style.color = '#DC143C';
                        } else {
                            cryptoStatusElement.textContent = 'üî¥ EXTREME';
                            cryptoStatusElement.style.color = '#DC143C';
                        }
                    }
                }

                // Calculate composite score (0-100)
                const compositeScore = vixScore + cryptoScore;

                // Update composite display
                const scoreElement = document.getElementById('vixCompositeScore');
                const labelElement = document.getElementById('vixCompositeLabel');
                const barElement = document.getElementById('vixCompositeBar');

                if (scoreElement) {
                    scoreElement.textContent = Math.round(compositeScore);
                }

                if (labelElement) {
                    if (compositeScore >= 70) {
                        labelElement.textContent = 'üü¢ LOW VOLATILITY - CALM MARKETS';
                        labelElement.style.color = '#00ff88';
                    } else if (compositeScore >= 50) {
                        labelElement.textContent = 'üü° MODERATE VOLATILITY';
                        labelElement.style.color = '#FFD700';
                    } else if (compositeScore >= 30) {
                        labelElement.textContent = 'üü† ELEVATED VOLATILITY';
                        labelElement.style.color = '#FF8C00';
                    } else {
                        labelElement.textContent = 'üî¥ HIGH VOLATILITY - TURBULENT';
                        labelElement.style.color = '#DC143C';
                    }
                }

                if (barElement) {
                    barElement.style.width = compositeScore + '%';

                    // Color gradient based on score
                    if (compositeScore >= 70) {
                        barElement.style.background = 'linear-gradient(90deg, #00ff88, #00cc66)';
                    } else if (compositeScore >= 50) {
                        barElement.style.background = 'linear-gradient(90deg, #FFD700, #FFA500)';
                    } else if (compositeScore >= 30) {
                        barElement.style.background = 'linear-gradient(90deg, #FF8C00, #FF6347)';
                    } else {
                        barElement.style.background = 'linear-gradient(90deg, #DC143C, #8B0000)';
                    }
                }

                console.log(`‚úÖ VIX Composite Updated | Score: ${compositeScore} | VIX: ${vixScore} | Crypto: ${cryptoScore}`);

            } catch (error) {
                console.error('‚ùå Error updating VIX Composite indicator:', error);

                const scoreElement = document.getElementById('vixCompositeScore');
                const labelElement = document.getElementById('vixCompositeLabel');

                if (scoreElement) {
                    scoreElement.textContent = '--';
                }
                if (labelElement) {
                    labelElement.textContent = 'DATA ERROR';
                    labelElement.style.color = '#DC143C';
                }
            }
        }

        // Update Market Indicators (AUD/JPY, HYG, 10Y Yield)
        async function updateMarketIndicators() {
            try {
                // Update AUD/JPY
                const audjpyResponse = await fetch('http://localhost:8888/api/market/symbol/AUDJPY=X');
                if (audjpyResponse.ok) {
                    const audjpyData = await audjpyResponse.json();
                    const data = audjpyData.data || audjpyData;

                    const audjpyValueEl = document.getElementById('audjpy-value');
                    const audjpyArrowEl = document.getElementById('audjpy-arrow');

                    if (audjpyValueEl && data.price) {
                        audjpyValueEl.textContent = data.price.toFixed(2);

                        // Update arrow based on change
                        if (audjpyArrowEl && data.change_percent !== undefined) {
                            if (data.change_percent > 0) {
                                audjpyArrowEl.textContent = '‚Üë';
                                audjpyArrowEl.style.color = '#00ff88';
                            } else if (data.change_percent < 0) {
                                audjpyArrowEl.textContent = '‚Üì';
                                audjpyArrowEl.style.color = '#DC143C';
                            } else {
                                audjpyArrowEl.textContent = '‚Üí';
                                audjpyArrowEl.style.color = '#FFD700';
                            }
                        }
                    }
                }

                // Update HYG (High Yield Bond ETF)
                const hygResponse = await fetch('http://localhost:8888/api/market/symbol/HYG');
                if (hygResponse.ok) {
                    const hygData = await hygResponse.json();
                    const data = hygData.data || hygData;

                    const hygValueEl = document.getElementById('hyg-value');
                    const hygArrowEl = document.getElementById('hyg-arrow');

                    if (hygValueEl && data.price) {
                        hygValueEl.textContent = '$' + data.price.toFixed(2);

                        // Update arrow based on change
                        if (hygArrowEl && data.change_percent !== undefined) {
                            if (data.change_percent > 0) {
                                hygArrowEl.textContent = '‚Üë';
                                hygArrowEl.style.color = '#00ff88';
                            } else if (data.change_percent < 0) {
                                hygArrowEl.textContent = '‚Üì';
                                hygArrowEl.style.color = '#DC143C';
                            } else {
                                hygArrowEl.textContent = '‚Üí';
                                hygArrowEl.style.color = '#FFD700';
                            }
                        }
                    }
                }

                // Update 10-Year Treasury Yield
                const yieldResponse = await fetch('http://localhost:8888/api/market/symbol/^TNX');
                if (yieldResponse.ok) {
                    const yieldData = await yieldResponse.json();
                    const data = yieldData.data || yieldData;

                    const yieldValueEl = document.getElementById('yield-value');
                    const yieldArrowEl = document.getElementById('yield-arrow');

                    // Treasury yields are in metadata.yield, not data.price
                    const yieldValue = data.price || (data.metadata && data.metadata.yield);

                    if (yieldValueEl && yieldValue) {
                        yieldValueEl.textContent = yieldValue.toFixed(2) + '%';

                        // Update arrow based on change
                        if (yieldArrowEl && data.change_percent !== undefined) {
                            if (data.change_percent > 0) {
                                yieldArrowEl.textContent = '‚Üë';
                                yieldArrowEl.style.color = '#DC143C';  // Rising yields = bearish for bonds
                            } else if (data.change_percent < 0) {
                                yieldArrowEl.textContent = '‚Üì';
                                yieldArrowEl.style.color = '#00ff88';  // Falling yields = bullish for bonds
                            } else {
                                yieldArrowEl.textContent = '‚Üí';
                                yieldArrowEl.style.color = '#FFD700';
                            }
                        }
                    }
                }
            } catch (error) {
                console.error('Error updating market indicators:', error);
            }
        }

        // Update on page load
        document.addEventListener('DOMContentLoaded', () => {
            updateWhaleHunterSummary();
            updateCompositeIndicators();
            updateCryptoCompositeIndicators();
            updateRecessionIndicator();
            updateStealthMacroIndicator();
            updateVixCompositeIndicator();
            updateMarketIndicators();

            // Refresh every 5 minutes
            setInterval(updateWhaleHunterSummary, 300000);
            setInterval(updateCompositeIndicators, 300000);
            setInterval(updateCryptoCompositeIndicators, 300000);
            setInterval(updateRecessionIndicator, 300000);
            setInterval(updateStealthMacroIndicator, 300000);
            setInterval(updateVixCompositeIndicator, 300000);
            setInterval(updateMarketIndicators, 300000);
        });
    </script>
    <script>
        // üöÄ SPARTAN CACHE ENFORCER
        (function() {
            const CURRENT_VERSION = '2026.01.10.08'; // Update this to force refresh
            const lastVersion = localStorage.getItem('spartan_app_version');

            if (lastVersion !== CURRENT_VERSION) {
                console.warn('‚ö†Ô∏è New version detected (' + CURRENT_VERSION + '). Purging cache...');
                
                // 1. Clear critical local storage
                const keysToPurge = ['whale_hunter_data', 'market_data', 'composite_indices'];
                keysToPurge.forEach(key => localStorage.removeItem(key));
                
                // 2. Update version
                localStorage.setItem('spartan_app_version', CURRENT_VERSION);
                
                // 3. Force reload css
                const links = document.getElementsByTagName('link');
                for (let i = 0; i < links.length; i++) {
                    if (links[i].rel === 'stylesheet') {
                        let href = links[i].href.split('?')[0];
                        links[i].href = href + '?v=' + new Date().getTime();
                    }
                }
                
                console.log('‚úÖ Cache purged. Assets refreshed.');
            }
        })();
    </script>
</body>
</html>
<!-- Cache bust 1761275922 -->
