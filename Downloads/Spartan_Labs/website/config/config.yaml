# Spartan Trading Agent Configuration

# Trading Mode: paper_trading, live_trading, backtest
mode: paper_trading

# Claude AI Configuration
claude:
  model: claude-sonnet-4-5-20250929
  api_key: ${ANTHROPIC_API_KEY}
  max_tokens: 4096
  temperature: 0.7
  # Enable extended thinking for complex decisions
  extended_thinking: true
  # Maximum context window to use
  max_context_tokens: 180000

# Data Sources Configuration
data_sources:
  # Which data sources to enable
  enabled:
    - alpaca_stocks
    # - polygon_stocks
    # - binance_crypto
    # - newsapi
    # - reddit_sentiment

  # Stock data from Alpaca
  alpaca_stocks:
    api_key: ${ALPACA_API_KEY}
    api_secret: ${ALPACA_API_SECRET}
    base_url: ${ALPACA_BASE_URL}
    data_feed: iex  # iex or sip

  # Stock data from Polygon.io
  polygon_stocks:
    api_key: ${POLYGON_API_KEY}

  # Crypto data from Binance
  binance_crypto:
    api_key: ${BINANCE_API_KEY}
    api_secret: ${BINANCE_API_SECRET}
    testnet: true

  # News data
  newsapi:
    api_key: ${NEWS_API_KEY}
    sources:
      - bloomberg
      - reuters
      - financial-times
    keywords:
      - stocks
      - market
      - trading
      - economy

  # Reddit sentiment
  reddit_sentiment:
    client_id: ${REDDIT_CLIENT_ID}
    client_secret: ${REDDIT_CLIENT_SECRET}
    user_agent: ${REDDIT_USER_AGENT}
    subreddits:
      - wallstreetbets
      - stocks
      - investing

# Execution / Broker Configuration
execution:
  # Which brokers to enable
  enabled_brokers:
    - alpaca
    # - binance
    # - interactive_brokers

  # Alpaca configuration
  alpaca:
    mode: paper  # paper or live
    api_key: ${ALPACA_API_KEY}
    api_secret: ${ALPACA_API_SECRET}
    base_url: ${ALPACA_BASE_URL}

  # Binance configuration
  binance:
    mode: testnet  # testnet or live
    api_key: ${BINANCE_API_KEY}
    api_secret: ${BINANCE_API_SECRET}

  # Interactive Brokers
  interactive_brokers:
    host: ${IBKR_HOST}
    port: ${IBKR_PORT}
    client_id: ${IBKR_CLIENT_ID}

# Risk Management
risk:
  # Position sizing
  max_position_size: 0.05  # 5% of portfolio per position
  min_position_size: 0.01  # 1% minimum

  # Portfolio risk
  max_portfolio_risk: 0.02  # 2% total portfolio at risk
  max_positions: 10  # Maximum number of open positions

  # Drawdown protection
  max_drawdown: 0.15  # Stop trading if 15% drawdown from peak
  daily_loss_limit: 0.05  # Stop trading for day if 5% loss

  # Stop losses
  stop_loss_percent: 0.03  # 3% stop loss per trade
  trailing_stop: true
  trailing_stop_percent: 0.02

  # Take profit
  take_profit_percent: 0.06  # 6% take profit target

  # Leverage
  max_leverage: 1.0  # No leverage by default

  # Concentration limits
  max_sector_allocation: 0.30  # Max 30% in any sector
  max_single_stock: 0.10  # Max 10% in any single stock

# Strategy Configuration
strategies:
  # Which strategies to enable
  enabled:
    - claude_momentum
    # - claude_mean_reversion
    # - claude_sentiment
    # - claude_breakout

  # Claude Momentum Strategy
  claude_momentum:
    timeframe: 1h
    lookback_period: 50
    min_volume: 1000000

  # Claude Mean Reversion Strategy
  claude_mean_reversion:
    timeframe: 15m
    lookback_period: 20
    std_threshold: 2.0

  # Claude Sentiment Strategy
  claude_sentiment:
    news_sources:
      - newsapi
      - reddit_sentiment
    sentiment_threshold: 0.6

  # Claude Breakout Strategy
  claude_breakout:
    timeframe: 1d
    lookback_period: 20
    volume_surge_threshold: 2.0

# Universe / Asset Selection
universe:
  # Stock universe
  stocks:
    # Use predefined lists
    use_sp500: true
    use_nasdaq100: false

    # Or specify custom tickers
    custom_tickers:
      - AAPL
      - MSFT
      - GOOGL
      - NVDA
      - TSLA

    # Filters
    min_price: 5.0
    max_price: 1000.0
    min_volume: 1000000

  # Crypto universe
  crypto:
    pairs:
      - BTC/USDT
      - ETH/USDT
      - SOL/USDT
    min_volume_24h: 10000000

# Backtesting Configuration
backtest:
  start_date: "2023-01-01"
  end_date: "2024-12-31"
  initial_capital: 100000
  commission: 0.001  # 0.1%
  slippage: 0.0005  # 0.05%

# Database Configuration
database:
  postgresql_url: ${DATABASE_URL}
  redis_url: ${REDIS_URL}
  timescale_url: ${TIMESCALE_URL}

# Monitoring and Alerts
monitoring:
  # Enable monitoring
  enabled: true

  # Prometheus metrics
  prometheus:
    enabled: true
    port: ${PROMETHEUS_PORT}

  # Logging
  log_level: ${LOG_LEVEL}
  log_file: ${LOG_FILE}

  # Sentry error tracking
  sentry:
    enabled: false
    dsn: ${SENTRY_DSN}

  # Alerts
  alerts:
    # Alert channels
    channels:
      - console
      # - email
      # - sms
      # - telegram
      # - slack

    # Email alerts
    email:
      smtp_host: ${SMTP_HOST}
      smtp_port: ${SMTP_PORT}
      smtp_user: ${SMTP_USER}
      smtp_password: ${SMTP_PASSWORD}
      to_address: ${ALERT_EMAIL}

    # SMS alerts (Twilio)
    sms:
      account_sid: ${TWILIO_ACCOUNT_SID}
      auth_token: ${TWILIO_AUTH_TOKEN}
      from_number: ${TWILIO_FROM_NUMBER}
      to_number: ${ALERT_PHONE_NUMBER}

    # Telegram alerts
    telegram:
      bot_token: ${TELEGRAM_BOT_TOKEN}
      chat_id: ${TELEGRAM_CHAT_ID}

    # Slack alerts
    slack:
      webhook_url: ${SLACK_WEBHOOK_URL}

  # Alert triggers
  alert_on:
    - trade_executed
    - position_opened
    - position_closed
    - stop_loss_hit
    - take_profit_hit
    - risk_limit_exceeded
    - system_error
    - daily_pnl_threshold  # Alert on significant P&L changes

# API Server (for dashboard and external integrations)
api:
  host: ${API_HOST}
  port: ${API_PORT}
  workers: ${API_WORKERS}
  cors_origins:
    - http://localhost:3000
    - http://localhost:8000

# Performance and Optimization
performance:
  # Use async processing
  async_enabled: true

  # Worker threads for data processing
  data_workers: 4

  # Batch processing
  batch_size: 100

  # Caching
  cache_enabled: true
  cache_ttl: 300  # 5 minutes

# Safety Features
safety:
  # Require confirmation for live trading
  require_confirmation: true

  # Emergency kill switch
  kill_switch_enabled: true

  # Dry run mode (log trades without executing)
  dry_run: false

  # Maximum API calls per minute to Claude
  max_claude_calls_per_minute: 50

  # Circuit breaker (stop trading after consecutive losses)
  circuit_breaker:
    enabled: true
    consecutive_losses: 5
    cooldown_minutes: 60
