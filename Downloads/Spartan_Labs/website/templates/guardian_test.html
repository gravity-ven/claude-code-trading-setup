<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Data Guardian Test</title>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f9; color: #333; }
        .container { max-width: 800px; margin: 2em auto; padding: 1em; background: #fff; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { color: #444; }
        .success { border-left: 5px solid #28a745; padding: 10px; background: #e9f7ef; }
        .error { border-left: 5px solid #dc3545; padding: 10px; background: #fdf2f2; }
        .data-item { margin-bottom: 1em; }
        .data-item h3 { margin-bottom: 0.2em; }
        pre { background: #eee; padding: 10px; border-radius: 4px; white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Data Guardian Test Page</h1>
        {% if all_data_available %}
            <div class="success">
                <h2>All data successfully retrieved!</h2>
            </div>
            {% for symbol, data in fetched_data.items() %}
                <div class="data-item">
                    <h3>{{ symbol }}</h3>
                    <pre>{{ data.to_string() if data is not none else "No data available." }}</pre>
                </div>
            {% endfor %}
        {% else %}
            <div class="error">
                <h2>Data could not be retrieved for one or more symbols.</h2>
                <p>The application should gracefully handle this by showing a user-friendly message instead of a broken page.</p>
            </div>
            <h3>Data Status:</h3>
            {% for symbol, data in fetched_data.items() %}
                <div class="data-item">
                    <h4>{{ symbol }}: {% if data is not none %}✔️ Available{% else %}❌ Unavailable{% endif %}</h4>
                </div>
            {% endfor %}
        {% endif %}
    </div>
</body>
</html>
