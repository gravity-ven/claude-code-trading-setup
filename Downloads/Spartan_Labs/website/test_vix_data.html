<!DOCTYPE html>
<html>
<head>
    <title>VIX & Treasury Data Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #0d1b2a; color: #fff; }
        .test-box { background: #1b2838; padding: 20px; margin: 10px 0; border-radius: 8px; }
        .success { color: #00ff88; }
        .error { color: #ff5252; }
        .warning { color: #ffd700; }
        pre { background: #0a0f1a; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç VIX & Treasury Data Diagnostic</h1>

    <div class="test-box">
        <h2>1. VIX (^VIX) API Test</h2>
        <div id="vix-test">Testing...</div>
    </div>

    <div class="test-box">
        <h2>2. 10-Year Treasury (^TNX) API Test</h2>
        <div id="tnx-test">Testing...</div>
    </div>

    <div class="test-box">
        <h2>3. Element Update Test</h2>
        <div>
            <p>VIX Value Element: <span id="test-vix-value" style="color: #ffd700; font-size: 1.5em;">--</span></p>
            <p>10Y Value Element: <span id="test-yield-value" style="color: #ffd700; font-size: 1.5em;">--</span></p>
        </div>
    </div>

    <script>
        async function testAPI(symbol, elementId, valueElementId) {
            const testDiv = document.getElementById(elementId);
            const valueSpan = document.getElementById(valueElementId);

            try {
                testDiv.innerHTML = `<span class="warning">Fetching /api/market/quote/${symbol}...</span>`;

                const response = await fetch(`/api/market/quote/${symbol}`);
                const data = await response.json();

                testDiv.innerHTML = `
                    <div class="success">‚úÖ API Response Received</div>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;

                if (data.price !== null && data.price !== undefined) {
                    valueSpan.textContent = data.price;
                    valueSpan.classList.add('success');
                } else {
                    valueSpan.textContent = 'NULL';
                    valueSpan.classList.add('error');
                }

            } catch (error) {
                testDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                valueSpan.textContent = 'ERROR';
                valueSpan.classList.add('error');
            }
        }

        // Run tests on page load
        window.addEventListener('DOMContentLoaded', () => {
            testAPI('^VIX', 'vix-test', 'test-vix-value');
            testAPI('^TNX', 'tnx-test', 'test-yield-value');
        });
    </script>
</body>
</html>
